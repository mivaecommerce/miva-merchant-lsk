<MIVA STANDARDOUTPUTLEVEL = "">

<MvCOMMENT>
|
| Miva Merchant
|
| This file and the source codes contained herein are the property of
| Miva, Inc.  Use of this file is restricted to the specific terms and
| conditions in the License Agreement associated with this file.  Distribution
| of this file or portions of this file for uses not covered by the License
| Agreement is not allowed without a written agreement signed by an officer of
| Miva, Inc.
|
| Copyright 1998-2025 Miva, Inc.  All rights reserved.
| http://www.miva.com
|
| Prefix         : MER-CSSUI-CMP-CSUB-
| Next Error Code: 9    
|
</MvCOMMENT>

<MvFUNCTION NAME = "Module_Description" PARAMETERS = "module var" STANDARDOUTPUTLEVEL = "">
	<MvASSIGN NAME = "l.module:code"		VALUE = "mmlsk-cmp-cssui-subscriptions">
	<MvASSIGN NAME = "l.module:name"		VALUE = "CSSUI Subscriptions">
	<MvASSIGN NAME = "l.module:provider"	VALUE = "Miva Merchant">
	<MvASSIGN NAME = "l.module:version"		VALUE = "10.1300">
	<MvASSIGN NAME = "l.module:api_ver"		VALUE = "10.08">
	<MvASSIGN NAME = "l.module:features"	VALUE = "component, component_prov, skins">
</MvFUNCTION>

<MvFUNCTION NAME = "ComponentModule_Tabs" PARAMETERS = "module var, item, settings var" STANDARDOUTPUTLEVEL = "">
	<MvASSIGN NAME = "l.tabs"		VALUE = "{ 'GT_PAGE/' $ l.item $ ':Subscription List Layout' }">

	<MvIF EXPR = "{ miva_array_elements( l.settings:imagetypes ) GT 0 }">
		<MvASSIGN NAME = "l.tabs"	VALUE = "{ l.tabs $ ',GT_PAGE/' $ l.item $ '_dimensions:Subscription List Image Dimensions' }">
	</MvIF>

	<MvFUNCTIONRETURN VALUE = "{ l.tabs }">
</MvFUNCTION>

<MvFUNCTION NAME = "ComponentModuleValidate_SortMethod" PARAMETERS = "item, default_sort, value, sort_by, sorting_option, sorting_method" STANDARDOUTPUTLEVEL = "">
	<MvIF EXPR = "{ ( l.default_sort EQ l.value ) AND ( NOT l.sort_by ) }">
		<MvFUNCTIONRETURN VALUE = "{ [ g.Module_Admin ].FieldError( l.item, '', 'Sorting option \'' $ l.sorting_option $ '\' must be enabled to use the Default Sort Method of ' $ l.sorting_method ) }">
	</MvIF>

	<MvFUNCTIONRETURN VALUE = 1>
</MvFUNCTION>

<MvFUNCTION NAME = "ComponentModule_Validate" PARAMETERS = "module var, item, field_prefix, fields var, settings var" STANDARDOUTPUTLEVEL = "">
	<MvIF EXPR = "{ NOT [ g.Module_Feature_TUI_DB ].ManagedTemplate_Load_Filename( l.fields:template_filename, l.managedtemplate ) }">
		<MvIF EXPR = "{ NOT [ g.Module_Library_DB ].Error_Is_EOF() }">
			<MvFUNCTIONRETURN VALUE = 0>
		</MvIF>

		<MvFUNCTIONRETURN VALUE = 1>
	</MvIF>

	<MvASSIGN NAME = "l.fields:b_width"						VALUE = "{ trim( l.fields:b_width ) }">
	<MvASSIGN NAME = "l.fields:b_height"					VALUE = "{ trim( l.fields:b_height ) }">
	<MvASSIGN NAME = "l.fields:price"						VALUE = "{ trim( l.fields:price ) }">
	<MvASSIGN NAME = "l.fields:additionalprice"				VALUE = "{ trim( l.fields:additionalprice ) }">
	<MvASSIGN NAME = "l.fields:per_page"					VALUE = "{ trim( l.fields:per_page ) }">
	<MvASSIGN NAME = "l.fields:page_disp_count"				VALUE = "{ trim( l.fields:page_disp_count ) }">
	<MvASSIGN NAME = "l.fields:hide_cancelled"				VALUE = "{ trim( l.fields:hide_cancelled ) }">
	<MvASSIGN NAME = "l.fields:hide_cancelled_days"			VALUE = "{ trim( l.fields:hide_cancelled_days ) }">
	<MvASSIGN NAME = "l.fields:reverse_default_disp_order"	VALUE = "{ [ g.Module_Admin ].Trim_Boolean( l.fields:reverse_default_disp_order ) }">
	<MvASSIGN NAME = "l.fields:lineitemdiscounts"			VALUE = "{ [ g.Module_Admin ].Trim_Boolean( l.fields:lineitemdiscounts ) }">
	<MvASSIGN NAME = "l.fields:field_code"					VALUE = "{ [ g.Module_Admin ].Trim_Boolean( l.fields:field_code ) }">
	<MvASSIGN NAME = "l.fields:field_name"					VALUE = "{ [ g.Module_Admin ].Trim_Boolean( l.fields:field_name ) }">
	<MvASSIGN NAME = "l.fields:field_options"				VALUE = "{ [ g.Module_Admin ].Trim_Boolean( l.fields:field_options ) }">
	<MvASSIGN NAME = "l.fields:field_quantity"				VALUE = "{ [ g.Module_Admin ].Trim_Boolean( l.fields:field_quantity ) }">
	<MvASSIGN NAME = "l.fields:field_price"					VALUE = "{ [ g.Module_Admin ].Trim_Boolean( l.fields:field_price ) }">
	<MvASSIGN NAME = "l.fields:field_firstdate"				VALUE = "{ [ g.Module_Admin ].Trim_Boolean( l.fields:field_firstdate ) }">
	<MvASSIGN NAME = "l.fields:field_lastdate"				VALUE = "{ [ g.Module_Admin ].Trim_Boolean( l.fields:field_lastdate ) }">
	<MvASSIGN NAME = "l.fields:field_nextdate"				VALUE = "{ [ g.Module_Admin ].Trim_Boolean( l.fields:field_nextdate ) }">
	<MvASSIGN NAME = "l.fields:field_cncldate"				VALUE = "{ [ g.Module_Admin ].Trim_Boolean( l.fields:field_cncldate ) }">
	<MvASSIGN NAME = "l.fields:field_termrem"				VALUE = "{ [ g.Module_Admin ].Trim_Boolean( l.fields:field_termrem ) }">
	<MvASSIGN NAME = "l.fields:field_termproc"				VALUE = "{ [ g.Module_Admin ].Trim_Boolean( l.fields:field_termproc ) }">
	<MvASSIGN NAME = "l.fields:field_paymentmethod"			VALUE = "{ [ g.Module_Admin ].Trim_Boolean( l.fields:field_paymentmethod ) }">
	<MvASSIGN NAME = "l.fields:field_shippingaddress"		VALUE = "{ [ g.Module_Admin ].Trim_Boolean( l.fields:field_shippingaddress ) }">
	<MvASSIGN NAME = "l.fields:display:shipping"			VALUE = "{ [ g.Module_Admin ].Trim_Boolean( l.fields:display:shipping ) }">
	<MvASSIGN NAME = "l.fields:display:handling"			VALUE = "{ [ g.Module_Admin ].Trim_Boolean( l.fields:display:handling ) }">
	<MvASSIGN NAME = "l.fields:display:salestax"			VALUE = "{ [ g.Module_Admin ].Trim_Boolean( l.fields:display:salestax ) }">
	<MvASSIGN NAME = "l.fields:display:discounts"			VALUE = "{ [ g.Module_Admin ].Trim_Boolean( l.fields:display:discounts ) }">

	<MvIF EXPR = "{ l.fields:paginate }">
		<MvIF EXPR = "{ NOT [ g.Module_Admin ].Validate_WholeNumber_Positive_Required( l.fields:per_page ) }">
			<MvFUNCTIONRETURN VALUE = "{ [ g.Module_Admin ].FieldError( l.item, l.field_prefix $ 'per_page', g.Validation_Message ) }">
		</MvIF>
	</MvIF>

	<MvIF EXPR = "{ l.fields:paginate_count }">
		<MvIF EXPR = "{ NOT [ g.Module_Admin ].Validate_WholeNumber_Positive_Required( l.fields:page_disp_count ) }">
			<MvFUNCTIONRETURN VALUE = "{ [ g.Module_Admin ].FieldError( l.item, l.field_prefix $ 'page_disp_count', g.Validation_Message ) }">
		</MvIF>
	</MvIF>

	<MvIF EXPR = "{ NOT [ g.Module_Library_Utilities ].Value_In_List( l.fields:hide_cancelled, 'A,N,D' ) }">
		<MvFUNCTIONRETURN VALUE = "{ [ g.Module_Admin ].FieldError( l.item, l.field_prefix $ 'hide_cancelled', 'Please select a correct value for cancelled subscription settings' ) }">
	</MvIF>

	<MvIF EXPR = "{ NOT [ g.Module_Admin ].Validate_WholeNumber_Positive_Required( l.fields:hide_cancelled_days ) }">
		<MvFUNCTIONRETURN VALUE = "{ [ g.Module_Admin ].FieldError( l.item, l.field_prefix $ 'hide_cancelled_days', g.Validation_Message ) }">
	</MvIF>

	<MvIF EXPR = "{ NOT [ g.Module_Admin ].Validate_WholeNumber_Positive_Required( l.fields:b_width ) }">
		<MvFUNCTIONRETURN VALUE = "{ [ g.Module_Admin ].FieldError( l.item $ '_dimensions', l.field_prefix $ 'b_width', g.Validation_Message ) }">
	</MvIF>

	<MvIF EXPR = "{ NOT [ g.Module_Admin ].Validate_WholeNumber_Positive_Required( l.fields:b_height ) }">
		<MvFUNCTIONRETURN VALUE = "{ [ g.Module_Admin ].FieldError( l.item $ '_dimensions', l.field_prefix $ 'b_height', g.Validation_Message ) }">
	</MvIF>

	<MvIF EXPR = "{ NOT l.fields:advanced AND l.fields:sort_by:switch }">
		<MvASSIGN NAME = "l.ds" VALUE = "{ l.fields:default_sort }">
		<MvASSIGN NAME = "l.sb" VALUE = "{ l.fields:sort_by }">

		<MvIF EXPR = "{ NOT ComponentModuleValidate_SortMethod( 	l.item, l.ds, 'name_asc', 		l.sb:name, 		'Name', 			'Name Ascending' ) }">				<MvFUNCTIONRETURN VALUE = 0>
		<MvELSEIF EXPR = "{ NOT ComponentModuleValidate_SortMethod( l.item, l.ds, 'name_desc', 		l.sb:name, 		'Name', 			'Name Descending' ) }">				<MvFUNCTIONRETURN VALUE = 0>
		<MvELSEIF EXPR = "{ NOT ComponentModuleValidate_SortMethod( l.item, l.ds, 'code_asc', 		l.sb:code, 		'Code', 			'Code Ascending' ) }">				<MvFUNCTIONRETURN VALUE = 0>
		<MvELSEIF EXPR = "{ NOT ComponentModuleValidate_SortMethod( l.item, l.ds, 'code_desc', 		l.sb:code, 		'Code', 			'Code Descending' ) }">				<MvFUNCTIONRETURN VALUE = 0>
		<MvELSEIF EXPR = "{ NOT ComponentModuleValidate_SortMethod( l.item, l.ds, 'total_asc', 		l.sb:total, 	'Estimated Total',	'Lowest Order Total' ) }">			<MvFUNCTIONRETURN VALUE = 0>
		<MvELSEIF EXPR = "{ NOT ComponentModuleValidate_SortMethod( l.item, l.ds, 'total_desc', 	l.sb:total, 	'Estimated Total',	'Highest Order Total' ) }">			<MvFUNCTIONRETURN VALUE = 0>
		<MvELSEIF EXPR = "{ NOT ComponentModuleValidate_SortMethod( l.item, l.ds, 'firstdate_asc', 	l.sb:firstdate, 'First Date', 		'First Date Ascending' ) }">		<MvFUNCTIONRETURN VALUE = 0>
		<MvELSEIF EXPR = "{ NOT ComponentModuleValidate_SortMethod( l.item, l.ds, 'firstdate_desc', l.sb:firstdate, 'First Date', 		'First Date Descending' ) }">		<MvFUNCTIONRETURN VALUE = 0>
		<MvELSEIF EXPR = "{ NOT ComponentModuleValidate_SortMethod( l.item, l.ds, 'lastdate_asc', 	l.sb:lastdate, 	'Last Date', 		'Last Date Ascending' ) }">			<MvFUNCTIONRETURN VALUE = 0>
		<MvELSEIF EXPR = "{ NOT ComponentModuleValidate_SortMethod( l.item, l.ds, 'lastdate_desc', 	l.sb:lastdate, 	'Last Date', 		'Last Date Descending' ) }">		<MvFUNCTIONRETURN VALUE = 0>
		<MvELSEIF EXPR = "{ NOT ComponentModuleValidate_SortMethod( l.item, l.ds, 'nextdate_asc', 	l.sb:nextdate, 	'Next Date', 		'Next Date Ascending' ) }">			<MvFUNCTIONRETURN VALUE = 0>
		<MvELSEIF EXPR = "{ NOT ComponentModuleValidate_SortMethod( l.item, l.ds, 'nextdate_desc', 	l.sb:nextdate, 	'Next Date', 		'Next Date Descending' ) }">		<MvFUNCTIONRETURN VALUE = 0>
		<MvELSEIF EXPR = "{ NOT ComponentModuleValidate_SortMethod( l.item, l.ds, 'payment_asc', 	l.sb:payment, 	'Payment Method', 	'Payment Method Ascending' ) }">	<MvFUNCTIONRETURN VALUE = 0>
		<MvELSEIF EXPR = "{ NOT ComponentModuleValidate_SortMethod( l.item, l.ds, 'payment_desc', 	l.sb:payment, 	'Payment Method', 	'Payment Method Descending' ) }">	<MvFUNCTIONRETURN VALUE = 0>
		<MvELSEIF EXPR = "{ NOT ComponentModuleValidate_SortMethod( l.item, l.ds, 'shipping_asc', 	l.sb:shipping, 	'Shipping Method', 	'Shipping Method Ascending' ) }">	<MvFUNCTIONRETURN VALUE = 0>
		<MvELSEIF EXPR = "{ NOT ComponentModuleValidate_SortMethod( l.item, l.ds, 'shipping_desc', 	l.sb:shipping, 	'Shipping Method', 	'Shipping Method Descending' ) }">	<MvFUNCTIONRETURN VALUE = 0>
		<MvELSEIF EXPR = "{ NOT ComponentModuleValidate_SortMethod( l.item, l.ds, 'termrem_asc', 	l.sb:termrem, 	'Remaining Orders', 'Remaining Orders Ascending' ) }">	<MvFUNCTIONRETURN VALUE = 0>
		<MvELSEIF EXPR = "{ NOT ComponentModuleValidate_SortMethod( l.item, l.ds, 'termrem_desc', 	l.sb:termrem, 	'Remaining Orders', 'Remaining Orders Descending' ) }">	<MvFUNCTIONRETURN VALUE = 0>
		<MvELSEIF EXPR = "{ NOT ComponentModuleValidate_SortMethod( l.item, l.ds, 'termproc_asc', 	l.sb:termproc, 	'Processed Orders', 'Processed Orders Ascending' ) }">	<MvFUNCTIONRETURN VALUE = 0>
		<MvELSEIF EXPR = "{ NOT ComponentModuleValidate_SortMethod( l.item, l.ds, 'termproc_desc', 	l.sb:termproc, 	'Processed Orders', 'Processed Orders Descending' ) }">	<MvFUNCTIONRETURN VALUE = 0>
		</MvIF>
	</MvIF>

	<MvIF EXPR = "{ l.fields:advanced }">
		<MvIF EXPR = "{ NOT [ g.Module_Feature_TUI_MGR ].TemplateManager_Validate_Compilation( l.fields:template_code ) }">
			<MvFUNCTIONRETURN VALUE = "{ [ g.Module_Admin ].FieldError( l.item, l.field_prefix $ 'template_code', g.Error_Message ) }">
		</MvIF>
	</MvIF>

	<MvFUNCTIONRETURN VALUE = 1>
</MvFUNCTION>

<MvFUNCTION NAME = "ComponentModule_Update" PARAMETERS = "module var, item, field_prefix, fields var, settings var" STANDARDOUTPUTLEVEL = "">
	<MvIF EXPR = "{ NOT [ g.Module_Feature_TUI_DB ].ManagedTemplate_Load_Filename( l.settings:template_filename, l.managedtemplate ) }">
		<MvIF EXPR = "{ NOT [ g.Module_Library_DB ].Error_Is_EOF() }">
			<MvFUNCTIONRETURN VALUE = 0>
		</MvIF>

		<MvFUNCTIONRETURN VALUE = 1>
	</MvIF>

	<MvASSIGN NAME = "l.settings:advanced"						VALUE = "{ l.fields:advanced }">
	<MvASSIGN NAME = "l.settings:reverse_default_disp_order" 	VALUE = "{ l.fields:reverse_default_disp_order }">
	<MvASSIGN NAME = "l.settings:display:shipping"				VALUE = "{ l.fields:display:shipping }">
	<MvASSIGN NAME = "l.settings:display:handling"				VALUE = "{ l.fields:display:handling }">
	<MvASSIGN NAME = "l.settings:display:salestax"				VALUE = "{ l.fields:display:salestax }">
	<MvASSIGN NAME = "l.settings:display:discounts"				VALUE = "{ l.fields:display:discounts }">

	<MvASSIGN NAME = "l.selectedfield_count"					VALUE = "{ [ g.Module_Library_Utilities ].CustomFieldSelect_Selected( l.fields:fields_custom, l.settings:fields_custom ) }">

	<MvIF EXPR = "{ l.fields:advanced }">
		<MvASSIGN NAME = "l.imagetype_count"					VALUE = "{ [ g.Module_Library_Utilities ].ImageTypeSelect_Selected( l.fields:imagetypes, l.settings:imagetypes ) }">
	<MvELSE>
		<MvASSIGN NAME = "l.settings:imagetypes"				VALUE = "">
		<MvIF EXPR = "{ NOT ISNULL l.fields:image }">
			<MvIF EXPR = "{ [ g.Module_Library_DB ].ImageType_Load_Code( l.fields:image, l.imagetype ) }">
				<MvASSIGNARRAY NAME = "l.settings"				VALUE = "{ l.imagetype:code }">
					<MvMEMBER NAME = "imagetypes">
					<MvDIMENSION INDEX = 1>
				</MvASSIGNARRAY>
			</MvIF>
		</MvIF>

		<MvASSIGN NAME = "l.settings:price"						VALUE = "{ l.fields:price }">
		<MvASSIGN NAME = "l.settings:additionalprice"			VALUE = "{ l.fields:additionalprice }">
		<MvASSIGN NAME = "l.settings:lineitemdiscounts"			VALUE = "{ l.fields:lineitemdiscounts }">
		<MvASSIGN NAME = "l.settings:field_code"				VALUE = "{ l.fields:field_code }">
		<MvASSIGN NAME = "l.settings:field_name"				VALUE = "{ l.fields:field_name }">
		<MvASSIGN NAME = "l.settings:field_options"				VALUE = "{ l.fields:field_options }">
		<MvASSIGN NAME = "l.settings:field_quantity"			VALUE = "{ l.fields:field_quantity }">
		<MvASSIGN NAME = "l.settings:field_price"				VALUE = "{ l.fields:field_price }">
		<MvASSIGN NAME = "l.settings:field_firstdate"			VALUE = "{ l.fields:field_firstdate }">
		<MvASSIGN NAME = "l.settings:field_lastdate"			VALUE = "{ l.fields:field_lastdate }">
		<MvASSIGN NAME = "l.settings:field_nextdate"			VALUE = "{ l.fields:field_nextdate }">
		<MvASSIGN NAME = "l.settings:field_cncldate"			VALUE = "{ l.fields:field_cncldate }">
		<MvASSIGN NAME = "l.settings:field_termrem"				VALUE = "{ l.fields:field_termrem }">
		<MvASSIGN NAME = "l.settings:field_termproc"			VALUE = "{ l.fields:field_termproc }">
		<MvASSIGN NAME = "l.settings:field_paymentmethod"		VALUE = "{ l.fields:field_paymentmethod }">
		<MvASSIGN NAME = "l.settings:field_shippingaddress"		VALUE = "{ l.fields:field_shippingaddress }">
	</MvIF>

	<MvCOMMENT>
	|
	| These settings are common between advanced and point + click mode
	|
	</MvCOMMENT>

	<MvIF EXPR = "{ l.fields:paginate }">
		<MvASSIGN NAME = "l.settings:per_page"					VALUE = "{ l.fields:per_page }">
	<MvELSE>
		<MvASSIGN NAME = "l.settings:per_page"					VALUE = 0>
	</MvIF>

	<MvIF EXPR = "{ l.fields:paginate_count }">
		<MvASSIGN NAME = "l.settings:page_disp_count"			VALUE = "{ l.fields:page_disp_count }">
	<MvELSE>
		<MvASSIGN NAME = "l.settings:page_disp_count"			VALUE = 0>
	</MvIF>

	<MvASSIGN NAME = "l.settings:hide_cancelled"				VALUE = "{ l.fields:hide_cancelled }">
	<MvASSIGN NAME = "l.settings:hide_cancelled_days"			VALUE = "{ l.fields:hide_cancelled_days }">
	<MvASSIGN NAME = "l.settings:items_per_page_filter"			VALUE = "{ l.fields:items_per_page_filter }">

	<MvASSIGN NAME = "l.settings:sort_by:switch"				VALUE = "{ l.fields:sort_by:switch }">
	<MvASSIGN NAME = "l.settings:sort_by:name"					VALUE = "{ l.fields:sort_by:name }">
	<MvASSIGN NAME = "l.settings:sort_by:code"					VALUE = "{ l.fields:sort_by:code }">
	<MvASSIGN NAME = "l.settings:sort_by:total"					VALUE = "{ l.fields:sort_by:total }">
	<MvASSIGN NAME = "l.settings:sort_by:firstdate"				VALUE = "{ l.fields:sort_by:firstdate }">
	<MvASSIGN NAME = "l.settings:sort_by:lastdate"				VALUE = "{ l.fields:sort_by:lastdate }">
	<MvASSIGN NAME = "l.settings:sort_by:nextdate"				VALUE = "{ l.fields:sort_by:nextdate }">
	<MvASSIGN NAME = "l.settings:sort_by:payment"				VALUE = "{ l.fields:sort_by:payment }">
	<MvASSIGN NAME = "l.settings:sort_by:shipping"				VALUE = "{ l.fields:sort_by:shipping }">
	<MvASSIGN NAME = "l.settings:sort_by:termrem"				VALUE = "{ l.fields:sort_by:termrem }">
	<MvASSIGN NAME = "l.settings:sort_by:termproc"				VALUE = "{ l.fields:sort_by:termproc }">

	<MvASSIGN NAME = "l.settings:constrain"						VALUE = "{ l.fields:constrain }">
	<MvASSIGN NAME = "l.settings:b_width"						VALUE = "{ l.fields:b_width }">
	<MvASSIGN NAME = "l.settings:b_height"						VALUE = "{ l.fields:b_height }">

	<MvIF EXPR = "{ l.fields:default_sort EQ '' }">
		<MvASSIGN NAME = "l.settings:default_sort"				VALUE = "id_desc">
	<MvELSE>
		<MvASSIGN NAME = "l.settings:default_sort"				VALUE = "{ l.fields:default_sort }">
	</MvIF>

	<MvEVAL EXPR = "{ [ g.Module_Admin ].Admin_Log_Action( 'MER-CSSUI-CMP-CSUB-00004', l.module:name $ ' \'' $ l.item $ '\' settings updated' ) }">

	<MvIF EXPR = "{ NOT l.fields:advanced }">
		<MvEVAL EXPR = "{ ComponentModule_Generate_Code( l.settings, l.fields:template_code ) }">
	</MvIF>

	<MvIF EXPR = "{ NOT [ g.Module_Feature_TUI_MGR ].TemplateManager_CreateIfModified_ManagedTemplateVersion( l.managedtemplate, '', l.fields:template_code, l.settings ) }">
		<MvASSIGN NAME = "l.null" VALUE = "{ [ g.Module_Admin ].FieldError( l.item, l.field_prefix $ 'template_code', g.Error_Message ) }">
		<MvFUNCTIONRETURN VALUE = 1>
	</MvIF>

	<MvFUNCTIONRETURN VALUE = 1>
</MvFUNCTION>

<MvFUNCTION NAME = "ComponentModule_Update_Requires_Version" PARAMETERS = "module var, page var, item, field_prefix, fields var, settings var" STANDARDOUTPUTLEVEL = "">
	<MvFUNCTIONRETURN VALUE = 0>
</MvFUNCTION>

<MvFUNCTION NAME = "ComponentModule_PostUpdate" PARAMETERS = "module var, page var, item, field_prefix, fields var" STANDARDOUTPUTLEVEL = "">
	<MvFUNCTIONRETURN VALUE = 1>
</MvFUNCTION>

<MvFUNCTION NAME = "ComponentModule_Content" PARAMETERS = "module var, item, tab, load_fields, field_prefix, fields var, settings var" STANDARDOUTPUTLEVEL = "text, html, compresswhitespace">
	<MvIF EXPR = "{ NOT [ g.Module_Feature_TUI_DB ].ManagedTemplateVersion_Load_Filename_Current( l.settings:template_filename, l.templateversion ) }">
		<MvIF EXPR = "{ NOT [ g.Module_Library_DB ].Error_Is_EOF() }">
			<MvFUNCTIONRETURN VALUE = 0>
		</MvIF>

		<MvFUNCTIONRETURN VALUE = 1>
	</MvIF>

	<MvCOMMENT>
	|
	| Load all image types
	|
	</MvCOMMENT>

	<MvASSIGN NAME = "l.imagetype_count"						VALUE = "{ [ g.Module_Library_DB ].ImageTypeList_Load_All( l.imagetypes ) }">

	<MvIF EXPR = "{ l.load_fields }">
		<MvIF EXPR = "{ ISNULL l.settings:constrain }">
			<MvASSIGN NAME = "l.fields:constrain"				VALUE = "B">
		<MvELSE>
			<MvASSIGN NAME = "l.fields:constrain"				VALUE = "{ l.settings:constrain }">
		</MvIF>

		<MvIF EXPR = "{ ISNULL l.settings:b_width }">
			<MvASSIGN NAME = "l.fields:b_width"					VALUE = 75>
		<MvELSE>
			<MvASSIGN NAME = "l.fields:b_width"					VALUE = "{ l.settings:b_width }">
		</MvIF>

		<MvIF EXPR = "{ ISNULL l.settings:b_height }">
			<MvASSIGN NAME = "l.fields:b_height"				VALUE = 75>
		<MvELSE>
			<MvASSIGN NAME = "l.fields:b_height"				VALUE = "{ l.settings:b_height }">
		</MvIF>

		<MvIF EXPR = "{ ISNULL l.settings:price }">
			<MvASSIGN NAME = "l.fields:price"					VALUE = "base">
		<MvELSE>
			<MvASSIGN NAME = "l.fields:price"					VALUE = "{ l.settings:price }">
		</MvIF>

		<MvASSIGN NAME = "l.fields:advanced"					VALUE = "{ l.settings:advanced }">
		<MvASSIGN NAME = "l.fields:template_code"				VALUE = "{ l.templateversion:source }">
		<MvASSIGN NAME = "l.fields:template_filename"			VALUE = "{ l.settings:template_filename }">
		<MvASSIGN NAME = "l.fields:additionalprice"				VALUE = "{ l.settings:additionalprice }">
		<MvASSIGN NAME = "l.fields:lineitemdiscounts"			VALUE = "{ l.settings:lineitemdiscounts }">
		<MvASSIGN NAME = "l.fields:field_code"					VALUE = "{ l.settings:field_code }">
		<MvASSIGN NAME = "l.fields:field_name"					VALUE = "{ l.settings:field_name }">
		<MvASSIGN NAME = "l.fields:field_options"				VALUE = "{ l.settings:field_options }">
		<MvASSIGN NAME = "l.fields:field_quantity"				VALUE = "{ l.settings:field_quantity }">
		<MvASSIGN NAME = "l.fields:field_price"					VALUE = "{ l.settings:field_price }">
		<MvASSIGN NAME = "l.fields:field_firstdate"				VALUE = "{ l.settings:field_firstdate }">
		<MvASSIGN NAME = "l.fields:field_lastdate"				VALUE = "{ l.settings:field_lastdate }">
		<MvASSIGN NAME = "l.fields:field_nextdate"				VALUE = "{ l.settings:field_nextdate }">
		<MvASSIGN NAME = "l.fields:field_cncldate"				VALUE = "{ l.settings:field_cncldate }">
		<MvASSIGN NAME = "l.fields:field_termrem"				VALUE = "{ l.settings:field_termrem }">
		<MvASSIGN NAME = "l.fields:field_termproc"				VALUE = "{ l.settings:field_termproc }">
		<MvASSIGN NAME = "l.fields:field_paymentmethod"			VALUE = "{ l.settings:field_paymentmethod }">
		<MvASSIGN NAME = "l.fields:field_shippingaddress"		VALUE = "{ l.settings:field_shippingaddress }">
		<MvASSIGN NAME = "l.fields:display:shipping"			VALUE = "{ l.settings:display:shipping }">
		<MvASSIGN NAME = "l.fields:display:handling"			VALUE = "{ l.settings:display:handling }">
		<MvASSIGN NAME = "l.fields:display:salestax"			VALUE = "{ l.settings:display:salestax }">
		<MvASSIGN NAME = "l.fields:display:discounts"			VALUE = "{ l.settings:display:discounts }">
		<MvASSIGN NAME = "l.fields:imagetypes"					VALUE = "{ l.settings:imagetypes }">
		<MvASSIGN NAME = "l.fields:image"						VALUE = "{ l.settings:imagetypes[ 1 ] }">

		<MvEVAL EXPR = "{ [ g.Module_Library_Utilities ].InitializeCustomFieldSelect( l.settings:fields_custom, l.fields:fields_custom ) }">

		<MvIF EXPR = "{ l.settings:per_page EQ 0 }">
			<MvASSIGN NAME = "l.fields:paginate"				VALUE = 0>
			<MvASSIGN NAME = "l.fields:per_page"				VALUE = 10>
		<MvELSE>
			<MvASSIGN NAME = "l.fields:paginate"				VALUE = 1>
			<MvASSIGN NAME = "l.fields:per_page"				VALUE = "{ l.settings:per_page }">
		</MvIF>

		<MvIF EXPR = "{ l.settings:page_disp_count EQ 0 }">
			<MvASSIGN NAME = "l.fields:paginate_count"			VALUE = 0>
			<MvASSIGN NAME = "l.fields:page_disp_count"			VALUE = 3>
		<MvELSE>
			<MvASSIGN NAME = "l.fields:paginate_count"			VALUE = 1>
			<MvASSIGN NAME = "l.fields:page_disp_count"			VALUE = "{ l.settings:page_disp_count }">
		</MvIF>

		<MvIF EXPR = "{ l.settings:items_per_page_filter EQ 0 }">
			<MvASSIGN NAME = "l.fields:items_per_page_filter"	VALUE = 0>
		<MvELSE>
			<MvASSIGN NAME = "l.fields:items_per_page_filter"	VALUE = "{ l.settings:items_per_page_filter }">
		</MvIF>

		<MvIF EXPR = "{ ISNULL l.settings:hide_cancelled }">
			<MvASSIGN NAME = "l.fields:hide_cancelled"			VALUE = "N">
		<MvELSE>
			<MvASSIGN NAME = "l.fields:hide_cancelled"			VALUE = "{ l.settings:hide_cancelled }">
		</MvIF>

		<MvIF EXPR = "{ ISNULL l.settings:hide_cancelled_days }">
			<MvASSIGN NAME = "l.fields:hide_cancelled_days"		VALUE = 14>
		<MvELSE>
			<MvASSIGN NAME = "l.fields:hide_cancelled_days"		VALUE = "{ l.settings:hide_cancelled_days }">
		</MvIF>

		<MvASSIGN NAME = "l.fields:sort_by:switch"				VALUE = "{ l.settings:sort_by:switch }">
		<MvASSIGN NAME = "l.fields:sort_by:name"				VALUE = "{ l.settings:sort_by:name }">
		<MvASSIGN NAME = "l.fields:sort_by:code"				VALUE = "{ l.settings:sort_by:code }">
		<MvASSIGN NAME = "l.fields:sort_by:total"				VALUE = "{ l.settings:sort_by:total }">
		<MvASSIGN NAME = "l.fields:sort_by:firstdate"			VALUE = "{ l.settings:sort_by:firstdate }">
		<MvASSIGN NAME = "l.fields:sort_by:lastdate"			VALUE = "{ l.settings:sort_by:lastdate }">
		<MvASSIGN NAME = "l.fields:sort_by:nextdate"			VALUE = "{ l.settings:sort_by:nextdate }">
		<MvASSIGN NAME = "l.fields:sort_by:payment"				VALUE = "{ l.settings:sort_by:payment }">
		<MvASSIGN NAME = "l.fields:sort_by:shipping"			VALUE = "{ l.settings:sort_by:shipping }">
		<MvASSIGN NAME = "l.fields:sort_by:termrem"				VALUE = "{ l.settings:sort_by:termrem }">
		<MvASSIGN NAME = "l.fields:sort_by:termproc"			VALUE = "{ l.settings:sort_by:termproc }">

		<MvIF EXPR = "{ l.settings:default_sort EQ '' }">
			<MvASSIGN NAME = "l.fields:default_sort"			VALUE = "id_desc">
		<MvELSE>
			<MvASSIGN NAME = "l.fields:default_sort"			VALUE = "{ l.settings:default_sort }">
		</MvIF>

		<MvASSIGN NAME = "l.fields:reverse_default_disp_order" 	VALUE = "{ l.settings:reverse_default_disp_order }">
	</MvIF>

	<MvIF EXPR = "{ NOT [ g.Module_Admin ].Tab_Visible( l.tab, l.item ) }">
		<MvEVAL EXPR = "{ [ g.Module_Feature_TUI_AD ].TUI_Hide_ComponentFields( l.field_prefix, 'fields_custom,image,imagetypes,paginate,per_page,paginate_count,items_per_page_filter,page_disp_count,hide_cancelled,hide_cancelled_days,price,additionalprice,lineitemdiscounts,field_code,field_name,field_options,field_quantity,field_price,field_firstdate,field_lastdate,field_nextdate,field_cncldate,field_termrem,field_termproc,field_paymentmethod,field_shippingaddress,display:shipping,display:handling,display:salestax,display:discounts,default_sort,sort_by:switch,sort_by:name,sort_by:code,sort_by:total,sort_by:firstdate,sort_by:lastdate,sort_by:nextdate,sort_by:payment,sort_by:shipping,sort_by:termrem,sort_by:termproc,reverse_default_disp_order,template_code,template_filename,advanced' ) }">
	<MvELSE>
		<MvEVAL EXPR = "{ [ g.Module_Admin ].DrawGroupTabEntry_Start( 'GT_PAGE', l.item ) }">
		<MvEVAL EXPR = "{ [ g.Module_Feature_TUI_AD ].TUI_Hide_ComponentFields( l.field_prefix, 'template_filename' ) }">
		<table border="0" cellpadding="2" cellspacing="0" width="100%">
		<MvIF EXPR = "{ NOT l.fields:advanced }">
			<MvEVAL EXPR = "{ [ g.Module_Feature_TUI_AD ].TUI_Hide_ComponentFields( l.field_prefix, 'template_code' ) }">
		<MvELSE>
			<tr><td colspan="2" width="100%">
				<MvEVAL EXPR = "{ [ g.Module_Library_Utilities ].DrawTemplateTextArea_WithRecall( l.field_prefix $ 'template_code', l.fields:template_code, 20, 100, l.templateversion:templ_id ) }">
			</td></tr>
		</MvIF>

		<MvIF EXPR = "{ l.fields:advanced }">
			<MvEVAL EXPR = "{ [ g.Module_Feature_TUI_AD ].TUI_Hide_ComponentFields( l.field_prefix, 'field_code,field_name,field_options,field_quantity,field_price,field_firstdate,field_lastdate,field_nextdate,field_cncldate,field_termrem,field_termproc,field_paymentmethod,field_shippingaddress' ) }">
		<MvELSE>
			<tr><td align="left" valign="top" nowrap>
				<b>Displayed Fields:</b>
			</td><td align="left" width="100%">
				<table border="0" cellpadding="0" cellspacing="0">
				<tr><td>
					<label><MvEVAL EXPR = "{ [ g.Module_Library_Utilities ].DrawCheckBox( l.fields:field_code, l.field_prefix $ 'field_code', 1, 'Product Code' ) }"></label>
				</td><td>
					<label><MvEVAL EXPR = "{ [ g.Module_Library_Utilities ].DrawCheckBox( l.fields:field_name, l.field_prefix $ 'field_name', 1, 'Product Name' ) }"></label>
				</td></tr>

				<tr><td>
					<label><MvEVAL EXPR = "{ [ g.Module_Library_Utilities ].DrawCheckBox( l.fields:field_options, l.field_prefix $ 'field_options', 1, 'Product Options' ) }"></label>
				</td><td>
					<label><MvEVAL EXPR = "{ [ g.Module_Library_Utilities ].DrawCheckBox( l.fields:field_quantity, l.field_prefix $ 'field_quantity', 1, 'Product Quantity' ) }"></label>
				</td></tr>

				<tr><td>
					<label><MvEVAL EXPR = "{ [ g.Module_Library_Utilities ].DrawCheckBox( l.fields:field_price, l.field_prefix $ 'field_price', 1, 'Product Price' ) }"></label>
				</td><td>
					<label><MvEVAL EXPR = "{ [ g.Module_Library_Utilities ].DrawCheckBox( l.fields:field_firstdate, l.field_prefix $ 'field_firstdate', 1, 'First Order Date' ) }"></label>
				</td></tr>

				<tr><td>
					<label><MvEVAL EXPR = "{ [ g.Module_Library_Utilities ].DrawCheckBox( l.fields:field_lastdate, l.field_prefix $ 'field_lastdate', 1, 'Last Order Date' ) }"></label>
				</td><td>
					<label><MvEVAL EXPR = "{ [ g.Module_Library_Utilities ].DrawCheckBox( l.fields:field_nextdate, l.field_prefix $ 'field_nextdate', 1, 'Next Order Date' ) }"></label>
				</td></tr>

				<tr><td>
					<label><MvEVAL EXPR = "{ [ g.Module_Library_Utilities ].DrawCheckBox( l.fields:field_cncldate, l.field_prefix $ 'field_cncldate', 1, 'Subscription Cancellation Date' ) }"></label>
				</td><td>
					<label><MvEVAL EXPR = "{ [ g.Module_Library_Utilities ].DrawCheckBox( l.fields:field_termrem, l.field_prefix $ 'field_termrem', 1, 'Orders Remaining' ) }"></label>
				</td></tr>

				<tr><td>
					<label><MvEVAL EXPR = "{ [ g.Module_Library_Utilities ].DrawCheckBox( l.fields:field_termproc, l.field_prefix $ 'field_termproc', 1, 'Orders Processed' ) }"></label>
				</td><td>
					<label><MvEVAL EXPR = "{ [ g.Module_Library_Utilities ].DrawCheckBox( l.fields:field_shippingaddress, l.field_prefix $ 'field_shippingaddress', 1, 'Shipping Address' ) }"></label>
				</td></tr>

				<tr><td>
					<label><MvEVAL EXPR = "{ [ g.Module_Library_Utilities ].DrawCheckBox( l.fields:field_paymentmethod, l.field_prefix $ 'field_paymentmethod', 1, 'Payment Method' ) }"></label>
				</td><td>
					&nbsp;
				</td></tr>
				</table>
			</td></tr>
		</MvIF>

		<MvASSIGN NAME = "l.customfield_count" VALUE = "{ [ g.Module_Library_Utilities ].ProductCustomFieldList_Load( l.customfields ) }">

		<MvIF EXPR = "{ l.customfield_count }">
			<tr><td align="left" valign="top" nowrap>
				<b>Custom Fields:</b>
			</td><td align="left" width="100%">
				<MvEVAL EXPR = "{ [ g.Module_Library_Utilities ].DrawCustomFieldSelect( l.field_prefix $ 'fields_custom', l.fields:fields_custom, l.customfields, l.customfield_count ) }">
			</td></tr>
		</MvIF>

		<MvIF EXPR = "{ l.imagetype_count EQ 0 }">
			<MvEVAL EXPR = "{ [ g.Module_Feature_TUI_AD ].TUI_Hide_ComponentFields( l.field_prefix, 'image,imagetypes' ) }">
		<MvELSE>
			<MvIF EXPR = "{ l.fields:advanced }">
				<MvEVAL EXPR = "{ [ g.Module_Feature_TUI_AD ].TUI_Hide_ComponentFields( l.field_prefix, 'image' ) }">

				<tr><td align="left" valign="top" nowrap>
					<b>Product Images:</b>
				</td><td align="left" width="100%">
					<MvEVAL EXPR = "{ [ g.Module_Library_Utilities ].DrawImageTypeSelect( l.field_prefix $ 'imagetypes', l.fields:imagetypes, l.imagetypes, l.imagetype_count ) }">
				</td></tr>
			<MvELSE>
				<MvEVAL EXPR = "{ [ g.Module_Feature_TUI_AD ].TUI_Hide_ComponentFields( l.field_prefix, 'imagetypes' ) }">

				<tr><td align="left" valign="top" nowrap>
					<b>Image:</b>
				</td><td align="left" width="100%">
					<select name="{ encodeentities( l.field_prefix ) $ 'image' }">
						<MvEVAL EXPR = "{ [ g.Module_Library_Utilities ].DrawOption( '', l.fields:image, 'None' ) }">

						<MvFOREACH ITERATOR = "l.imagetype" ARRAY = "l.imagetypes" COUNT = "{ l.imagetype_count }">
							<MvEVAL EXPR = "{ [ g.Module_Library_Utilities ].DrawOption( l.imagetype:code, l.fields:image, encodeentities( l.imagetype:descrip ) ) }">
						</MvFOREACH>
					</select>
				</td></tr>
			</MvIF>
		</MvIF>

		<MvIF EXPR = "{ l.fields:advanced }">
			<MvEVAL EXPR = "{ [ g.Module_Feature_TUI_AD ].TUI_Hide_ComponentFields( l.field_prefix, 'price,additionalprice,lineitemdiscounts' ) }">
		<MvELSE>
			<tr><td>
				<b>Line Item Discounts:</b>
			</td><td width="100%">
				<label><MvEVAL EXPR = "{ [ g.Module_Library_Utilities ].DrawCheckBox( l.fields:lineitemdiscounts, l.field_prefix $ 'lineitemdiscounts', 1, 'Display Line Item Discount Details' ) }"></label>
			</td></tr>

			<tr><td align="left" nowrap valign="top">
				<b>Displayed Price:</b>
			</td><td align="left" nowrap width="100%">
				<label><MvEVAL EXPR = "{ [ g.Module_Library_Utilities ].DrawRadio( l.field_prefix $ 'price', 'retail',	l.fields:price, 'Retail Price' ) }"></label><br />
				<label><MvEVAL EXPR = "{ [ g.Module_Library_Utilities ].DrawRadio( l.field_prefix $ 'price', 'base',	l.fields:price, 'Base Price (includes any legacy price group discounts but does not reflect sales, coupons or discounts applied in the basket)' ) }"></label><br />
				<label><MvEVAL EXPR = "{ [ g.Module_Library_Utilities ].DrawRadio( l.field_prefix $ 'price', 'sale',	l.fields:price, 'Sale Price (includes legacy price groups and predicted discounts)' ) }"></label>
			</td></tr>

			<tr><td align="left" nowrap valign="top">
				<b>Additional Price Display:</b>
			</td><td align="left" nowrap width="100%">
				<label><MvEVAL EXPR = "{ [ g.Module_Library_Utilities ].DrawRadio( l.field_prefix $ 'additionalprice', '',			l.fields:additionalprice, 'None' ) }"></label><br />
				<label><MvEVAL EXPR = "{ [ g.Module_Library_Utilities ].DrawRadio( l.field_prefix $ 'additionalprice', 'retail',	l.fields:additionalprice, 'Retail Price' ) }"></label><br />
				<label><MvEVAL EXPR = "{ [ g.Module_Library_Utilities ].DrawRadio( l.field_prefix $ 'additionalprice', 'base',		l.fields:additionalprice, 'Base Price (includes any legacy price group discounts but does not reflect sales, coupons or discounts applied in the basket)' ) }"></label>
			</td></tr>
		</MvIF>

		<tr><td align="left" valign="top" nowrap>
			<b>Subscription Charges/Discounts:</b>
		</td><td align="left" width="100%">
			<label><MvEVAL EXPR = "{ [ g.Module_Library_Utilities ].DrawCheckbox( l.fields:display:shipping,	l.field_prefix $ 'display:shipping',	1, 'Display Estimated Shipping Charges' ) }"></label><br />
			<label><MvEVAL EXPR = "{ [ g.Module_Library_Utilities ].DrawCheckbox( l.fields:display:handling,	l.field_prefix $ 'display:handling',	1, 'Display Estimated Handling Charge' ) }"></label><br />
			<label><MvEVAL EXPR = "{ [ g.Module_Library_Utilities ].DrawCheckbox( l.fields:display:salestax,	l.field_prefix $ 'display:salestax',	1, 'Display Estimated Sales Tax' ) }"></label><br />
			<label><MvEVAL EXPR = "{ [ g.Module_Library_Utilities ].DrawCheckbox( l.fields:display:discounts,	l.field_prefix $ 'display:discounts',	1, 'Display Other Subscription Level Discounts' ) }"></label>
		</td></tr>

		<tr><td align="left" nowrap>
			<b>Sorting Options:</b>
		</td><td width="100%">
			<table width="100%">
				<tr>
					<td align="left" style="padding-right: 15px;" nowrap>
						<label><MvEVAL EXPR = "{ [ g.Module_Library_Utilities ].DrawRadio( l.field_prefix $ 'sort_by:switch', 0, l.fields:sort_by:switch, 'Off' ) }"></label><br />
						<label><MvEVAL EXPR = "{ [ g.Module_Library_Utilities ].DrawRadio( l.field_prefix $ 'sort_by:switch', 1, l.fields:sort_by:switch, 'On' ) }"></label>
					</td>
					<td width="100%">
						<MvIF EXPR = "{ l.fields:advanced }">
							<MvEVAL EXPR = "{ [ g.Module_Feature_TUI_AD ].TUI_Hide_ComponentFields( l.field_prefix, 'sort_by:name,sort_by:code,sort_by:total,sort_by:firstdate,sort_by:lastdate,sort_by:nextdate,sort_by:payment,sort_by:shipping,sort_by:termrem,sort_by:termproc' ) }">
						<MvELSE>
							<label><MvEVAL EXPR = "{ [ g.Module_Library_Utilities ].DrawCheckbox( l.fields:sort_by:name,		l.field_prefix $ 'sort_by:name',		'1', 'Name' ) }"></label><br />
							<label><MvEVAL EXPR = "{ [ g.Module_Library_Utilities ].DrawCheckbox( l.fields:sort_by:code,		l.field_prefix $ 'sort_by:code',		'1', 'Code' ) }"></label><br />
							<label><MvEVAL EXPR = "{ [ g.Module_Library_Utilities ].DrawCheckbox( l.fields:sort_by:total,		l.field_prefix $ 'sort_by:total',		'1', 'Estimated Total' ) }"></label><br />
							<label><MvEVAL EXPR = "{ [ g.Module_Library_Utilities ].DrawCheckbox( l.fields:sort_by:firstdate,	l.field_prefix $ 'sort_by:firstdate',	'1', 'First Date' ) }"></label><br />
							<label><MvEVAL EXPR = "{ [ g.Module_Library_Utilities ].DrawCheckbox( l.fields:sort_by:lastdate,	l.field_prefix $ 'sort_by:lastdate',	'1', 'Last Date' ) }"></label><br />
							<label><MvEVAL EXPR = "{ [ g.Module_Library_Utilities ].DrawCheckbox( l.fields:sort_by:nextdate,	l.field_prefix $ 'sort_by:nextdate',	'1', 'Next Date' ) }"></label><br />
							<label><MvEVAL EXPR = "{ [ g.Module_Library_Utilities ].DrawCheckbox( l.fields:sort_by:payment,		l.field_prefix $ 'sort_by:payment',		'1', 'Payment Method' ) }"></label><br />
							<label><MvEVAL EXPR = "{ [ g.Module_Library_Utilities ].DrawCheckbox( l.fields:sort_by:shipping,	l.field_prefix $ 'sort_by:shipping',	'1', 'Shipping Method' ) }"></label><br />
							<label><MvEVAL EXPR = "{ [ g.Module_Library_Utilities ].DrawCheckbox( l.fields:sort_by:termrem,		l.field_prefix $ 'sort_by:termrem',		'1', 'Remaining Orders' ) }"></label><br />
							<label><MvEVAL EXPR = "{ [ g.Module_Library_Utilities ].DrawCheckbox( l.fields:sort_by:termproc,	l.field_prefix $ 'sort_by:termproc',	'1', 'Processed Orders' ) }"></label>
						</MvIF>
					</td>
				</tr>
			</table>
		</td></tr>

		<tr><td align="left" style="padding-right: 15px;" nowrap>
			<b>Default Sort Method:</b>
		</td><td width="100%">
			<table width="100%">
				<tr>
					<td align="left" style="padding-right: 15px;" nowrap>
						<select name="{ encodeentities( l.field_prefix ) $ 'default_sort' }">
							<MvEVAL EXPR = "{ [ g.Module_Library_Utilities ].DrawOption( 'id_desc',			l.fields:default_sort, 'Default' ) }">
							<MvEVAL EXPR = "{ [ g.Module_Library_Utilities ].DrawOption( 'name_asc', 		l.fields:default_sort, 'Name Ascending' ) }">
							<MvEVAL EXPR = "{ [ g.Module_Library_Utilities ].DrawOption( 'name_desc', 		l.fields:default_sort, 'Name Descending' ) }">
							<MvEVAL EXPR = "{ [ g.Module_Library_Utilities ].DrawOption( 'code_asc', 		l.fields:default_sort, 'Code Ascending' ) }">
							<MvEVAL EXPR = "{ [ g.Module_Library_Utilities ].DrawOption( 'code_desc', 		l.fields:default_sort, 'Code Descending' ) }">
							<MvEVAL EXPR = "{ [ g.Module_Library_Utilities ].DrawOption( 'total_asc', 		l.fields:default_sort, 'Lowest Order Total' ) }">
							<MvEVAL EXPR = "{ [ g.Module_Library_Utilities ].DrawOption( 'total_desc', 		l.fields:default_sort, 'Highest Order Total' ) }">
							<MvEVAL EXPR = "{ [ g.Module_Library_Utilities ].DrawOption( 'firstdate_asc', 	l.fields:default_sort, 'First Date Ascending' ) }">
							<MvEVAL EXPR = "{ [ g.Module_Library_Utilities ].DrawOption( 'firstdate_desc', 	l.fields:default_sort, 'First Date Descending' ) }">
							<MvEVAL EXPR = "{ [ g.Module_Library_Utilities ].DrawOption( 'lastdate_asc', 	l.fields:default_sort, 'Last Date Ascending' ) }">
							<MvEVAL EXPR = "{ [ g.Module_Library_Utilities ].DrawOption( 'lastdate_desc', 	l.fields:default_sort, 'Last Date Descending' ) }">
							<MvEVAL EXPR = "{ [ g.Module_Library_Utilities ].DrawOption( 'nextdate_asc', 	l.fields:default_sort, 'Next Date Ascending' ) }">
							<MvEVAL EXPR = "{ [ g.Module_Library_Utilities ].DrawOption( 'nextdate_desc', 	l.fields:default_sort, 'Next Date Descending' ) }">
							<MvEVAL EXPR = "{ [ g.Module_Library_Utilities ].DrawOption( 'payment_asc', 	l.fields:default_sort, 'Payment Method Ascending' ) }">
							<MvEVAL EXPR = "{ [ g.Module_Library_Utilities ].DrawOption( 'payment_desc', 	l.fields:default_sort, 'Payment Method Descending' ) }">
							<MvEVAL EXPR = "{ [ g.Module_Library_Utilities ].DrawOption( 'shipping_asc', 	l.fields:default_sort, 'Shipping Method Ascending' ) }">
							<MvEVAL EXPR = "{ [ g.Module_Library_Utilities ].DrawOption( 'shipping_desc', 	l.fields:default_sort, 'Shipping Method Descending' ) }">
							<MvEVAL EXPR = "{ [ g.Module_Library_Utilities ].DrawOption( 'termrem_asc', 	l.fields:default_sort, 'Remaining Orders Ascending' ) }">
							<MvEVAL EXPR = "{ [ g.Module_Library_Utilities ].DrawOption( 'termrem_desc', 	l.fields:default_sort, 'Remaining Orders Descending' ) }">
							<MvEVAL EXPR = "{ [ g.Module_Library_Utilities ].DrawOption( 'termproc_asc', 	l.fields:default_sort, 'Processed Orders Ascending' ) }">
							<MvEVAL EXPR = "{ [ g.Module_Library_Utilities ].DrawOption( 'termproc_desc', 	l.fields:default_sort, 'Processed Orders Descending' ) }">
						</select>
					</td>
					<td width="100%">
						<font color="red"><b>WARNING:</b></font>&nbsp;&nbsp;Changing the default sorting option to any value other than "default" will increase page load times and increase the load on your server. Be fully aware of the effect this will have on your store before changing this option!
					</td>
				</tr>
			</table>
		</td></tr>

		<tr><td align="left" nowrap>
			&nbsp;
		</td><td width="100%">
			<label><MvEVAL EXPR = "{ [ g.Module_Library_Utilities ].DrawCheckbox( l.fields:reverse_default_disp_order, l.field_prefix $ 'reverse_default_disp_order', '1', 'Reverse Default Display Order' ) }"></label>
		</td></tr>

		<tr><td align="left" nowrap valign="top">
			<b>Cancelled Subscription Settings:</b>
		</td><td align="left" nowrap width="100%">
			<MvEVAL EXPR = "{ [ g.Module_Library_Utilities ].DrawRadio_With_Label( l.field_prefix $ 'hide_cancelled', 'A', l.fields:hide_cancelled, 'Always show cancelled subscriptions' ) }"><br />
			<MvEVAL EXPR = "{ [ g.Module_Library_Utilities ].DrawRadio_With_Label( l.field_prefix $ 'hide_cancelled', 'N', l.fields:hide_cancelled, 'Never show cancelled subscriptions' ) }"><br />
			<MvEVAL EXPR = "{ [ g.Module_Library_Utilities ].DrawRadio_With_Label( l.field_prefix $ 'hide_cancelled', 'D', l.fields:hide_cancelled, 'Hide cancelled subscriptions after' ) }"> <input type="text" name="{ encodeentities( l.field_prefix ) $ 'hide_cancelled_days' }" value="{ encodeentities( l.fields:hide_cancelled_days ) }" size="5" /> days
		</td></tr>

		<tr><td align="left" nowrap valign="top">
			<b>Pagination:</b>
		</td><td align="left" nowrap width="100%">
			<label><MvEVAL EXPR = "{ [ g.Module_Library_Utilities ].DrawRadio( l.field_prefix $ 'paginate', 0, l.fields:paginate, 'Do not paginate subscriptions' ) }"></label><br />
			<label><MvEVAL EXPR = "{ [ g.Module_Library_Utilities ].DrawRadio( l.field_prefix $ 'paginate', 1, l.fields:paginate, 'Display' ) }"></label> <input type="text" name="{ encodeentities( l.field_prefix ) $ 'per_page' }" value="{ encodeentities( l.fields:per_page ) }" size="5"> subscriptions per page<br />
		</td></tr>

		<tr><td align="left" nowrap valign="top">
			<b>Page Numbers:</b>
		</td><td align="left" nowrap width="100%">
			<label><MvEVAL EXPR = "{ [ g.Module_Library_Utilities ].DrawRadio( l.field_prefix $ 'paginate_count', 0, l.fields:paginate_count, 'Do not show page count' ) }"></label><br />
			<label><MvEVAL EXPR = "{ [ g.Module_Library_Utilities ].DrawRadio( l.field_prefix $ 'paginate_count', 1, l.fields:paginate_count, 'Display' ) }"></label> <input type="text" name="{ encodeentities( l.field_prefix ) $ 'page_disp_count' }" value="{ encodeentities( l.fields:page_disp_count ) }" size="5"> pages at a time
		</td></tr>

		<tr><td align="left" nowrap valign="top">
			<b>Items Per Page Filter:</b>
		</td><td align="left" nowrap width="100%">
			<label><MvEVAL EXPR = "{ [ g.Module_Library_Utilities ].DrawRadio( l.field_prefix $ 'items_per_page_filter', 0, l.fields:items_per_page_filter, 'Off' ) }"></label><br />
			<label><MvEVAL EXPR = "{ [ g.Module_Library_Utilities ].DrawRadio( l.field_prefix $ 'items_per_page_filter', 1, l.fields:items_per_page_filter, 'On' ) }"></label>
		</td></tr>

		<tr><td>
			&nbsp;
		</td><td width="100%">
			<input type="hidden" name="{ encodeentities( l.field_prefix ) $ 'advanced' }" value="{ encodeentities( l.fields:advanced ) }">
			<MvIF EXPR = "{ l.fields:advanced }">
				<a href="#" onclick="{ 'Toggle( \'' $ [ g.Module_Admin ].JavaScriptEncode( l.field_prefix ) $ 'advanced' $ '\', 0 ); return false;' }">Point + Click Mode</a>
			<MvELSE>
				<a href="#" onclick="{ 'Toggle( \'' $ [ g.Module_Admin ].JavaScriptEncode( l.field_prefix ) $ 'advanced' $ '\', 1 ); return false;' }">Advanced Mode</a>
			</MvIF>
		</td></tr>
		</table>
		<MvEVAL EXPR = "{ [ g.Module_Admin ].DrawGroupTabEntry_End() }">
	</MvIF>

	<MvIF EXPR = "{ NOT [ g.Module_Admin ].Tab_Visible( l.tab, l.item $ '_dimensions' ) }">
		<MvEVAL EXPR = "{ [ g.Module_Feature_TUI_AD ].TUI_Hide_ComponentFields( l.field_prefix, 'constrain,b_width,b_height' ) }">
	<MvELSE>
		<MvEVAL EXPR = "{ [ g.Module_Admin ].DrawGroupTabEntry_Start( 'GT_PAGE', l.item $ '_dimensions' ) }">
		<table border="0" cellpadding="2" cellspacing="0" width="100%">
			<tr>
				<td align="left" valign="top" nowrap><b>Product Image:</b></td>
				<td align="left" width="100%">
					<label><MvEVAL EXPR = "{ [ g.Module_Library_Utilities ].DrawRadio( l.field_prefix $ 'constrain', 'N', l.fields:constrain, 'No constraints' ) }"></label><br />
					<label><MvEVAL EXPR = "{ [ g.Module_Library_Utilities ].DrawRadio( l.field_prefix $ 'constrain', 'B', l.fields:constrain, 'Resize to fit within bounding box:' ) }"></label>
					<input type="text" name="{ encodeentities( l.field_prefix ) $ 'b_width' }" value="{ encodeentities( l.fields:b_width ) }" style="text-align:right;" size="5" /> x 
					<input type="text" name="{ encodeentities( l.field_prefix ) $ 'b_height' }" value="{ encodeentities( l.fields:b_height ) }" style="text-align:right;" size="5" /> pixels
				</td>
			</tr>
		</table>
		<MvEVAL EXPR = "{ [ g.Module_Admin ].DrawGroupTabEntry_End() }">
	</MvIF>

	<MvFUNCTIONRETURN VALUE = 1>
</MvFUNCTION>

<MvFUNCTION NAME = "ComponentModule_Defaults" PARAMETERS = "module var, item, settings var" STANDARDOUTPUTLEVEL = "">
	<MvASSIGN NAME = "l.settings:additionalprice"				VALUE = "">
	<MvASSIGN NAME = "l.settings:advanced"						VALUE = 0>
	<MvASSIGN NAME = "l.settings:b_height"						VALUE = 75>
	<MvASSIGN NAME = "l.settings:b_width"						VALUE = 75>
	<MvASSIGN NAME = "l.settings:constrain"						VALUE = "B">
	<MvASSIGN NAME = "l.settings:default_sort"					VALUE = "id_desc">
	<MvASSIGN NAME = "l.settings:field_code"					VALUE = 1>
	<MvASSIGN NAME = "l.settings:field_firstdate"				VALUE = 1>
	<MvASSIGN NAME = "l.settings:field_lastdate"				VALUE = 1>
	<MvASSIGN NAME = "l.settings:field_name"					VALUE = 1>
	<MvASSIGN NAME = "l.settings:field_nextdate"				VALUE = 1>
	<MvASSIGN NAME = "l.settings:field_cncldate"				VALUE = 1>
	<MvASSIGN NAME = "l.settings:field_options"					VALUE = 1>
	<MvASSIGN NAME = "l.settings:field_price"					VALUE = 1>
	<MvASSIGN NAME = "l.settings:field_quantity"				VALUE = 1>
	<MvASSIGN NAME = "l.settings:field_termrem"					VALUE = 1>
	<MvASSIGN NAME = "l.settings:field_termproc"				VALUE = 1>
	<MvASSIGN NAME = "l.settings:field_paymentmethod"			VALUE = 1>
	<MvASSIGN NAME = "l.settings:field_shippingaddress"			VALUE = 1>
	<MvASSIGN NAME = "l.settings:display:shipping"				VALUE = 1>
	<MvASSIGN NAME = "l.settings:display:handling"				VALUE = 1>
	<MvASSIGN NAME = "l.settings:display:salestax"				VALUE = 1>
	<MvASSIGN NAME = "l.settings:display:discounts"				VALUE = 1>
	<MvASSIGN NAME = "l.settings:fields_custom" 				VALUE = "">
	<MvASSIGN NAME = "l.settings:imagetypes"					VALUE = "">
	<MvASSIGN NAME = "l.settings:items_per_page_filter"			VALUE = 1>
	<MvASSIGN NAME = "l.settings:lineitemdiscounts"				VALUE = 1>
	<MvASSIGN NAME = "l.settings:hide_cancelled"				VALUE = "A">
	<MvASSIGN NAME = "l.settings:hide_cancelled_days"			VALUE = 14>
	<MvASSIGN NAME = "l.settings:page_disp_count"				VALUE = 3>
	<MvASSIGN NAME = "l.settings:per_page"						VALUE = 10>
	<MvASSIGN NAME = "l.settings:price"							VALUE = "base">
	<MvASSIGN NAME = "l.settings:reverse_default_disp_order" 	VALUE = 0>
	<MvASSIGN NAME = "l.settings:sort_by:code"					VALUE = 0>
	<MvASSIGN NAME = "l.settings:sort_by:firstdate"				VALUE = 0>
	<MvASSIGN NAME = "l.settings:sort_by:lastdate"				VALUE = 0>
	<MvASSIGN NAME = "l.settings:sort_by:name"					VALUE = 0>
	<MvASSIGN NAME = "l.settings:sort_by:nextdate"				VALUE = 0>
	<MvASSIGN NAME = "l.settings:sort_by:payment"				VALUE = 0>
	<MvASSIGN NAME = "l.settings:sort_by:total"					VALUE = 0>
	<MvASSIGN NAME = "l.settings:sort_by:shipping"				VALUE = 0>
	<MvASSIGN NAME = "l.settings:sort_by:switch"				VALUE = 0>
	<MvASSIGN NAME = "l.settings:sort_by:termrem"				VALUE = 0>
	<MvASSIGN NAME = "l.settings:sort_by:termproc"				VALUE = 0>
</MvFUNCTION>

<MvFUNCTION NAME = "ComponentModule_Page_Assign" PARAMETERS = "module var, page var, item, settings var" STANDARDOUTPUTLEVEL = "">
	<MvEVAL EXPR = "{ ComponentModule_Generate_Code( l.settings, l.template_source ) }">

	<MvASSIGN NAME = "l.settings:template_filename"	VALUE = "{ tolower( l.page:code ) $ '-' $ tolower( l.item ) $ '.mvc' }">

	<MvIF EXPR = "{ NOT [ g.Module_Feature_TUI_MGR ].TemplateManager_Create_ManagedTemplate_NoDuplicates( l.template_source, l.settings, l.settings:template_filename ) }">
		<MvFUNCTIONRETURN VALUE = 0>
	</MvIF>

	<MvFUNCTIONRETURN VALUE = 1>
</MvFUNCTION>

<MvFUNCTION NAME = "ComponentModule_Page_Unassign" PARAMETERS = "module var, page var, item, settings var" STANDARDOUTPUTLEVEL = "">
	<MvASSIGN NAME = "l.null" VALUE = "{ [ g.Module_Feature_TUI_MGR ].TemplateManager_Delete_ManagedTemplate_Filename( l.settings:template_filename ) }">

	<MvFUNCTIONRETURN VALUE = 1>
</MvFUNCTION>

<MvFUNCTION NAME = "ComponentModule_Page_Copy" PARAMETERS = "module var, item, source_branch var, source_page var, source_settings var, dest_branch var, dest_page var, dest_settings var" STANDARDOUTPUTLEVEL = "">
	<MvIF EXPR = "{ NOT [ g.Module_Feature_TUI_DB ].ManagedTemplateVersion_Load_Filename_Branch_Head( l.source_branch:id, l.source_settings:template_filename, l.source_templateversion ) }">
		<MvIF EXPR = "{ NOT [ g.Module_Library_DB ].Error_Is_EOF() }">
			<MvFUNCTIONRETURN VALUE = 0>
		</MvIF>

		<MvFUNCTIONRETURN VALUE = 1>
	</MvIF>

	<MvIF EXPR = "{ NOT [ g.Module_Feature_TUI_DB ].ManagedTemplateAndVersion_Load_Branch_Filename( l.dest_branch:id, l.dest_settings:template_filename, l.dest_managedtemplate ) }">
		<MvIF EXPR = "{ NOT [ g.Module_Library_DB ].Error_Is_EOF() }">
			<MvFUNCTIONRETURN VALUE = 0>
		</MvIF>

		<MvFUNCTIONRETURN VALUE = 1>
	</MvIF>

	<MvASSIGN NAME = "l.dest_settings"						VALUE = "{ l.source_settings }">
	<MvASSIGN NAME = "l.dest_settings:template_filename"	VALUE = "{ l.dest_managedtemplate:version:settings:template_filename }">

	<MvIF EXPR = "{ NOT [ g.Module_Feature_TUI_MGR ].TemplateManager_CreateIfModified_ManagedTemplateVersion( l.dest_managedtemplate, '', l.source_templateversion:source, l.dest_settings ) }">
		<MvFUNCTIONRETURN VALUE = 0>
	</MvIF>

	<MvIF EXPR = "{ l.source_branch:id EQ l.dest_branch:id }">	<MvEVAL EXPR = "{ [ g.Module_Admin ].Admin_Log_Action( 'MER-CSSUI-CMP-CSUB-00007', l.module:name $ ' settings copied from page \'' $ l.source_page:code $ '\' to page \'' $ l.dest_page:code $ '\' for item \'' $ l.item $ '\' on branch \'' $ l.dest_branch:name $ '\'' ) }">
	<MvELSE>													<MvEVAL EXPR = "{ [ g.Module_Admin ].Admin_Log_Action( 'MER-CSSUI-CMP-CSUB-00008', l.module:name $ ' settings copied from page \'' $ l.source_page:code $ '\' to page \'' $ l.dest_page:code $ '\' for item \'' $ l.item $ '\' from branch \'' $ l.source_branch:name $ '\' to branch \'' $ l.dest_branch:name $ '\'' ) }">
	</MvIF>

	<MvFUNCTIONRETURN VALUE = 1>
</MvFUNCTION>

<MvFUNCTION NAME = "Create_Pagination" PARAMETERS = "all_settings var, settings var" STANDARDOUTPUTLEVEL = "">
	<MvIF EXPR = "{ l.settings:page_disp_count EQ 0 OR l.settings:per_page EQ 0 }">
		<MvFUNCTIONRETURN VALUE = 0>
	</MvIF>

	<MvASSIGN NAME = "l.link_additions" VALUE = "">

	<MvIF EXPR = "{ NOT ISNULL g.Per_Page }">	<MvASSIGN NAME = "l.link_additions"	VALUE = "{ l.link_additions $ '&Per_Page=' $ encodeattribute( g.Per_Page ) }">	</MvIF>
	<MvIF EXPR = "{ NOT ISNULL g.Sort_By }">	<MvASSIGN NAME = "l.link_additions"	VALUE = "{ l.link_additions $ '&Sort_By=' $ encodeattribute( g.Sort_By ) }">	</MvIF>

	<MvASSIGN NAME = "l.page_count"						VALUE = "{ ceil( l.settings:total_count / l.settings:per_page ) }">
	<MvASSIGN NAME = "l.settings:page_links:last_page"	VALUE = "{ l.page_count }">

	<MvIF EXPR = "{ g.NextOffset }">	<MvASSIGN NAME = "l.settings:page_links:current_page" VALUE = "{ ceil( g.NextOffset / l.settings:per_page ) }">
	<MvELSE>							<MvASSIGN NAME = "l.settings:page_links:current_page" VALUE = "{ ceil( l.settings:total_count / l.settings:per_page ) }">
	</MvIF>

	<MvASSIGN NAME = "l.settings:page_links:next_link_params"		VALUE = "{ 'Offset=' $ encodeattribute( ( l.settings:page_links:current_page ) * l.settings:per_page ) $ l.link_additions }">
	<MvASSIGN NAME = "l.settings:page_links:prev_link_params"		VALUE = "{ 'Offset=' $ encodeattribute( ( l.settings:page_links:current_page - 2 ) * l.settings:per_page ) $ l.link_additions }">
	<MvASSIGN NAME = "l.settings:page_links:first_link_params"		VALUE = "{ 'Offset=0' $ l.link_additions }">

	<MvIF EXPR = "{ floor( l.settings:total_count / l.settings:per_page ) * l.settings:per_page EQ l.settings:total_count }">
		<MvASSIGN NAME = "l.last_page_offset"						VALUE = "{ floor( ( l.settings:total_count - 1 ) / l.settings:per_page ) * l.settings:per_page }">
		<MvASSIGN NAME = "l.settings:page_links:last_link_params"	VALUE = "{ 'Offset=' $ encodeattribute( floor( ( l.settings:total_count - 1 ) / l.settings:per_page ) * l.settings:per_page ) $ l.link_additions }">
	<MvELSE>
		<MvASSIGN NAME = "l.last_page_offset"						VALUE = "{ floor( ( l.settings:total_count ) / l.settings:per_page ) * l.settings:per_page }">
		<MvASSIGN NAME = "l.settings:page_links:last_link_params"	VALUE = "{ 'Offset=' $ encodeattribute( floor( l.settings:total_count / l.settings:per_page ) * l.settings:per_page ) $ l.link_additions }">
	</MvIF>

	<MvIF EXPR = "{ l.page_count LT l.settings:page_disp_count }">
		<MvASSIGN NAME = "l.left"	VALUE = "{ floor( ( l.page_count - 1 ) / 2 ) }">
		<MvASSIGN NAME = "l.right"	VALUE = "{ ceil( ( l.page_count - 1 ) / 2 ) }">
	<MvELSE>
		<MvASSIGN NAME = "l.left"	VALUE = "{ floor( ( l.settings:page_disp_count - 1 ) / 2 ) }">
		<MvASSIGN NAME = "l.right"	VALUE = "{ ceil( ( l.settings:page_disp_count - 1 ) / 2 ) }">
	</MvIF>

	<MvASSIGN NAME = "l.counter"	VALUE = 0>
	<MvASSIGN NAME = "l.left_final" VALUE = 0>

	<MvWHILE EXPR = "{ l.counter LT l.left }">
		<MvIF EXPR = "{ ( ( l.settings:page_links:current_page - l.left + 1 ) + l.counter ) GT 1 }">
			<MvASSIGN NAME = "l.left_final"	VALUE = "{ l.left_final + 1 }">
		<MvELSE>
			<MvASSIGN NAME = "l.right" VALUE = "{ l.right + 1 }">
		</MvIF>

		<MvASSIGN NAME = "l.counter" VALUE = "{ l.counter + 1 }">
	</MvWHILE>

	<MvIF EXPR = "{ l.left_final EQ l.left }">
		<MvASSIGN NAME = "l.counter"	 VALUE = 0>
		<MvASSIGN NAME = "l.right_final" VALUE = 0>

		<MvWHILE EXPR = "{ l.counter LT l.right }">
			<MvIF EXPR = "{ ( ( l.settings:page_links:current_page + l.right - 1 ) - l.counter ) LT l.page_count }">
				<MvASSIGN NAME = "l.right_final" VALUE = "{ l.right_final + 1 }">
			<MvELSE>
				<MvASSIGN NAME = "l.left_final" VALUE = "{ l.left_final + 1 }">
			</MvIF>

			<MvASSIGN NAME = "l.counter" VALUE = "{ l.counter + 1 }">
		</MvWHILE>

		<MvASSIGN NAME = "l.pages" VALUE = "{ l.left_final + l.right_final + 1 }">
	<MvELSE>
		<MvASSIGN NAME = "l.pages" VALUE = "{ l.left_final + l.right + 1 }">
	</MvIF>

	<MvASSIGN NAME = "l.counter" VALUE = 0>

	<MvASSIGN NAME = "l.settings:page_links:contains_first"	VALUE = 0>
	<MvASSIGN NAME = "l.settings:page_links:contains_last"	VALUE = 0>

	<MvWHILE EXPR = "{ l.counter LT l.pages }">
		<MvASSIGN NAME = "l.settings:page_links:pages" INDEX = "{ l.counter + 1 }" MEMBER = "page_num" 		VALUE = "{ ( l.settings:page_links:current_page - l.left_final ) + l.counter }">
		<MvASSIGN NAME = "l.settings:page_links:pages" INDEX = "{ l.counter + 1 }" MEMBER = "link_params" 	VALUE = "{ 'Offset=' $ encodeattribute( ( ( l.settings:page_links:current_page - l.left_final - 1 ) + l.counter ) * l.settings:per_page ) $ l.link_additions }">

		<MvIF EXPR = "{ ( ( ( l.settings:page_links:current_page - l.left_final - 1 ) + l.counter ) * l.settings:per_page ) EQ 0 }">					<MvASSIGN NAME = "l.settings:page_links:contains_first"	VALUE = 1> </MvIF>
		<MvIF EXPR = "{ ( ( ( l.settings:page_links:current_page - l.left_final - 1 ) + l.counter ) * l.settings:per_page ) EQ l.last_page_offset }">	<MvASSIGN NAME = "l.settings:page_links:contains_last"	VALUE = 1> </MvIF>

		<MvASSIGN NAME = "l.counter" VALUE = "{ l.counter + 1 }">
	</MvWHILE>

	<MvFUNCTIONRETURN VALUE = 1>
</MvFUNCTION>

<MvFUNCTION NAME = "ComponentModule_Initialize" PARAMETERS = "module var, item, all_settings var, settings var" STANDARDOUTPUTLEVEL = "">
	<MvIF EXPR = "{ NOT g.Basket:cust_id OR NOT g.Customer_Session_Verified }">
		<MvFUNCTIONRETURN VALUE = "{ [ g.Module_Feature_TUI_MGR ].TemplateManager_Throw_Exception( 'customer_invalid_session' ) }">
	</MvIF>

	<MvIF EXPR = "{ l.settings:items_per_page_filter }">
		<MvIF EXPR = "{ ISNULL g.Per_Page OR NOT [ g.Module_Admin ].Validate_WholeNumber_Required( g.Per_Page ) }">
			<MvIF EXPR = "{ l.settings:per_page EQ 0 }">
				<MvASSIGN NAME = "g.Per_Page"			VALUE = -1>
			<MvELSE>
				<MvASSIGN NAME = "g.Per_Page"			VALUE = "{ l.settings:per_page }">
			</MvIF>
		<MvELSE>
			<MvIF EXPR = "{ g.Per_Page GE 0 }">
				<MvASSIGN NAME = "l.settings:per_page"	VALUE = "{ g.Per_Page }">
			<MvELSE>
				<MvASSIGN NAME = "g.Per_Page"			VALUE = -1>
				<MvASSIGN NAME = "l.settings:per_page"	VALUE = 0>
			</MvIF>
		</MvIF>
	</MvIF>

	<MvIF EXPR = "{ g.Sort_By }">
		<MvASSIGN NAME = "l.sort_by"					VALUE = "{ g.Sort_By }">
	<MvELSE>
		<MvASSIGN NAME = "l.sort_by"					VALUE = "{ l.settings:default_sort }">
		<MvASSIGN NAME = "g.Sort_By"					VALUE = "{ l.settings:default_sort }">
	</MvIF>

	<MvIF EXPR = "{ l.sort_by EQ 'id_desc' AND
	 				l.settings:reverse_default_disp_order }">
		<MvASSIGN NAME = "l.sort_by" 					VALUE = "id">
	</MvIF>

	<MvEVAL EXPR = "{ [ g.Module_Feature_SUB_DB ].Runtime_SubscriptionList_Build_Query( l.query ) }">
	<MvEVAL EXPR = "{ [ g.Module_Feature_SUB_DB ].Runtime_SubscriptionList_Build_Query_Customer( l.query, g.Basket:cust_id ) }">
	<MvEVAL EXPR = "{ [ g.Module_Feature_SUB_DB ].Runtime_SubscriptionList_Build_Query_ORDER_BY( l.query, l.sort_by ) }">

	<MvIF EXPR = "{ ISNULL l.settings:hide_cancelled OR l.settings:hide_cancelled EQ 'N' }">
		<MvEVAL EXPR = "{ [ g.Module_Feature_SUB_DB ].Runtime_SubscriptionList_Build_Query_Active( l.query ) }">
	<MvELSEIF EXPR = "{ l.settings:hide_cancelled EQ 'D' }">
		<MvEVAL EXPR = "{ [ g.Module_Feature_SUB_DB ].Runtime_SubscriptionList_Build_Query_ActiveWithin( l.query, [ g.Module_Library_Utilities ].TimeT_PreviousDays( l.settings:hide_cancelled_days ) ) }">
	</MvIF>

	<MvASSIGN NAME = "l.settings:item_count"			VALUE = "{ [ g.Module_Feature_SUB_DB ].Runtime_SubscriptionList_Load_Query( l.query, g.Offset, l.settings:per_page, g.NextOffset, l.settings:total_count, l.settings:items ) }">
	<MvASSIGN NAME = "l.null"							VALUE = "{ Create_Pagination( l.all_settings, l.settings ) }">

	<MvIF EXPR = "{ l.settings:item_count EQ 0 }">
		<MvASSIGN NAME = "l.settings:empty"				VALUE = 1>
	</MvIF>

	<MvASSIGN NAME = "g.PrevOffset"						VALUE = "{ g.Offset - l.settings:per_page }">

	<MvIF EXPR = "{ g.PrevOffset LT 0 }">
		<MvASSIGN NAME = "g.PrevOffset"					VALUE = 0>
	</MvIF>

	<MvIF EXPR = "{ NOT [ g.Module_Feature_TUI_UT ].CommonComponentFields_Initialize_Product_CustomField_Lookup( l.all_settings, l.settings:fields_custom ) }">
		<MvFUNCTIONRETURN VALUE = 0>
	</MvIF>

	<MvFOREACH ITERATOR = "l.subscription" ARRAY = "l.settings:items" COUNT = "{ l.settings:item_count }">
		<MvASSIGN NAME = "l.subscription:customer"	VALUE = "{ g.Customer }">
		<MvASSIGN NAME = "l.null"					VALUE = "{ [ g.Module_Feature_TUI_UT ].CommonComponentFields_Initialize_Subscription( l.all_settings, l.settings, l.subscription ) }">
	</MvFOREACH>

	<MvFUNCTIONRETURN VALUE = 1>
</MvFUNCTION>

<MvFUNCTION NAME = "ComponentModule_Prerender" PARAMETERS = "module var, item, all_settings var, settings var, param" STANDARDOUTPUTLEVEL = "">
	<MvFUNCTIONRETURN VALUE = 1>
</MvFUNCTION>

<MvFUNCTION NAME = "ComponentModule_Render_Head" PARAMETERS = "module var, item, all_settings var, settings var" STANDARDOUTPUTLEVEL = "">
</MvFUNCTION>

<MvFUNCTION NAME = "ComponentModule_Render_Start" PARAMETERS = "module var, item, all_settings var, settings var, param" STANDARDOUTPUTLEVEL = "">
	<MvEVAL EXPR = "{ [ g.Module_Feature_TUI_MGR ].TemplateManager_Render_Template( l.settings:template_filename, l.all_settings ) }">
</MvFUNCTION>

<MvFUNCTION NAME = "ComponentModule_Render_End" PARAMETERS = "module var, item, all_settings var, settings var, param" STANDARDOUTPUTLEVEL = "">
</MvFUNCTION>

<MvFUNCTION NAME = "ComponentModule_Provision" PARAMETERS = "module var, provide_xml var, settings var" STANDARDOUTPUTLEVEL = "">
	<MvASSIGN NAME = "l.working_settings"	VALUE = "{ l.settings }">

	<MvIF EXPR = "{ NOT [ g.Module_Feature_PRV_AD ].PRV_Attribute_Text( l.provide_xml, 'code', l.item ) }">
		<MvFUNCTIONRETURN>
	</MvIF>

	<MvIF EXPR = "{ NOT [ g.Module_Feature_PRV_AD ].PRV_Tag_Integer(	'O', l.provide_xml,	'ItemsPerPage',						l.working_settings:per_page )													OR
					NOT [ g.Module_Feature_PRV_AD ].PRV_Tag_Integer(	'O', l.provide_xml,	'PageCountNumber',					l.working_settings:page_disp_count )											OR
					NOT [ g.Module_Feature_PRV_AD ].PRV_Tag_Boolean(	'O', l.provide_xml,	'DisplayItemsPerPage',				l.working_settings:items_per_page_filter )										OR
					NOT [ g.Module_Feature_PRV_AD ].PRV_Tag_Boolean(	'O', l.provide_xml,	'SortBySwitch',						l.working_settings:sort_by:switch )												OR
					NOT [ g.Module_Feature_PRV_AD ].PRV_Tag_Boolean(	'O', l.provide_xml,	'SortByName',						l.working_settings:sort_by:name )												OR
					NOT [ g.Module_Feature_PRV_AD ].PRV_Tag_Boolean(	'O', l.provide_xml,	'SortByCode',						l.working_settings:sort_by:code )												OR
					NOT [ g.Module_Feature_PRV_AD ].PRV_Tag_Boolean(	'O', l.provide_xml,	'SortByEstimatedTotal',				l.working_settings:sort_by:total )												OR
					NOT [ g.Module_Feature_PRV_AD ].PRV_Tag_Boolean(	'O', l.provide_xml,	'SortByFirstOrderDate',				l.working_settings:sort_by:firstdate )											OR
					NOT [ g.Module_Feature_PRV_AD ].PRV_Tag_Boolean(	'O', l.provide_xml,	'SortByLastOrderDate',				l.working_settings:sort_by:lastdate )											OR
					NOT [ g.Module_Feature_PRV_AD ].PRV_Tag_Boolean(	'o', l.provide_xml,	'SortByNextOrderDate',				l.working_settings:sort_by:nextdate )											OR
					NOT [ g.Module_Feature_PRV_AD ].PRV_Tag_Boolean(	'o', l.provide_xml,	'SortByPaymentMethod',				l.working_settings:sort_by:payment )											OR
					NOT [ g.Module_Feature_PRV_AD ].PRV_Tag_Boolean(	'o', l.provide_xml,	'SortByShippingMethod',				l.working_settings:sort_by:shipping )											OR
					NOT [ g.Module_Feature_PRV_AD ].PRV_Tag_Boolean(	'o', l.provide_xml,	'SortByTermRemaining',				l.working_settings:sort_by:termrem )											OR
					NOT [ g.Module_Feature_PRV_AD ].PRV_Tag_Boolean(	'o', l.provide_xml,	'SortByTermProcessed',				l.working_settings:sort_by:termproc )											OR
					NOT [ g.Module_Feature_PRV_AD ].PRV_Tag_List(		'O', l.provide_xml,	'DefaultSort',						l.working_settings:default_sort,
																							'id_desc,name_asc,name_desc,code_asc,code_desc,total_asc,total_desc,firstdate_asc,firstdate_desc,lastdate_asc,lastdate_desc,nextdate_asc,nextdate_desc,payment_asc,payment_desc,shipping_asc,shipping_desc,termrem_asc,termrem_desc,termproc_asc,termproc_desc',
																							'id_desc,name_asc,name_desc,code_asc,code_desc,total_asc,total_desc,firstdate_asc,firstdate_desc,lastdate_asc,lastdate_desc,nextdate_asc,nextdate_desc,payment_asc,payment_desc,shipping_asc,shipping_desc,termrem_asc,termrem_desc,termproc_asc,termproc_desc' )
																																																				OR
					NOT [ g.Module_Feature_PRV_AD ].PRV_Tag_List(		'O', l.provide_xml, 'PriceDisplay',						l.working_settings:price,			'Retail,Base,Sale',	'retail,base,sale' )	OR
					NOT [ g.Module_Feature_PRV_AD ].PRV_Tag_List(		'O', l.provide_xml, 'AdditionalPriceDisplay',			l.working_settings:additionalprice,	'None,Retail,Base',	',retail,base' )		OR
					NOT [ g.Module_Feature_PRV_AD ].PRV_Tag_Boolean( 	'O', l.provide_xml, 'DisplayShipping',					l.working_settings:display:shipping )											OR
					NOT [ g.Module_Feature_PRV_AD ].PRV_Tag_Boolean( 	'O', l.provide_xml, 'DisplayHandling',					l.working_settings:display:handling )											OR
					NOT [ g.Module_Feature_PRV_AD ].PRV_Tag_Boolean( 	'O', l.provide_xml, 'DisplaySalesTax',					l.working_settings:display:salestax )											OR
					NOT [ g.Module_Feature_PRV_AD ].PRV_Tag_Boolean( 	'O', l.provide_xml, 'DisplayDiscounts',					l.working_settings:display:discounts )											OR
					NOT [ g.Module_Feature_PRV_AD ].PRV_Tag_Boolean(	'o', l.provide_xml, 'DisplayLineItemDiscountDetails',	l.working_settings:lineitemdiscounts )											OR
					NOT [ g.Module_Feature_PRV_AD ].PRV_Tag_Boolean(	'o', l.provide_xml, 'ReverseDefaultDisplayOrder',		l.working_settings:reverse_default_disp_order )									OR
					NOT [ g.Module_Feature_PRV_AD ].PRV_Tag_Text(		'O', l.provide_xml,	'Notes',							l.notes ) }">
		<MvFUNCTIONRETURN>
	</MvIF>

	<MvIF EXPR = "{ [ g.Module_Feature_PRV_AD ].PRV_Tag_Exists( l.provide_xml, 'HideCancelled' ) }">
		<MvIF EXPR = "{ NOT [ g.Module_Feature_PRV_AD ].PRV_Tag_List(	'O', l.provide_xml,	'HideCancelled',					l.working_settings:hide_cancelled,
																							'Always,Never,Days',
																							'A,N,D' ) }">
			<MvFUNCTIONRETURN>
		</MvIF>

		<MvIF EXPR = "{ l.working_settings:hide_cancelled EQ 'D' }">
			<MvIF EXPR = "{ NOT [ g.Module_Feature_PRV_AD ].PRV_Attribute_Integer( l.provide_xml:tags:HideCancelled[ 1 ], 'days', l.working_settings:hide_cancelled_days ) }">
				<MvFUNCTIONRETURN>
			</MvIF>

			<MvIF EXPR = "{ NOT [ g.Module_Admin ].Validate_WholeNumber_Positive_Required( l.working_settings:hide_cancelled_days ) }">
				<MvFUNCTIONRETURN VALUE = "{ [ g.Module_Feature_PRV_AD ].PRV_LogMessage( l.provide_xml:tags:HideCancelled[ 1 ], 'Invalid value for attribute \'days\': ' $ g.Validation_Message ) }">
			</MvIF>
		</MvIF>
	</MvIF>

	<MvIF EXPR = "{ [ g.Module_Feature_PRV_AD ].PRV_Tag_Exists( l.provide_xml, 'Fields' ) }">
		<MvIF EXPR = "{ NOT ComponentModule_Provision_Fields( l.module, l.provide_xml:tags:Fields[ 1 ], l.working_settings ) }">
			<MvFUNCTIONRETURN>
		</MvIF>
	</MvIF>

	<MvIF EXPR = "{ [ g.Module_Feature_PRV_AD ].PRV_Tag_Exists( l.provide_xml, 'ImageTypes' ) }">
		<MvIF EXPR = "{ NOT ComponentModule_Provision_ImageTypes( l.module, l.provide_xml:tags:ImageTypes[ 1 ], l.working_settings ) }">
			<MvFUNCTIONRETURN VALUE = "{ [ g.Module_Feature_PRV_AD ].PRV_LogMessage( l.provide_xml, 'Unable to provision multiple image types' ) }">
		</MvIF>
	</MvIF>

	<MvIF EXPR = "{ [ g.Module_Feature_PRV_AD ].PRV_Tag_Exists( l.provide_xml, 'ImageDimensions' ) }">
		<MvASSIGN NAME = "l.dimensions" VALUE = "{ l.provide_xml:tags:ImageDimensions[ 1 ] }">

		<MvIF EXPR = "{ NOT [ g.Module_Feature_PRV_AD ].PRV_Attribute_Boolean( l.dimensions, 'constrain', l.constrain ) }">
			<MvFUNCTIONRETURN>
		</MvIF>

		<MvIF EXPR = "{ NOT l.constrain }">
			<MvASSIGN NAME = "l.working_settings:constrain" VALUE = "N">
		<MvELSE>
			<MvASSIGN NAME = "l.working_settings:constrain" VALUE = "B">

			<MvIF EXPR = "{ NOT [ g.Module_Feature_PRV_AD ].PRV_Tag_Integer( 'R', l.dimensions, 'Width',	l.working_settings:b_width ) OR
							NOT [ g.Module_Feature_PRV_AD ].PRV_Tag_Integer( 'R', l.dimensions, 'Height',	l.working_settings:b_height ) }">
				<MvFUNCTIONRETURN>
			</MvIF>
		</MvIF>
	</MvIF>

	<MvIF EXPR = "{ [ g.Module_Feature_PRV_AD ].PRV_Tag_Exists( l.provide_xml, 'Template' ) }">
		<MvASSIGN NAME = "l.source"						VALUE = "{ trim( l.provide_xml:tags:Template[ 1 ]:value ) }">
		<MvASSIGN NAME = "l.working_settings:advanced"	VALUE = 1>
	<MvELSE>
		<MvASSIGN NAME = "l.working_settings:advanced"	VALUE = 0>

		<MvEVAL EXPR = "{ ComponentModule_Generate_Code( l.working_settings, l.source ) }">
	</MvIF>

	<MvIF EXPR = "{ NOT [ g.Module_Feature_TUI_DB ].ManagedTemplate_Load_Filename( l.settings:template_filename, l.managedtemplate ) }">
		<MvIF EXPR = "{ NOT [ g.Module_Library_DB ].Error_Is_EOF() }">
			<MvFUNCTIONRETURN VALUE = "{ [ g.Module_Feature_PRV_AD ].PRV_LogError( l.provide_xml ) }">
		</MvIF>

		<MvFUNCTIONRETURN VALUE = "{ [ g.Module_Feature_PRV_AD ].PRV_LogMessage( l.provide_xml, 'Unable to load template' ) }">
	</MvIF>

	<MvIF EXPR = "{ NOT [ g.Module_Feature_TUI_MGR ].TemplateManager_CreateIfModified_ManagedTemplateVersion( l.managedtemplate, l.notes, l.source, l.working_settings ) }">
		<MvFUNCTIONRETURN VALUE = "{ [ g.Module_Feature_PRV_AD ].PRV_LogError( l.provide_xml ) }">
	</MvIF>

	<MvASSIGN NAME = "l.settings" VALUE = "{ l.working_settings }">

	<MvFUNCTIONRETURN>
</MvFUNCTION>

<MvFUNCTION NAME = "ComponentModule_Provision_ImageTypes" PARAMETERS = "module var, provide_xml var, settings var" STANDARDOUTPUTLEVEL = "">
	<MvASSIGN NAME = "l.settings:imagetypes" VALUE = "">

	<MvFOREACH ITERATOR = "l.child" ARRAY = "l.provide_xml:children" COUNT = "{ miva_array_elements( l.provide_xml:children ) }">
		<MvIF EXPR = "{ [ g.Module_Library_DB ].ImageType_Load_Code( l.child:value, l.imagetype ) }">
			<MvASSIGN NAME = "l.type_count" VALUE = "{ miva_array_insert( l.settings:imagetypes, l.imagetype:code, -1 ) }">
		</MvIF>
	</MvFOREACH>

	<MvFUNCTIONRETURN VALUE = 1>
</MvFUNCTION>

<MvFUNCTION NAME = "ComponentModule_Provision_Fields" PARAMETERS = "module var, provide_xml var, settings var" STANDARDOUTPUTLEVEL = "">
	<MvASSIGN NAME = "l.settings:field_code"				VALUE = 0>
	<MvASSIGN NAME = "l.settings:field_name"				VALUE = 0>
	<MvASSIGN NAME = "l.settings:field_options"				VALUE = 0>
	<MvASSIGN NAME = "l.settings:field_quantity"			VALUE = 0>
	<MvASSIGN NAME = "l.settings:field_price"				VALUE = 0>
	<MvASSIGN NAME = "l.settings:field_firstdate"			VALUE = 0>
	<MvASSIGN NAME = "l.settings:field_lastdate"			VALUE = 0>
	<MvASSIGN NAME = "l.settings:field_nextdate"			VALUE = 0>
	<MvASSIGN NAME = "l.settings:field_cncldate"			VALUE = 0>
	<MvASSIGN NAME = "l.settings:field_termrem"				VALUE = 0>
	<MvASSIGN NAME = "l.settings:field_termproc"			VALUE = 0>
	<MvASSIGN NAME = "l.settings:field_paymentmethod"		VALUE = 0>
	<MvASSIGN NAME = "l.settings:field_shippingaddress"		VALUE = 0>
	<MvASSIGN NAME = "l.settings:fields_custom"				VALUE = "">
	<MvASSIGN NAME = "l.customfield_count"					VALUE = 0>

	<MvFOREACH ITERATOR = "l.child" ARRAY = "l.provide_xml:children" COUNT = "{ miva_array_elements( l.provide_xml:children ) }">
		<MvASSIGN NAME = "l.name"					VALUE = "{ tolower( l.child:name ) }">

		<MvIF EXPR = "{ l.name EQ 'code' }">				<MvASSIGN NAME = "l.settings:field_code"				VALUE = 1>
		<MvELSEIF EXPR = "{ l.name EQ 'name' }">			<MvASSIGN NAME = "l.settings:field_name"				VALUE = 1>
		<MvELSEIF EXPR = "{ l.name EQ 'options' }">			<MvASSIGN NAME = "l.settings:field_options"				VALUE = 1>
		<MvELSEIF EXPR = "{ l.name EQ 'quantity' }">		<MvASSIGN NAME = "l.settings:field_quantity"			VALUE = 1>
		<MvELSEIF EXPR = "{ l.name EQ 'price' }">			<MvASSIGN NAME = "l.settings:field_price"				VALUE = 1>
		<MvELSEIF EXPR = "{ l.name EQ 'firstorderdate' }">	<MvASSIGN NAME = "l.settings:field_firstdate"			VALUE = 1>
		<MvELSEIF EXPR = "{ l.name EQ 'lastorderdate' }">	<MvASSIGN NAME = "l.settings:field_lastdate"			VALUE = 1>
		<MvELSEIF EXPR = "{ l.name EQ 'nextorderdate' }">	<MvASSIGN NAME = "l.settings:field_nextdate"			VALUE = 1>
		<MvELSEIF EXPR = "{ l.name EQ 'canceldate' }">		<MvASSIGN NAME = "l.settings:field_cncldate"			VALUE = 1>
		<MvELSEIF EXPR = "{ l.name EQ 'termremaining' }">	<MvASSIGN NAME = "l.settings:field_termrem"				VALUE = 1>
		<MvELSEIF EXPR = "{ l.name EQ 'termprocessed' }">	<MvASSIGN NAME = "l.settings:field_termproc"			VALUE = 1>
		<MvELSEIF EXPR = "{ l.name EQ 'paymentmethod' }">	<MvASSIGN NAME = "l.settings:field_paymentmethod"		VALUE = 1>
		<MvELSEIF EXPR = "{ l.name EQ 'shippingaddress' }">	<MvASSIGN NAME = "l.settings:field_shippingaddress"		VALUE = 1>
		<MvELSEIF EXPR = "{ l.name EQ 'custom' }">
			<MvASSIGN NAME = "l.customfield_count" 	VALUE = "{ l.customfield_count + 1 }">

			<MvIF EXPR = "{ NOT [ g.Module_Feature_PRV_AD ].PRV_Attribute_Text( l.child, 'module',	l.settings:fields_custom[ l.customfield_count ]:module ) OR
							NOT [ g.Module_Feature_PRV_AD ].PRV_Attribute_Text( l.child, 'code',	l.settings:fields_custom[ l.customfield_count ]:code ) }">
				<MvFUNCTIONRETURN VALUE = 0>
			</MvIF>
		</MvIF>
	</MvFOREACH>

	<MvFUNCTIONRETURN VALUE = 1>
</MvFUNCTION>

<MvFUNCTION NAME = "SkinsComponentModule_Description" PARAMETERS = "module var, item var" STANDARDOUTPUTLEVEL = "">
	<MvASSIGN NAME = "l.pages" VALUE = "{ [ g.Module_Feature_TUI_DB ].Item_Load_PageList( l.item ) }">

	<MvFUNCTIONRETURN VALUE = "{ 'Exports Subscriptions template from pages: ' $ l.pages }">
</MvFUNCTION>

<MvFUNCTION NAME = "SkinsComponentModule_Export_Item" PARAMETERS = "module var, item, output var" STANDARDOUTPUTLEVEL = "">
	<MvCAPTURE VARIABLE = "l.output" STANDARDOUTPUTLEVEL = "text, html, compresswhitespace">
		<MvFOREACH ITERATOR = "l.page" ARRAY = "l.pages" COUNT = "{ [ g.Module_Feature_TUI_DB ].PageList_Load_Item_Runtime( l.item:id, l.pages ) }">
			<MvREFERENCEARRAY NAME = "l.settings" VARIABLE = "l.page:settings">
				<MvMEMBER NAME = "{ l.item:code }">
			</MvREFERENCEARRAY>

			<Page_Update code="{ l.page:code }">
				<Item code="{ l.item:code }">
					<ItemsPerPage><MvEVAL EXPR = "{ int( l.settings:per_page ) }"></ItemsPerPage>
					<PageCountNumber><MvEVAL EXPR = "{ int( l.settings:page_disp_count ) }"></PageCountNumber>
					<DisplayItemsPerPage><MvIF EXPR = "{ l.settings:items_per_page_filter }">Yes<MvELSE>No</MvIF></DisplayItemsPerPage>

					<MvIF EXPR = "{ l.settings:hide_cancelled EQ 'A' }">											<HideCancelled>Always</HideCancelled>
					<MvELSEIF EXPR = "{ ISNULL l.settings:hide_cancelled OR l.settings:hide_cancelled EQ 'N' }">	<HideCancelled>Never</HideCancelled>
					<MvELSE>																						<HideCancelled days="{ int( l.settings:hide_cancelled_days ) }">Days</HideCancelled>
					</MvIF>

					<SortBySwitch><MvIF EXPR = "{ l.settings:sort_by:switch }">Yes<MvELSE>No</MvIF></SortBySwitch>
					<SortByName><MvIF EXPR = "{ l.settings:sort_by:name }">Yes<MvELSE>No</MvIF></SortByName>
					<SortByCode><MvIF EXPR = "{ l.settings:sort_by:code }">Yes<MvELSE>No</MvIF></SortByCode>
					<SortByEstimatedTotal><MvIF EXPR = "{ l.settings:sort_by:total }">Yes<MvELSE>No</MvIF></SortByEstimatedTotal>
					<SortByFirstOrderDate><MvIF EXPR = "{ l.settings:sort_by:firstdate }">Yes<MvELSE>No</MvIF></SortByFirstOrderDate>
					<SortByLastOrderDate><MvIF EXPR = "{ l.settings:sort_by:lastdate }">Yes<MvELSE>No</MvIF></SortByLastOrderDate>
					<SortByNextOrderDate><MvIF EXPR = "{ l.settings:sort_by:nextdate }">Yes<MvELSE>No</MvIF></SortByNextOrderDate>
					<SortByPaymentMethod><MvIF EXPR = "{ l.settings:sort_by:payment }">Yes<MvELSE>No</MvIF></SortByPaymentMethod>
					<SortByShippingMethod><MvIF EXPR = "{ l.settings:sort_by:shipping }">Yes<MvELSE>No</MvIF></SortByShippingMethod>
					<SortByTermRemaining><MvIF EXPR = "{ l.settings:sort_by:termrem }">Yes<MvELSE>No</MvIF></SortByTermRemaining>
					<SortByTermProcessed><MvIF EXPR = "{ l.settings:sort_by:termproc }">Yes<MvELSE>No</MvIF></SortByTermProcessed>
					<DefaultSort><MvIF EXPR = "{ ISNULL l.settings:default_sort }">id_desc<MvELSE><MvEVAL EXPR = "{ l.settings:default_sort }"></MvIF></DefaultSort>
					<ReverseDefaultDisplayOrder><MvIF EXPR = "{ l.settings:reverse_default_disp_order }">Yes<MvELSE>No</MvIF></ReverseDefaultDisplayOrder>
					<PriceDisplay><MvIF EXPR = "{ l.settings:price EQ 'retail' }">Retail<MvELSEIF EXPR = "{ l.settings:price EQ 'sale' }">Sale<MvELSE>Base</MvIF></PriceDisplay>
					<AdditionalPriceDisplay><MvIF EXPR = "{ l.settings:additionalprice EQ 'retail' }">Retail<MvELSEIF EXPR = "{ l.settings:additionalprice EQ 'base' }">Base<MvELSE>None</MvIF></AdditionalPriceDisplay>
					<DisplayShipping><MvIF EXPR = "{ l.settings:display:shipping }">Yes<MvELSE>No</MvIF></DisplayShipping>
					<DisplayHandling><MvIF EXPR = "{ l.settings:display:handling }">Yes<MvELSE>No</MvIF></DisplayHandling>
					<DisplaySalesTax><MvIF EXPR = "{ l.settings:display:salestax }">Yes<MvELSE>No</MvIF></DisplaySalesTax>
					<DisplayDiscounts><MvIF EXPR = "{ l.settings:display:discounts }">Yes<MvELSE>No</MvIF></DisplayDiscounts>
					<DisplayLineItemDiscountDetails><MvIF EXPR = "{ l.settings:lineitemdiscounts }">Yes<MvELSE>No</MvIF></DisplayLineItemDiscountDetails>

					<Fields>
						<MvIF EXPR = "{ l.settings:field_code }"><Code /></MvIF>
						<MvIF EXPR = "{ l.settings:field_name }"><Name /></MvIF>
						<MvIF EXPR = "{ l.settings:field_options }"><Options /></MvIF>
						<MvIF EXPR = "{ l.settings:field_quantity }"><Quantity /></MvIF>
						<MvIF EXPR = "{ l.settings:field_price }"><Price /></MvIF>
						<MvIF EXPR = "{ l.settings:field_firstdate }"><FirstOrderDate /></MvIF>
						<MvIF EXPR = "{ l.settings:field_lastdate }"><LastOrderDate /></MvIF>
						<MvIF EXPR = "{ l.settings:field_nextdate }"><NextOrderDate /></MvIF>
						<MvIF EXPR = "{ l.settings:field_cncldate }"><CancelDate /></MvIF>
						<MvIF EXPR = "{ l.settings:field_termrem }"><TermRemaining /></MvIF>
						<MvIF EXPR = "{ l.settings:field_termproc }"><TermProcessed /></MvIF>
						<MvIF EXPR = "{ l.settings:field_paymentmethod }"><PaymentMethod /></MvIF>
						<MvIF EXPR = "{ l.settings:field_shippingaddress }"><ShippingAddress /></MvIF>

						<MvFOREACH ITERATOR = "l.customfield" ARRAY = "l.settings:fields_custom">
							<Custom module="{ l.customfield:module }" code="{ l.customfield:code }" />
						</MvFOREACH>
					</Fields>

					<ImageTypes>
						<MvFOREACH ITERATOR = "l.imagetype" ARRAY = "l.settings:imagetypes">
							<ImageType><MvEVAL EXPR = "{ [ g.Module_Library_Utilities ].CDATA_Encode( l.imagetype ) }"></ImageType>
						</MvFOREACH>
					</ImageTypes>

					<MvIF EXPR = "{ l.settings:constrain NE 'B' }">
						<ImageDimensions constrain="No" />
					<MvELSE>
						<ImageDimensions constrain="Yes">
							<Width><MvEVAL EXPR = "{ int( l.settings:b_width ) }"></Width>
							<Height><MvEVAL EXPR = "{ int( l.settings:b_height ) }"></Height>
						</ImageDimensions>
					</MvIF>

					<MvIF EXPR = "{ l.settings:advanced }">
						<MvIF EXPR = "{ [ g.Module_Feature_TUI_DB ].ManagedTemplateVersion_Load_Filename_Current( l.settings:template_filename, l.templateversion ) }">
							<Template><MvEVAL EXPR = "{ miva_cdata_encode( l.templateversion:source ) }"></Template>
						</MvIF>
					</MvIF>

					<Notes>#Set_Current_Time#</Notes>
				</Item>
			</Page_Update>
		</MvFOREACH>
	</MvCAPTURE>
</MvFUNCTION>

<MvFUNCTION NAME = "ComponentModule_Generate_Code" PARAMETERS = "settings var, code var" STANDARDOUTPUTLEVEL = "">
	<MvIF EXPR = "{ l.settings:price EQ 'retail' }">
		<MvASSIGN NAME = "l.price_variable"						VALUE = "l.settings:item:retail">
		<MvASSIGN NAME = "l.price_token"						VALUE = "&mvt:item:formatted_retail;">
		<MvASSIGN NAME = "l.price_variable_option"				VALUE = "l.settings:option:retail">
		<MvASSIGN NAME = "l.price_token_option"					VALUE = "&mvt:option:formatted_retail;">
		<MvASSIGN NAME = "l.price_subtotal_variable"			VALUE = "l.settings:item:subtotal_retail_comprehensive">
		<MvASSIGN NAME = "l.price_subtotal_token"				VALUE = "&mvt:item:formatted_subtotal_retail_comprehensive;">
	<MvELSEIF EXPR = "{ l.settings:price EQ 'sale' }">
		<MvASSIGN NAME = "l.price_variable"						VALUE = "l.settings:item:price">
		<MvASSIGN NAME = "l.price_token"						VALUE = "&mvt:item:formatted_price;">
		<MvASSIGN NAME = "l.price_variable_option"				VALUE = "l.settings:option:price">
		<MvASSIGN NAME = "l.price_token_option"					VALUE = "&mvt:option:formatted_price;">
		<MvASSIGN NAME = "l.price_subtotal_variable"			VALUE = "l.settings:item:subtotal_comprehensive">
		<MvASSIGN NAME = "l.price_subtotal_token"				VALUE = "&mvt:item:formatted_total;">
	<MvELSE>
		<MvASSIGN NAME = "l.price_variable"						VALUE = "l.settings:item:base_price">
		<MvASSIGN NAME = "l.price_token"						VALUE = "&mvt:item:formatted_base_price;">
		<MvASSIGN NAME = "l.price_variable_option"				VALUE = "l.settings:option:base_price">
		<MvASSIGN NAME = "l.price_token_option"					VALUE = "&mvt:option:formatted_base_price;">
		<MvASSIGN NAME = "l.price_subtotal_variable"			VALUE = "l.settings:item:subtotal_base_price_comprehensive">
		<MvASSIGN NAME = "l.price_subtotal_token"				VALUE = "&mvt:item:formatted_subtotal_base_price_comprehensive;">
	</MvIF>

	<MvCAPTURE VARIABLE = "l.code">
<MIVA STANDARDOUTPUTLEVEL = "text, html"><mvt:if expr="l.settings:subscriptions:total_count EQ 0">
	<div class="subscriptions_container subscriptions_empty">No subscriptions</div>
	<mvt:exit />
</mvt:if>

<div class="subscriptions_container">
	<div id="filter-items-container"><MIVA STANDARDOUTPUTLEVEL = "">
	<MvIF EXPR = "{ l.settings:sort_by:switch }"><MIVA STANDARDOUTPUTLEVEL = "text, html">
		<mvt:if expr="l.settings:subscriptions:total_count GT 1">
			<div class="sorting">
				<label for="Sort_By">Sort By:</label>
				<select name="Sort_By" id="Sort_By" onchange="window.location.href='&mvtj:urls:_self:auto_sep;Per_Page=' + encodeURIComponent( '&mvtj:global:Per_Page;' ) + '&amp;Sort_By=' + encodeURIComponent( this.options[ this.selectedIndex ].value );"><MIVA STANDARDOUTPUTLEVEL = "">
				<MvIF EXPR = "{ l.settings:default_sort EQ 'id_desc' }"><MIVA STANDARDOUTPUTLEVEL = "text, html">
					<mvt:if expr="ISNULL g.Sort_By">
						<option value="id_desc" selected="selected">Default</option>
					<mvt:else>
						<option value="id_desc">Default</option>
					</mvt:if><MIVA STANDARDOUTPUTLEVEL = "">
				</MvIF>

				<MvIF EXPR = "{ l.settings:sort_by:code }">
					<MvASSIGN NAME = "l.sort:disp_name_ascending"	VALUE = "Code Ascending">
					<MvASSIGN NAME = "l.sort:disp_code_ascending"	VALUE = "code_asc">
					<MvASSIGN NAME = "l.sort:disp_name_descending"	VALUE = "Code Descending">
					<MvASSIGN NAME = "l.sort:disp_code_descending"	VALUE = "code_desc">

					<MvASSIGN NAME = "l.sort_count"					VALUE = "{ miva_array_insert( l.sorts, l.sort, -1 ) }">
				</MvIF>

				<MvIF EXPR = "{ l.settings:sort_by:name }">
					<MvASSIGN NAME = "l.sort:disp_name_ascending"	VALUE = "Name Ascending">
					<MvASSIGN NAME = "l.sort:disp_code_ascending"	VALUE = "name_asc">
					<MvASSIGN NAME = "l.sort:disp_name_descending"	VALUE = "Name Descending">
					<MvASSIGN NAME = "l.sort:disp_code_descending"	VALUE = "name_desc">

					<MvASSIGN NAME = "l.sort_count"					VALUE = "{ miva_array_insert( l.sorts, l.sort, -1 ) }">
				</MvIF>

				<MvIF EXPR = "{ l.settings:sort_by:total }">
					<MvASSIGN NAME = "l.sort:disp_name_ascending"	VALUE = "Lowest Order Total">
					<MvASSIGN NAME = "l.sort:disp_code_ascending"	VALUE = "total_asc">
					<MvASSIGN NAME = "l.sort:disp_name_descending"	VALUE = "Highest Order Total">
					<MvASSIGN NAME = "l.sort:disp_code_descending"	VALUE = "total_desc">

					<MvASSIGN NAME = "l.sort_count"					VALUE = "{ miva_array_insert( l.sorts, l.sort, -1 ) }">
				</MvIF>

				<MvIF EXPR = "{ l.settings:sort_by:firstdate }">
					<MvASSIGN NAME = "l.sort:disp_name_ascending"	VALUE = "First Date Ascending">
					<MvASSIGN NAME = "l.sort:disp_code_ascending"	VALUE = "firstdate_asc">
					<MvASSIGN NAME = "l.sort:disp_name_descending"	VALUE = "First Date Descending">
					<MvASSIGN NAME = "l.sort:disp_code_descending"	VALUE = "firstdate_desc">

					<MvASSIGN NAME = "l.sort_count"					VALUE = "{ miva_array_insert( l.sorts, l.sort, -1 ) }">
				</MvIF>

				<MvIF EXPR = "{ l.settings:sort_by:lastdate }">
					<MvASSIGN NAME = "l.sort:disp_name_ascending"	VALUE = "Last Date Ascending">
					<MvASSIGN NAME = "l.sort:disp_code_ascending"	VALUE = "lastdate_asc">
					<MvASSIGN NAME = "l.sort:disp_name_descending"	VALUE = "Last Date Descending">
					<MvASSIGN NAME = "l.sort:disp_code_descending"	VALUE = "lastdate_desc">

					<MvASSIGN NAME = "l.sort_count"					VALUE = "{ miva_array_insert( l.sorts, l.sort, -1 ) }">
				</MvIF>

				<MvIF EXPR = "{ l.settings:sort_by:nextdate }">
					<MvASSIGN NAME = "l.sort:disp_name_ascending"	VALUE = "Next Date Ascending">
					<MvASSIGN NAME = "l.sort:disp_code_ascending"	VALUE = "nextdate_asc">
					<MvASSIGN NAME = "l.sort:disp_name_descending"	VALUE = "Next Date Descending">
					<MvASSIGN NAME = "l.sort:disp_code_descending"	VALUE = "nextdate_desc">

					<MvASSIGN NAME = "l.sort_count"					VALUE = "{ miva_array_insert( l.sorts, l.sort, -1 ) }">
				</MvIF>

				<MvIF EXPR = "{ l.settings:sort_by:payment }">
					<MvASSIGN NAME = "l.sort:disp_name_ascending"	VALUE = "Payment Method Ascending">
					<MvASSIGN NAME = "l.sort:disp_code_ascending"	VALUE = "payment_asc">
					<MvASSIGN NAME = "l.sort:disp_name_descending"	VALUE = "Payment Method Descending">
					<MvASSIGN NAME = "l.sort:disp_code_descending"	VALUE = "payment_desc">

					<MvASSIGN NAME = "l.sort_count"					VALUE = "{ miva_array_insert( l.sorts, l.sort, -1 ) }">
				</MvIF>

				<MvIF EXPR = "{ l.settings:sort_by:shipping }">
					<MvASSIGN NAME = "l.sort:disp_name_ascending"	VALUE = "Shipping Method Ascending">
					<MvASSIGN NAME = "l.sort:disp_code_ascending"	VALUE = "shipping_asc">
					<MvASSIGN NAME = "l.sort:disp_name_descending"	VALUE = "Shipping Method Descending">
					<MvASSIGN NAME = "l.sort:disp_code_descending"	VALUE = "shipping_desc">

					<MvASSIGN NAME = "l.sort_count"					VALUE = "{ miva_array_insert( l.sorts, l.sort, -1 ) }">
				</MvIF>

				<MvIF EXPR = "{ l.settings:sort_by:termrem }">
					<MvASSIGN NAME = "l.sort:disp_name_ascending"	VALUE = "Remaining Orders Ascending">
					<MvASSIGN NAME = "l.sort:disp_code_ascending"	VALUE = "termrem_asc">
					<MvASSIGN NAME = "l.sort:disp_name_descending"	VALUE = "Remaining Orders Descending">
					<MvASSIGN NAME = "l.sort:disp_code_descending"	VALUE = "termrem_desc">

					<MvASSIGN NAME = "l.sort_count"					VALUE = "{ miva_array_insert( l.sorts, l.sort, -1 ) }">
				</MvIF>

				<MvIF EXPR = "{ l.settings:sort_by:termproc }">
					<MvASSIGN NAME = "l.sort:disp_name_ascending"	VALUE = "Processed Orders Ascending">
					<MvASSIGN NAME = "l.sort:disp_code_ascending"	VALUE = "termproc_asc">
					<MvASSIGN NAME = "l.sort:disp_name_descending"	VALUE = "Processed Orders Descending">
					<MvASSIGN NAME = "l.sort:disp_code_descending"	VALUE = "termproc_desc">

					<MvASSIGN NAME = "l.sort_count"					VALUE = "{ miva_array_insert( l.sorts, l.sort, -1 ) }">
				</MvIF>

				<MvFOREACH ITERATOR = "l.sort" ARRAY = "l.sorts" COUNT = "{ l.sort_count }">
					<MvIF EXPR = "{ NOT ISNULL l.sort:disp_name_ascending }"><MIVA STANDARDOUTPUTLEVEL = "text, html">
					<mvt:if expr="{ 'g.Sort_By EQ \'' $ encodeentities( l.sort:disp_code_ascending ) $ '\'' }">
						<option value="{ encodeentities( l.sort:disp_code_ascending ) }" selected="selected"><MvEVAL EXPR = "{ encodeentities( l.sort:disp_name_ascending ) }"></option>
					<mvt:else>
						<option value="{ encodeentities( l.sort:disp_code_ascending ) }"><MvEVAL EXPR = "{ encodeentities( l.sort:disp_name_ascending ) }"></option>
					</mvt:if><MIVA STANDARDOUTPUTLEVEL = "">
					</MvIF>
					
					<MvIF EXPR = "{ NOT ISNULL l.sort:disp_name_descending }"><MIVA STANDARDOUTPUTLEVEL = "text, html">
					<mvt:if expr="{ 'g.Sort_By EQ \'' $ encodeentities( l.sort:disp_code_descending ) $ '\'' }">
						<option value="{ encodeentities( l.sort:disp_code_descending ) }" selected="selected"><MvEVAL EXPR = "{ encodeentities( l.sort:disp_name_descending ) }"></option>
					<mvt:else>
						<option value="{ encodeentities( l.sort:disp_code_descending ) }"><MvEVAL EXPR = "{ encodeentities( l.sort:disp_name_descending ) }"></option>
					</mvt:if><MIVA STANDARDOUTPUTLEVEL = "">
					</MvIF>
				</MvFOREACH>
				
				<MIVA STANDARDOUTPUTLEVEL = "text, html">
				</select>
			</div>
		</mvt:if>
<MIVA STANDARDOUTPUTLEVEL = "">
	</MvIF>
		
	<MvIF EXPR = "{ l.settings:items_per_page_filter }">
		<MvIF EXPR = "{ l.settings:per_page EQ 0 OR ISNULL l.settings:per_page }">
			<MvASSIGN NAME = "l.per_page" VALUE = 10>
		<MvELSE>
			<MvASSIGN NAME = "l.per_page" VALUE = "{ l.settings:per_page }">
		</MvIF>
		
		<MIVA STANDARDOUTPUTLEVEL = "text, html">
		<mvt:if expr="l.settings:subscriptions:total_count GT 1">
			<div class="per-page">
				<label for="Per_Page">View:</label>
				<select name="Per_Page" id="Per_Page" onchange="window.location.href='&mvtj:urls:_self:auto_sep;Per_Page=' + encodeURIComponent( this.options[ this.selectedIndex ].value ) + '&amp;Sort_By=' + encodeURIComponent( '&mvtj:global:Sort_By;' );"><MIVA STANDARDOUTPUTLEVEL = "">
				<MvASSIGN NAME = "l.multiplier" VALUE = 1>
				<MvASSIGN NAME = "l.count" VALUE = 1>
					
				<MvWHILE EXPR = "{ l.count LE 3 }">
					<MvASSIGN NAME = "l.items_per" VALUE = "{ l.per_page * l.multiplier }">
					<MvASSIGN NAME = "l.multiplier" VALUE = "{ l.multiplier + l.count }"><MIVA STANDARDOUTPUTLEVEL = "text, html">
					<mvt:if expr="{ 'g.Per_Page EQ ' $ encodeentities( l.items_per ) }">
						<option value="{ encodeentities( l.items_per ) }" selected="selected"><MvEVAL EXPR = "{ encodeentities( l.items_per ) }"></option>
					<mvt:else>
						<option value="{ encodeentities( l.items_per ) }"><MvEVAL EXPR = "{ encodeentities( l.items_per ) }"></option>
					</mvt:if><MIVA STANDARDOUTPUTLEVEL = "">
					<MvASSIGN NAME = "l.count" VALUE = "{ l.count + 1 }">
				</MvWHILE>
					
					<MIVA STANDARDOUTPUTLEVEL = "text, html">
					<mvt:if expr="g.Per_Page EQ -1">
						<option value="-1" selected="selected">All</option>
					<mvt:else>
						<option value="-1">All</option>
					</mvt:if>
				</select>
			</div>
		</mvt:if>
<MIVA STANDARDOUTPUTLEVEL = "">
	</MvIF><MIVA STANDARDOUTPUTLEVEL = "text, html">
		<mvt:if expr="l.settings:subscriptions:page_links:last_page GT 1">
			<div class="page-links">
				<span class="page-links-title">Page(s):</span>
				<span class="page-links-container">
					<mvt:if expr="l.settings:subscriptions:page_links:current_page NE 1">
						<a href="&mvte:urls:_self:auto_sep;&mvte:subscriptions:page_links:prev_link_params;" class="page-links-previous">&lt;</a>
					<mvt:else>
						<span class="page-links-previous page-links-deactivated">&lt;</span>
					</mvt:if>
					<mvt:if expr="l.settings:subscriptions:page_links:current_page NE l.settings:subscriptions:page_links:last_page">
						<a href="&mvte:urls:_self:auto_sep;&mvte:subscriptions:page_links:next_link_params;" class="page-links-next">&gt;</a>
					<mvt:else>
						<span class="page-links-next page-links-deactivated">&gt;</span>
					</mvt:if>
					<span class="page-disp">
						<mvt:if expr="NOT l.settings:subscriptions:page_links:contains_first">
							<a href="&mvte:urls:_self:auto_sep;&mvte:subscriptions:page_links:first_link_params;" class="page-links-inactive">1</a>...
						</mvt:if>
						<mvt:foreach iterator="pages" array="subscriptions:page_links:pages">
							<mvt:if expr="l.settings:subscriptions:page_links:current_page EQ l.settings:pages:page_num">
								<span class="page-links-active">&mvte:pages:page_num;</span>
							<mvt:else>
								<a href="&mvte:urls:_self:auto_sep;&mvte:pages:link_params;" class="page-links-inactive">&mvte:pages:page_num;</a>
							</mvt:if>
						</mvt:foreach>
						<mvt:if expr="NOT l.settings:subscriptions:page_links:contains_last">
							...<a href="&mvte:urls:_self:auto_sep;&mvte:subscriptions:page_links:last_link_params;" class="page-links-inactive"><MvEVAL EXPR = "&mvte:subscriptions:page_links:last_page;"></a>
						</mvt:if>
					</span>
				</span>
			</div>
		</mvt:if>
	</div>

	<div class="clear"></div>

	<mvt:foreach iterator="subscription" array="subscriptions:items">
		<span class="subscription_entry">
			<span class="subscription_entry_title">&mvte:subscription:productsubscriptionterm:descrip;<mvt:if expr="l.settings:subscription:status EQ 'C'"> (Cancelled)</mvt:if></span>

			<mvt:if expr="l.settings:subscription:status EQ 'E'">
				<span class="subscription_entry_error">Processing Error: &mvte:subscription:message;</span>
			</mvt:if>

			<span class="subscription_entry_content"><MIVA STANDARDOUTPUTLEVEL = "">
			<MvIF EXPR = "{ l.settings:field_firstdate OR l.settings:field_lastdate OR l.settings:field_nextdate OR l.settings:field_cncldate OR l.settings:field_termrem OR l.settings:field_termproc OR l.settings:field_paymentmethod OR l.settings:field_shippingaddress }"><MIVA STANDARDOUTPUTLEVEL = "text, html">
				<span class="subscription_entry_content_details"><MIVA STANDARDOUTPUTLEVEL = "">

				<MvIF EXPR = "{ l.settings:field_shippingaddress }"><MIVA STANDARDOUTPUTLEVEL = "text, html">
					<span class="subscription_entry_content_section_left">
						<span class="subscription_entry_content_details_block">
							<span class="subscription_entry_content_details_line_title">Shipping Address</span>
							<span class="subscription_entry_content_details_line">&mvte:subscription:address:fname; &mvte:subscription:address:lname;</span>

							<mvt:if expr="NOT ISNULL l.settings:subscription:address:addr1">
								<span class="subscription_entry_content_details_line">&mvte:subscription:address:addr1;</span>
							</mvt:if>

							<mvt:if expr="NOT ISNULL l.settings:subscription:address:addr2">
								<span class="subscription_entry_content_details_line">&mvte:subscription:address:addr2;</span>
							</mvt:if>

							<mvt:if expr="NOT ISNULL l.settings:subscription:address:city OR NOT ISNULL l.settings:subscription:address:state OR NOT ISNULL l.settings:subscription:address:zip">
								<span class="subscription_entry_content_details_line">
									<mvt:if expr="NOT ISNULL l.settings:subscription:address:city">
										&mvte:subscription:address:city;<mvt:if expr="NOT ISNULL l.settings:subscription:address:city AND NOT ISNULL l.settings:subscription:address:state">,</mvt:if>
									</mvt:if>

									<mvt:if expr="NOT ISNULL l.settings:subscription:address:state">
										&mvte:subscription:address:state;
									</mvt:if>

									<mvt:if expr="NOT ISNULL l.settings:subscription:address:zip">
										&mvte:subscription:address:zip;
									</mvt:if>
								</span>
							</mvt:if>

							<mvt:if expr="NOT ISNULL l.settings:subscription:address:cntry">
								<span class="subscription_entry_content_details_line">&mvte:subscription:address:cntry;</span>
							</mvt:if>
						</span>
					</span><MIVA STANDARDOUTPUTLEVEL = "">
				</MvIF>

				<MvIF EXPR = "{ l.settings:field_firstdate OR l.settings:field_lastdate OR l.settings:field_nextdate OR l.settings:field_cncldate OR l.settings:field_termrem OR l.settings:field_termproc OR l.settings:field_paymentmethod }"><MIVA STANDARDOUTPUTLEVEL = "text, html">
					<span class="subscription_entry_content_section_right"><MIVA STANDARDOUTPUTLEVEL = "">

					<MvIF EXPR = "{ l.settings:field_paymentmethod }"><MIVA STANDARDOUTPUTLEVEL = "text, html">
						<span class="subscription_entry_content_details_line">
							<b>Payment Method:</b>

							<mvt:if expr="l.settings:subscription:paymentcard:id">
								&mvte:subscription:paymentcard:type; ending in &mvte:subscription:paymentcard:lastfour;
							<mvt:else>
								&lt;None&gt;
							</mvt:if>
						</span><MIVA STANDARDOUTPUTLEVEL = "">
					</MvIF>

					<MvIF EXPR = "{ l.settings:field_firstdate }"><MIVA STANDARDOUTPUTLEVEL = "text, html">
						<span class="subscription_entry_content_details_line">
							<b>First Order Date:</b>

							<mvt:if expr="l.settings:subscription:firstdate EQ 0">
								N/A
							<mvt:else>
								&mvt:subscription:formatted_firstdate_date;
							</mvt:if>
						</span><MIVA STANDARDOUTPUTLEVEL = "">
					</MvIF>

					<MvIF EXPR = "{ l.settings:field_lastdate }"><MIVA STANDARDOUTPUTLEVEL = "text, html">
						<span class="subscription_entry_content_details_line">
							<b>Last Order Date:</b>

							<mvt:if expr="l.settings:subscription:lastdate EQ 0">
								N/A
							<mvt:else>
								&mvt:subscription:formatted_lastdate_date;
							</mvt:if>
						</span><MIVA STANDARDOUTPUTLEVEL = "">
					</MvIF>

					<MvIF EXPR = "{ l.settings:field_nextdate }"><MIVA STANDARDOUTPUTLEVEL = "text, html">
						<mvt:if expr="l.settings:subscription:status NE 'C'">
							<span class="subscription_entry_content_details_line">
								<b>Next Order Date:</b>

								<mvt:if expr="l.settings:subscription:nextdate EQ 0">
									N/A
								<mvt:else>
									&mvt:subscription:formatted_nextdate_date;
								</mvt:if>
							</span>
						</mvt:if><MIVA STANDARDOUTPUTLEVEL = "">
					</MvIF>

					<MvIF EXPR = "{ l.settings:field_cncldate }"><MIVA STANDARDOUTPUTLEVEL = "text, html">
						<mvt:if expr="l.settings:subscription:status EQ 'C'">
							<span class="subscription_entry_content_details_line">
								<b>Cancellation Date:</b>

								<mvt:if expr="l.settings:subscription:cncldate EQ 0">
									N/A
								<mvt:else>
									&mvt:subscription:formatted_cncldate_date;
								</mvt:if>
							</span>
						</mvt:if><MIVA STANDARDOUTPUTLEVEL = "">
					</MvIF>

					<MvIF EXPR = "{ l.settings:field_termrem }"><MIVA STANDARDOUTPUTLEVEL = "text, html">

						<mvt:if expr="l.settings:subscription:productsubscriptionterm:term GT 0">
							<span class="subscription_entry_content_details_line"><b>Remaining Orders:</b> &mvte:subscription:termrem;</span>
						</mvt:if><MIVA STANDARDOUTPUTLEVEL = "">
					</MvIF>

					<MvIF EXPR = "{ l.settings:field_termproc }"><MIVA STANDARDOUTPUTLEVEL = "text, html">
						<span class="subscription_entry_content_details_line"><b>Processed Orders:</b> &mvte:subscription:termproc;</span><MIVA STANDARDOUTPUTLEVEL = "">
					</MvIF>

					<MIVA STANDARDOUTPUTLEVEL = "text, html">
					</span><MIVA STANDARDOUTPUTLEVEL = "">
				</MvIF><MIVA STANDARDOUTPUTLEVEL = "text, html">

					<div class="clear"></div>
				</span><MIVA STANDARDOUTPUTLEVEL = "">
			</MvIF>

			<MvIF EXPR = "{ l.settings:field_code OR l.settings:field_name OR l.settings:field_options OR l.settings:field_quantity OR l.settings:field_price }"><MIVA STANDARDOUTPUTLEVEL = "text, html">
				<span class="subscription_entry_content_items">
					<table>
						<tr class="heading"><MIVA STANDARDOUTPUTLEVEL = "">
							<MvIF EXPR = "{ NOT ISNULL l.settings:imagetypes[ 1 ] }"><MIVA STANDARDOUTPUTLEVEL = "text, html">
							<td class="item-remove">&nbsp;</td><MIVA STANDARDOUTPUTLEVEL = "">
							</MvIF>

							<MvIF EXPR = "{ l.settings:field_code OR l.settings:field_name OR l.settings:field_options }"><MIVA STANDARDOUTPUTLEVEL = "text, html">
							<td class="item-name">Item</td><MIVA STANDARDOUTPUTLEVEL = "">
							</MvIF>

							<MvIF EXPR = "{ l.settings:field_quantity }"><MIVA STANDARDOUTPUTLEVEL = "text, html">
							<td class="item-quantity">Qty.</td><MIVA STANDARDOUTPUTLEVEL = "">
							</MvIF>

							<MvIF EXPR = "{ l.settings:field_price }"><MIVA STANDARDOUTPUTLEVEL = "text, html">
							<td class="item-price">Item Price</td><MIVA STANDARDOUTPUTLEVEL = "">
							</MvIF>

							<MvIF EXPR = "{ l.settings:field_price OR l.settings:display:shipping OR l.settings:display:handling OR l.settings:display:salestax OR l.settings:display:discounts }"><MIVA STANDARDOUTPUTLEVEL = "text, html">
							<td class="item-total">Total Price</td><MIVA STANDARDOUTPUTLEVEL = "">
							</MvIF><MIVA STANDARDOUTPUTLEVEL = "text, html">
						</tr>

						<mvt:foreach iterator="item" array="subscription:items"><MIVA STANDARDOUTPUTLEVEL = "">
						<MvIF EXPR = "{ l.settings:field_options }"><MIVA STANDARDOUTPUTLEVEL = "text, html">
							<mvt:if expr="l.settings:item:option_count">
								<mvt:assign name="l.settings:rowspan" value="l.settings:item:option_count + 1" />
							<mvt:else>
								<mvt:assign name="l.settings:rowspan" value="1" />
							</mvt:if><MIVA STANDARDOUTPUTLEVEL = "">
						<MvELSE><MIVA STANDARDOUTPUTLEVEL = "text, html">
							<mvt:assign name="l.settings:rowspan" value="1" /><MIVA STANDARDOUTPUTLEVEL = "">
						</MvIF><MIVA STANDARDOUTPUTLEVEL = "text, html">

							<tr class="row_start"><MIVA STANDARDOUTPUTLEVEL = "">

								<MvIF EXPR = "{ NOT ISNULL l.settings:imagetypes[ 1 ] }"><MIVA STANDARDOUTPUTLEVEL = "text, html">
								<td class="item-preview" rowspan="&mvt:rowspan;"><MIVA STANDARDOUTPUTLEVEL = "">
									<MvASSIGN NAME = "l.imagetype"	VALUE = "{ [ g.Module_Feature_TUI_UT ].StripSpecialCharacters_TemplateCode( l.settings:imagetypes[ 1 ] ) }"><MIVA STANDARDOUTPUTLEVEL = "text, html">
									<mvt:if expr="{ 'ISNULL l.settings:item:imagetypes:' $ l.imagetype }">
										&nbsp;
									<mvt:else>
										<div class="item-image"><img src="{ '&mvte:item:imagetypes:' $ l.imagetype $ ';' }" alt="&mvte:item:name;" /></div>
									</mvt:if>
								</td><MIVA STANDARDOUTPUTLEVEL = "">
								</MvIF>

								<MvIF EXPR = "{ l.settings:field_code OR l.settings:field_name OR l.settings:field_options }"><MIVA STANDARDOUTPUTLEVEL = "text, html">
								<td class="item-name"><MIVA STANDARDOUTPUTLEVEL = "">
								<MvIF EXPR = "{ l.settings:field_name AND NOT l.settings:field_code }"><MIVA STANDARDOUTPUTLEVEL = "text, html">
									<a href="&mvte:item:link;">&mvt:item:name;</a><MIVA STANDARDOUTPUTLEVEL = "">
								<MvELSEIF EXPR = "{ l.settings:field_name }"><MIVA STANDARDOUTPUTLEVEL = "text, html">
									&mvt:item:name; -<MIVA STANDARDOUTPUTLEVEL = "">
								</MvIF>

								<MvIF EXPR = "{ l.settings:field_code }"><MIVA STANDARDOUTPUTLEVEL = "text, html">
									<a href="&mvte:item:link;">&mvt:item:code;</a><MIVA STANDARDOUTPUTLEVEL = "">
								</MvIF>

								<MvFOREACH ITERATOR = "l.customfield" ARRAY = "l.settings:fields_custom">
									<MvASSIGN NAME = "l.safe_module_code"	VALUE = "{ [ g.Module_Feature_TUI_UT ].StripSpecialCharacters_TemplateCode( l.customfield:module ) }">
									<MvASSIGN NAME = "l.safe_field_code"	VALUE = "{ [ g.Module_Feature_TUI_UT ].StripSpecialCharacters_TemplateCode( l.customfield:code ) }">

									<MIVA STANDARDOUTPUTLEVEL = "text, html">
									<mvt:if expr="{ 'NOT ISNULL l.settings:item:customfield_values:' $ l.safe_module_code $ ':' $ l.safe_field_code }">
										<div class="custom-field">&mvt:customfield_names:<MvEVAL EXPR = "{ l.safe_module_code }">:<MvEVAL EXPR = "{ l.safe_field_code }">;: &mvt:item:customfield_values:<MvEVAL EXPR = "{ l.safe_module_code }">:<MvEVAL EXPR = "{ l.safe_field_code }">;</div>
									</mvt:if><MIVA STANDARDOUTPUTLEVEL = "">
								</MvFOREACH>

								<MvIF EXPR = "{ l.settings:lineitemdiscounts }"><MIVA STANDARDOUTPUTLEVEL = "text, html">
									<mvt:foreach iterator="discount" array="item:discounts">
										<mvt:if expr="l.settings:discount:display">
											<div class="item-discount">&mvt:discount:descrip;: &mvt:discount:formatted_discount;</div>
										</mvt:if>
									</mvt:foreach><MIVA STANDARDOUTPUTLEVEL = "">
								</MvIF><MIVA STANDARDOUTPUTLEVEL = "text, html">
								</td><MIVA STANDARDOUTPUTLEVEL = "">
								</MvIF>

								<MvIF EXPR = "{ l.settings:field_quantity }"><MIVA STANDARDOUTPUTLEVEL = "text, html">
								<td class="item-quantity" rowspan="&mvt:rowspan;">
									&mvte:subscription:quantity;
								</td><MIVA STANDARDOUTPUTLEVEL = "">
								</MvIF>

								<MvIF EXPR = "{ l.settings:field_price }"><MIVA STANDARDOUTPUTLEVEL = "text, html">
								<td class="item-price">
									<span style="text-decoration: line-through"><MIVA STANDARDOUTPUTLEVEL = "">
									<MvIF EXPR = "{ ( l.settings:additionalprice EQ 'retail' ) AND ( l.settings:price NE 'retail' ) }">
										<MIVA STANDARDOUTPUTLEVEL = "text, html"><mvt:if expr="{ 'l.settings:item:retail GT ' $ l.price_variable }">&mvt:item:formatted_retail;</mvt:if><MIVA STANDARDOUTPUTLEVEL = "">
									<MvELSEIF EXPR = "{ ( l.settings:additionalprice EQ 'base' ) AND ( l.settings:price NE 'base' ) }">
										<MIVA STANDARDOUTPUTLEVEL = "text, html"><mvt:if expr="{ 'l.settings:item:base_price GT ' $ l.price_variable }">&mvt:item:formatted_base_price;</mvt:if><MIVA STANDARDOUTPUTLEVEL = "">
									</MvIF>
									<MIVA STANDARDOUTPUTLEVEL = "text, html"></span>
									<MvEVAL EXPR = "{ l.price_token }">
								</td><MIVA STANDARDOUTPUTLEVEL = "">
								</MvIF>

								<MvIF EXPR = "{ l.settings:field_price OR l.settings:display:shipping OR l.settings:display:handling OR l.settings:display:salestax OR l.settings:display:discounts }"><MIVA STANDARDOUTPUTLEVEL = "text, html">
								<td class="item-total"><MIVA STANDARDOUTPUTLEVEL = "">
									<MvIF EXPR = "{ NOT l.settings:field_price }"><MIVA STANDARDOUTPUTLEVEL = "text, html">
									&nbsp;<MIVA STANDARDOUTPUTLEVEL = "">
									<MvELSE><MIVA STANDARDOUTPUTLEVEL = "text, html">
									<span style="text-decoration: line-through"><MIVA STANDARDOUTPUTLEVEL = "">
									<MvIF EXPR = "{ ( l.settings:additionalprice EQ 'retail' ) AND ( l.settings:price NE 'retail' ) }">
										<MIVA STANDARDOUTPUTLEVEL = "text, html"><mvt:if expr="{ 'l.settings:item:subtotal_retail_comprehensive GT ' $ l.price_subtotal_variable }">&mvt:item:formatted_subtotal_retail_comprehensive;</mvt:if><MIVA STANDARDOUTPUTLEVEL = "">
									<MvELSEIF EXPR = "{ ( l.settings:additionalprice EQ 'base' ) AND ( l.settings:price NE 'base' ) }">
										<MIVA STANDARDOUTPUTLEVEL = "text, html"><mvt:if expr="{ 'l.settings:item:subtotal_base_price_comprehensive GT ' $ l.price_subtotal_variable }">&mvt:item:formatted_subtotal_base_price_comprehensive;</mvt:if><MIVA STANDARDOUTPUTLEVEL = "">
									</MvIF>
									<MIVA STANDARDOUTPUTLEVEL = "text, html"></span>
									<MvEVAL EXPR = "{ l.price_subtotal_token }"><MIVA STANDARDOUTPUTLEVEL = "">
									</MvIF><MIVA STANDARDOUTPUTLEVEL = "text, html">
								</td><MIVA STANDARDOUTPUTLEVEL = "">
								</MvIF><MIVA STANDARDOUTPUTLEVEL = "text, html">
							</tr><MIVA STANDARDOUTPUTLEVEL = "">

							<MvIF EXPR = "{ l.settings:field_options }"><MIVA STANDARDOUTPUTLEVEL = "text, html">
							<mvt:foreach iterator="option" array="item:options">
								<tr class="option_row">
									<td class="item-name">
										<div class="item-option">
											<mvt:if expr="l.settings:option:option_id">
												&mvt:option:attr_code;: &mvt:option:opt_code;
											<mvt:elseif expr="NOT ISNULL l.settings:option:data">
												&mvt:option:attr_code;: &mvt:option:data;
											<mvt:elseif expr="NOT ISNULL l.settings:option:data_long">
												&mvt:option:attr_code;: &mvt:option:data_long;
											<mvt:else>
												&mvt:option:attr_code;
											</mvt:if>
										</div><MIVA STANDARDOUTPUTLEVEL = "">

									<MvIF EXPR = "{ l.settings:lineitemdiscounts }"><MIVA STANDARDOUTPUTLEVEL = "text, html">
										<mvt:foreach iterator="discount" array="option:discounts">
											<mvt:if expr="l.settings:discount:display">
												<div class="option-discount">&mvt:discount:descrip;: &mvt:discount:formatted_discount;</div>
											</mvt:if>
										</mvt:foreach><MIVA STANDARDOUTPUTLEVEL = "">
									</MvIF><MIVA STANDARDOUTPUTLEVEL = "text, html">
									</td><MIVA STANDARDOUTPUTLEVEL = "">

									<MvIF EXPR = "{ l.settings:field_price }"><MIVA STANDARDOUTPUTLEVEL = "text, html">
									<td class="item-price">
										<span style="text-decoration: line-through"><MIVA STANDARDOUTPUTLEVEL = "">
										<MvIF EXPR = "{ ( l.settings:additionalprice EQ 'retail' ) AND ( l.settings:price NE 'retail' ) }">
											<MIVA STANDARDOUTPUTLEVEL = "text, html"><mvt:if expr="{ 'l.settings:option:retail GT ' $ l.price_variable_option }">&mvt:option:formatted_retail;</mvt:if><MIVA STANDARDOUTPUTLEVEL = "">
										<MvELSEIF EXPR = "{ ( l.settings:additionalprice EQ 'base' ) AND ( l.settings:price NE 'base' ) }">
											<MIVA STANDARDOUTPUTLEVEL = "text, html"><mvt:if expr="{ 'l.settings:option:base_price GT ' $ l.price_variable_option }">&mvt:option:formatted_base_price;</mvt:if><MIVA STANDARDOUTPUTLEVEL = "">
										</MvIF>
										<MIVA STANDARDOUTPUTLEVEL = "text, html"></span>

										<mvt:if expr="{ l.price_variable_option }">
											<MvEVAL EXPR = "{ l.price_token_option }">
										<mvt:else>
											&nbsp;
										</mvt:if>
									</td><MIVA STANDARDOUTPUTLEVEL = "">
									</MvIF>

									<MvIF EXPR = "{ l.settings:field_price OR l.settings:display:shipping OR l.settings:display:handling OR l.settings:display:salestax OR l.settings:display:discounts }"><MIVA STANDARDOUTPUTLEVEL = "text, html">
									<td class="item-total">
										&nbsp;
									</td>
									</MvIF><MIVA STANDARDOUTPUTLEVEL = "text, html">
								</tr>
							</mvt:foreach><MIVA STANDARDOUTPUTLEVEL = "">
							</MvIF><MIVA STANDARDOUTPUTLEVEL = "text, html">
						</mvt:foreach><MIVA STANDARDOUTPUTLEVEL = "">

						<MvASSIGN NAME = "l.charges_total_colspan" VALUE = "{ ( l.settings:field_code OR l.settings:field_name OR l.settings:field_options ) + l.settings:field_quantity + l.settings:field_price + ( NOT ISNULL l.settings:imagetypes[ 1 ] ) }">
						<MIVA STANDARDOUTPUTLEVEL = "text, html">

						<mvt:foreach iterator="charge" array="subscription:charges">
							<tr class="row_start">
								<td colspan="{ l.charges_total_colspan }" class="charge-description">&mvt:charge:descrip;:</td>
								<td class="formatted-charge">&mvt:charge:formatted_disp_amt;</td>
							</tr>
						</mvt:foreach><MIVA STANDARDOUTPUTLEVEL = "">

						<MvIF EXPR = "{ l.settings:field_price OR l.settings:display:shipping OR l.settings:display:handling OR l.settings:display:salestax OR l.settings:display:discounts }"><MIVA STANDARDOUTPUTLEVEL = "text, html">

						<tr class="row_start">
							<td colspan="{ l.charges_total_colspan }" class="total-prompt">Estimated Order Total:</td>
							<td class="formatted-total">&mvt:subscription:formatted_display_total;</td>
						</tr><MIVA STANDARDOUTPUTLEVEL = "">
						</MvIF><MIVA STANDARDOUTPUTLEVEL = "text, html">
					</table>
				</span><MIVA STANDARDOUTPUTLEVEL = "">
			</MvIF><MIVA STANDARDOUTPUTLEVEL = "text, html">

				<span class="subscription_entry_content_actions">
					<span class="subscription_entry_content_section_left">
						<a href="&mvte:urls:CSBE:auto_sep;Subscription_ID=&mvta:subscription:id;"><mvt:if expr="l.settings:subscription:status EQ 'C'">View Subscription<mvt:else>Edit Subscription</mvt:if></a>
					</span>

					<mvt:if expr="l.settings:subscription:status NE 'C' AND l.settings:subscription:productsubscriptionsettings:can_cancel AND ( ( l.settings:subscription:productsubscriptionsettings:cncl_min EQ 0 ) OR ( l.settings:subscription:termproc GE l.settings:subscription:productsubscriptionsettings:cncl_min ) )">
						<span class="subscription_entry_content_section_right">
							<a href="#" onclick="if ( confirm( 'Are you sure you want to cancel your subscription? This action cannot be undone.\x0A\x0AContinue?' ) ) { MMDynamic_Form_Submit( '&mvtj:urls:_self:secure;', { 'Action': 'DCSB', 'Subscription_ID': '&mvtj:subscription:id;', 'Offset': '&mvtj:global:Offset;', 'Sort_By': '&mvtj:global:Sort_By;', 'Per_Page': '&mvtj:global:Per_Page;', 'CSRF_Token': '&mvtj:global:basket:csrf_token;' } ); } return false;">Cancel Subscription</a>
						</span>
					</mvt:if>

					<div class="clear"></div>
				</span>
			</span>
		</span>
	</mvt:foreach>

	<mvt:if expr="NOT l.settings:subscriptions:page_disp_count GT 0">
		<mvt:if expr="( g.Offset OR g.NextOffset ) AND ( l.settings:subscriptions:per_page NE 0 )">
			<div class="next-previous">
				<div class="previous-button">
					<mvt:if expr="g.Offset EQ 0">
						&nbsp;
					<mvt:else>
						<form method="post" action="&mvte:urls:_self:auto;" />
							<input type="hidden" name="Sort_By" value="&mvte:global:Sort_By;" />
							<input type="hidden" name="Offset" value="&mvte:global:PrevOffset;" />
							<input type="hidden" name="Per_Page" value="&mvte:global:Per_Page;" />
							<mvt:item name="buttons" param="Previous" />
						</form>
					</mvt:if>
				</div>
				<div class="next-button">
					<mvt:if expr="g.NextOffset EQ 0">
						&nbsp;
					<mvt:else>
						<form method="post" action="&mvte:urls:_self:auto;">
							<input type="hidden" name="Sort_By" value="&mvte:global:Sort_By;" />
							<input type="hidden" name="Offset" value="&mvte:global:NextOffset;" />
							<input type="hidden" name="Per_Page" value="&mvte:global:Per_Page;" />
							<mvt:item name="buttons" param="Next" />
						</form>
					</mvt:if>
				</div>
			</div>
	
			<div class="clear"></div>
		</mvt:if>
	</mvt:if>
</div><MIVA STANDARDOUTPUTLEVEL = "">
	</MvCAPTURE>
</MvFUNCTION>
