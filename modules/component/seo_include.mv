<MIVA STANDARDOUTPUTLEVEL = "">

<MvCOMMENT>
|
| Miva Merchant
|
| This file and the source codes contained herein are the property of
| Miva, Inc.  Use of this file is restricted to the specific terms and
| conditions in the License Agreement associated with this file.  Distribution
| of this file or portions of this file for uses not covered by the License
| Agreement is not allowed without a written agreement signed by an officer of
| Miva, Inc.
|
| Copyright 1998-2019 Miva, Inc.  All rights reserved.
| http://www.miva.com
|
</MvCOMMENT>

<MvFUNCTION NAME = "SEOSettings_Encode_Delimiter" PARAMETERS = "delim" STANDARDOUTPUTLEVEL = "">
	<MvIF EXPR = "{ ( l.delim EQ '/' ) OR 
					( l.delim EQ '.' ) OR
					( l.delim EQ '-' ) OR
					( l.delim EQ '_' ) OR
					( l.delim EQ '~' ) }">
		<MvFUNCTIONRETURN VALUE = "{ l.delim }">
	</MvIF>

	<MvFUNCTIONRETURN VALUE = "{ encodeattribute( l.delim ) }">
</MvFUNCTION>

<MvFUNCTION NAME = "SEOSettings_StoreFront_URL" PARAMETERS = "" STANDARDOUTPUTLEVEL = "">
	<MvIF EXPR = "{ NOT [ g.Module_Library_DB ].SEOSettings_Load( l.seo_settings ) }">
		<MvASSIGN NAME = "l.seo_settings:sf_active" VALUE = "0">
		<MvASSIGN NAME = "l.seo_settings:sl_active" VALUE = "0">
		<MvASSIGN NAME = "l.seo_settings:sm_active" VALUE = "0">
	</MvIF>
	
	<MvFUNCTIONRETURN VALUE = "{ SEOSettings_StoreFront_URL_with( l.seo_settings ) }">
</MvFUNCTION>

<MvFUNCTION NAME = "SEOSettings_StoreFront_URL_with" PARAMETERS = "seo_settings" STANDARDOUTPUTLEVEL = "">
	<MvIF EXPR = "{ l.seo_settings:sf_active }">
		<MvFUNCTIONRETURN VALUE = "{ SEOSettings_URLPrefix_with( l.seo_settings ) }">
	<MvELSEIF EXPR = "{ l.seo_settings:sl_active }">
        <MvASSIGN NAME = "l.store_count"  VALUE = "{ [ g.Module_Library_DB ].Store_Count_Cached() }">
		<MvASSIGN NAME = "l.results"      VALUE = "{ SEOSettings_URLPrefix_with( l.seo_settings ) }">
	
		<MvIF EXPR = "{ l.seo_settings:prefix NE '' }">
			<MvASSIGN NAME = "l.results" VALUE = "{ l.results $ l.seo_settings:prefix $ SEOSettings_Encode_Delimiter( l.seo_settings:url_delim ) }">
		</MvIF>

		<MvIF EXPR = "{ l.store_count GT 0 AND ( l.store_count GT 1 OR l.seo_settings:sc_always ) }">
			<MvASSIGN NAME = "l.results" VALUE = "{ l.results $ encodeattribute( g.Store_Code ) $ SEOSettings_Encode_Delimiter( l.seo_settings:url_delim ) }">
		</MvIF>

		<MvASSIGN NAME = "l.results" VALUE = "{ l.results $ 'SFNT' }">

		<MvIF EXPR = "{ l.seo_settings:suffix NE '' }">
			<MvASSIGN NAME = "l.results" VALUE = "{ l.results $ '.' $ l.seo_settings:suffix }">
		</MvIF>

		<MvFUNCTIONRETURN VALUE = "{ l.results }">
	<MvELSE>
		<MvFUNCTIONRETURN VALUE = "{ g.sessionurl $ 'Store_Code=' $ encodeattribute( g.Store_Code ) $ '&Screen=SFNT' }">
	</MvIF>
</MvFUNCTION>

<MvFUNCTION NAME = "SEOSettings_Product_URL" PARAMETERS = "product_code" STANDARDOUTPUTLEVEL = "">
	<MvIF EXPR = "{ NOT [ g.Module_Library_DB ].SEOSettings_Load( l.seo_settings ) }">
		<MvASSIGN NAME = "l.seo_settings:sf_active" VALUE = "0">
		<MvASSIGN NAME = "l.seo_settings:sl_active" VALUE = "0">
		<MvASSIGN NAME = "l.seo_settings:sm_active" VALUE = "0">
	</MvIF>
	
	<MvFUNCTIONRETURN VALUE = "{ SEOSettings_Product_URL_with( l.seo_settings, l.product_code ) }">
</MvFUNCTION>

<MvFUNCTION NAME = "SEOSettings_Product_SecureURL" PARAMETERS = "product_code" STANDARDOUTPUTLEVEL = "">
	<MvIF EXPR = "{ NOT [ g.Module_Library_DB ].SEOSettings_Load( l.seo_settings ) }">
		<MvASSIGN NAME = "l.seo_settings:sf_active" VALUE = "0">
		<MvASSIGN NAME = "l.seo_settings:sl_active" VALUE = "0">
		<MvASSIGN NAME = "l.seo_settings:sm_active" VALUE = "0">
	</MvIF>
	
	<MvFUNCTIONRETURN VALUE = "{ SEOSettings_Product_SecureURL_with( l.seo_settings, l.product_code ) }">
</MvFUNCTION>

<MvFUNCTION NAME = "SEOSettings_Product_URL_with" PARAMETERS = "seo_settings, product_code" STANDARDOUTPUTLEVEL = "">
    <MvASSIGN NAME = "l.store_count" VALUE = "{ [ g.Module_Library_DB ].Store_Count_Cached() }">

	<MvIF EXPR = "{ NOT l.seo_settings:sl_active OR l.seo_settings:url_delim EQ '' }">
		<MvIF EXPR = "{ l.store_count GT 0 }">
			<MvFUNCTIONRETURN VALUE = "{ g.sessionurl $ 'Store_Code=' $ encodeattribute( g.Store_Code ) $ '&Screen=PROD&Product_Code=' $ encodeattribute( l.product_code ) }">
		<MvELSE>
			<MvFUNCTIONRETURN VALUE = "{ g.sessionurl $ 'Screen=PROD&Product_Code=' $ encodeattribute( l.product_code ) }">
		</MvIF>
	<MvELSE>
		<MvASSIGN NAME = "l.results" VALUE = "{ SEOSettings_URLPrefix_with( l.seo_settings ) }">
		
		<MvIF EXPR = "{ l.seo_settings:prefix NE '' }">
			<MvASSIGN NAME = "l.results" VALUE = "{ l.results $ l.seo_settings:prefix $ SEOSettings_Encode_Delimiter( l.seo_settings:url_delim ) }">
		</MvIF>
		
		<MvIF EXPR = "{ l.store_count GT 0 AND ( l.store_count GT 1 OR l.seo_settings:sc_always ) }">
			<MvASSIGN NAME = "l.results" VALUE = "{ l.results $ encodeattribute( g.Store_Code ) $ SEOSettings_Encode_Delimiter( l.seo_settings:url_delim ) }">
		</MvIF>

		<MvIF EXPR = "{ l.seo_settings:prod_lit NE '' }">
			<MvASSIGN NAME = "l.results" VALUE = "{ l.results $ l.seo_settings:prod_lit $ SEOSettings_Encode_Delimiter( l.seo_settings:url_delim ) }">
		</MvIF>

		<MvASSIGN NAME = "l.results" VALUE = "{ l.results $ encodeattribute( l.product_code ) }">
		
		<MvIF EXPR = "{ l.seo_settings:suffix NE '' }">
			<MvASSIGN NAME = "l.results" VALUE = "{ l.results $ '.' $ l.seo_settings:suffix }">
		</MvIF>
		
		<MvFUNCTIONRETURN VALUE = "{ l.results }">
	</MvIF>
</MvFUNCTION>

<MvFUNCTION NAME = "SEOSettings_Product_SecureURL_with" PARAMETERS = "seo_settings, product_code" STANDARDOUTPUTLEVEL = "">
    <MvASSIGN NAME = "l.store_count" VALUE = "{ [ g.Module_Library_DB ].Store_Count_Cached() }">

	<MvIF EXPR = "{ NOT l.seo_settings:sl_active OR l.seo_settings:url_delim EQ '' }">
		<MvIF EXPR = "{ l.store_count GT 0 }">
			<MvFUNCTIONRETURN VALUE = "{ g.secure_sessionurl $ 'Store_Code=' $ encodeattribute( g.Store_Code ) $ '&Screen=PROD&Product_Code=' $ encodeattribute( l.product_code ) }">
		<MvELSE>
			<MvFUNCTIONRETURN VALUE = "{ g.secure_sessionurl $ 'Screen=PROD&Product_Code=' $ encodeattribute( l.product_code ) }">
		</MvIF>
	<MvELSE>
		<MvASSIGN NAME = "l.results" VALUE = "{ SEOSettings_SecureURLPrefix_with( l.seo_settings ) }">
		
		<MvIF EXPR = "{ l.seo_settings:prefix NE '' }">
			<MvASSIGN NAME = "l.results" VALUE = "{ l.results $ l.seo_settings:prefix $ SEOSettings_Encode_Delimiter( l.seo_settings:url_delim ) }">
		</MvIF>
		
		<MvIF EXPR = "{ l.store_count GT 0 AND ( l.store_count GT 1 OR l.seo_settings:sc_always ) }">
			<MvASSIGN NAME = "l.results" VALUE = "{ l.results $ encodeattribute( g.Store_Code ) $ SEOSettings_Encode_Delimiter( l.seo_settings:url_delim ) }">
		</MvIF>

		<MvIF EXPR = "{ l.seo_settings:prod_lit NE '' }">
			<MvASSIGN NAME = "l.results" VALUE = "{ l.results $ l.seo_settings:prod_lit $ SEOSettings_Encode_Delimiter( l.seo_settings:url_delim ) }">
		</MvIF>

		<MvASSIGN NAME = "l.results" VALUE = "{ l.results $ encodeattribute( l.product_code ) }">
		
		<MvIF EXPR = "{ l.seo_settings:suffix NE '' }">
			<MvASSIGN NAME = "l.results" VALUE = "{ l.results $ '.' $ l.seo_settings:suffix }">
		</MvIF>
		
		<MvFUNCTIONRETURN VALUE = "{ l.results }">
	</MvIF>
</MvFUNCTION>

<MvFUNCTION NAME = "SEOSettings_Category_URL" PARAMETERS = "category_code" STANDARDOUTPUTLEVEL = "">
    <MvIF EXPR = "{ NOT [ g.Module_Library_DB ].SEOSettings_Load( l.seo_settings ) }">
        <MvASSIGN NAME = "l.seo_settings:sf_active" VALUE = "0">
        <MvASSIGN NAME = "l.seo_settings:sl_active" VALUE = "0">
        <MvASSIGN NAME = "l.seo_settings:sm_active" VALUE = "0">
    </MvIF>

    <MvFUNCTIONRETURN VALUE = "{ SEOSettings_Category_URL_with( l.seo_settings, l.category_code ) }">
</MvFUNCTION>

<MvFUNCTION NAME = "SEOSettings_Category_SecureURL" PARAMETERS = "category_code" STANDARDOUTPUTLEVEL = "">
    <MvIF EXPR = "{ NOT [ g.Module_Library_DB ].SEOSettings_Load( l.seo_settings ) }">
        <MvASSIGN NAME = "l.seo_settings:sf_active" VALUE = "0">
        <MvASSIGN NAME = "l.seo_settings:sl_active" VALUE = "0">
        <MvASSIGN NAME = "l.seo_settings:sm_active" VALUE = "0">
    </MvIF>

    <MvFUNCTIONRETURN VALUE = "{ SEOSettings_Category_SecureURL_with( l.seo_settings, l.category_code ) }">
</MvFUNCTION>

<MvFUNCTION NAME = "SEOSettings_Category_URL_with" PARAMETERS = "seo_settings, category_code" STANDARDOUTPUTLEVEL = "">
    <MvASSIGN NAME = "l.store_count" VALUE = "{ [ g.Module_Library_DB ].Store_Count_Cached() }">

    <MvIF EXPR = "{ NOT l.seo_settings:sl_active OR l.seo_settings:url_delim EQ '' }">
        <MvIF EXPR = "{ l.store_count GT 0 }">
            <MvFUNCTIONRETURN VALUE = "{ g.sessionurl $ 'Store_Code=' $ encodeattribute( g.Store_Code ) $ '&Screen=CTGY&Category_Code=' $ encodeattribute( l.category_code ) }">
        <MvELSE>
            <MvFUNCTIONRETURN VALUE = "{ g.sessionurl $ 'Screen=CTGY&Category_Code=' $ encodeattribute( l.category_code ) }">
        </MvIF>
    <MvELSE>
        <MvASSIGN NAME = "l.results" VALUE = "{ SEOSettings_URLPrefix_with( l.seo_settings ) }">

        <MvIF EXPR = "{ l.seo_settings:prefix NE '' }">
            <MvASSIGN NAME = "l.results" VALUE = "{ l.results $ l.seo_settings:prefix $ SEOSettings_Encode_Delimiter( l.seo_settings:url_delim ) }">
        </MvIF>

        <MvIF EXPR = "{ l.store_count GT 0 AND ( l.store_count GT 1 OR l.seo_settings:sc_always ) }">
            <MvASSIGN NAME = "l.results" VALUE = "{ l.results $ encodeattribute( g.Store_Code ) $ SEOSettings_Encode_Delimiter( l.seo_settings:url_delim ) }">
        </MvIF>

        <MvIF EXPR = "{ l.seo_settings:cat_lit NE '' }">
            <MvASSIGN NAME = "l.results" VALUE = "{ l.results $ l.seo_settings:cat_lit $ SEOSettings_Encode_Delimiter( l.seo_settings:url_delim ) }">
        </MvIF>

        <MvASSIGN NAME = "l.results" VALUE = "{ l.results $ encodeattribute( l.category_code ) }">

        <MvIF EXPR = "{ l.seo_settings:suffix NE '' }">
            <MvASSIGN NAME = "l.results" VALUE = "{ l.results $ '.' $ l.seo_settings:suffix }">
        </MvIF>

        <MvFUNCTIONRETURN VALUE = "{ l.results }">
    </MvIF>
</MvFUNCTION>

<MvFUNCTION NAME = "SEOSettings_Category_SecureURL_with" PARAMETERS = "seo_settings, category_code" STANDARDOUTPUTLEVEL = "">
    <MvASSIGN NAME = "l.store_count" VALUE = "{ [ g.Module_Library_DB ].Store_Count_Cached() }">

    <MvIF EXPR = "{ NOT l.seo_settings:sl_active OR l.seo_settings:url_delim EQ '' }">
        <MvIF EXPR = "{ l.store_count GT 0 }">
            <MvFUNCTIONRETURN VALUE = "{ g.secure_sessionurl $ 'Store_Code=' $ encodeattribute( g.Store_Code ) $ '&Screen=CTGY&Category_Code=' $ encodeattribute( l.category_code ) }">
        <MvELSE>
            <MvFUNCTIONRETURN VALUE = "{ g.secure_sessionurl $ 'Screen=CTGY&Category_Code=' $ encodeattribute( l.category_code ) }">
        </MvIF>
    <MvELSE>
        <MvASSIGN NAME = "l.results" VALUE = "{ SEOSettings_SecureURLPrefix_with( l.seo_settings ) }">

        <MvIF EXPR = "{ l.seo_settings:prefix NE '' }">
            <MvASSIGN NAME = "l.results" VALUE = "{ l.results $ l.seo_settings:prefix $ SEOSettings_Encode_Delimiter( l.seo_settings:url_delim ) }">
        </MvIF>

        <MvIF EXPR = "{ l.store_count GT 0 AND ( l.store_count GT 1 OR l.seo_settings:sc_always ) }">
            <MvASSIGN NAME = "l.results" VALUE = "{ l.results $ encodeattribute( g.Store_Code ) $ SEOSettings_Encode_Delimiter( l.seo_settings:url_delim ) }">
        </MvIF>

        <MvIF EXPR = "{ l.seo_settings:cat_lit NE '' }">
            <MvASSIGN NAME = "l.results" VALUE = "{ l.results $ l.seo_settings:cat_lit $ SEOSettings_Encode_Delimiter( l.seo_settings:url_delim ) }">
        </MvIF>

        <MvASSIGN NAME = "l.results" VALUE = "{ l.results $ encodeattribute( l.category_code ) }">

        <MvIF EXPR = "{ l.seo_settings:suffix NE '' }">
            <MvASSIGN NAME = "l.results" VALUE = "{ l.results $ '.' $ l.seo_settings:suffix }">
        </MvIF>

        <MvFUNCTIONRETURN VALUE = "{ l.results }">
    </MvIF>
</MvFUNCTION>

<MvFUNCTION NAME = "SEOSettings_Breadcrumb_URL" PARAMETERS = "seo_settings, category_code, product_code" STANDARDOUTPUTLEVEL = "">
    <MvIF EXPR = "{ NOT [ g.Module_Library_DB ].SEOSettings_Load( l.seo_settings ) }">
        <MvASSIGN NAME = "l.seo_settings:sf_active" VALUE = "0">
        <MvASSIGN NAME = "l.seo_settings:sl_active" VALUE = "0">
        <MvASSIGN NAME = "l.seo_settings:sm_active" VALUE = "0">
    </MvIF>

    <MvFUNCTIONRETURN VALUE = "{ SEOSettings_Breadcrumb_URL_with( l.seo_settings, l.category_code, l.product_code ) }">
</MvFUNCTION>

<MvFUNCTION NAME = "SEOSettings_Breadcrumb_SecureURL" PARAMETERS = "seo_settings, category_code, product_code" STANDARDOUTPUTLEVEL = "">
    <MvIF EXPR = "{ NOT [ g.Module_Library_DB ].SEOSettings_Load( l.seo_settings ) }">
        <MvASSIGN NAME = "l.seo_settings:sf_active" VALUE = "0">
        <MvASSIGN NAME = "l.seo_settings:sl_active" VALUE = "0">
        <MvASSIGN NAME = "l.seo_settings:sm_active" VALUE = "0">
    </MvIF>

    <MvFUNCTIONRETURN VALUE = "{ SEOSettings_Breadcrumb_SecureURL_with( l.seo_settings, l.category_code, l.product_code ) }">
</MvFUNCTION>

<MvFUNCTION NAME = "SEOSettings_Breadcrumb_URL_with" PARAMETERS = "seo_settings, category_code, product_code" STANDARDOUTPUTLEVEL = "">
	<MvASSIGN NAME = "l.store_count" VALUE = "{ [ g.Module_Library_DB ].Store_Count_Cached() }">

	<MvIF EXPR = "{ NOT l.seo_settings:sl_active OR l.seo_settings:url_delim EQ '' }">
        <MvIF EXPR = "{ l.store_count GT 0 }">
            <MvFUNCTIONRETURN VALUE = "{ g.sessionurl $ 'Store_Code=' $ encodeattribute( g.Store_Code ) $ '&Screen=PROD&Category_Code=' $ encodeattribute( l.category_code ) $ '&Product_Code=' $ encodeattribute( l.product_code ) }">
        <MvELSE>
            <MvFUNCTIONRETURN VALUE = "{ g.sessionurl $ 'Screen=PROD&Category_Code=' $ encodeattribute( l.category_code ) $ '&Product_Code=' $ encodeattribute( l.product_code ) }">
        </MvIF>
    <MvELSE>
        <MvASSIGN NAME = "l.results" VALUE = "{ SEOSettings_URLPrefix_with( l.seo_settings ) }">

        <MvIF EXPR = "{ l.seo_settings:prefix NE '' }">
            <MvASSIGN NAME = "l.results" VALUE = "{ l.results $ l.seo_settings:prefix $ SEOSettings_Encode_Delimiter( l.seo_settings:url_delim ) }">
        </MvIF>

        <MvIF EXPR = "{ l.store_count GT 0 AND ( l.store_count GT 1 OR l.seo_settings:sc_always ) }">
            <MvASSIGN NAME = "l.results" VALUE = "{ l.results $ encodeattribute( g.Store_Code ) $ SEOSettings_Encode_Delimiter( l.seo_settings:url_delim ) }">
        </MvIF>

        <MvIF EXPR = "{ l.seo_settings:plit_in_bc AND l.seo_settings:prod_lit NE '' }">
            <MvASSIGN NAME = "l.results" VALUE = "{ l.results $ l.seo_settings:prod_lit $ SEOSettings_Encode_Delimiter( l.seo_settings:url_delim ) }">
        </MvIF>

        <MvASSIGN NAME = "l.results" VALUE = "{ l.results $ encodeattribute( l.category_code ) $ SEOSettings_Encode_Delimiter( l.seo_settings:url_delim ) }">
        <MvASSIGN NAME = "l.results" VALUE = "{ l.results $ encodeattribute( l.product_code ) }">

        <MvIF EXPR = "{ l.seo_settings:suffix NE '' }">
            <MvASSIGN NAME = "l.results" VALUE = "{ l.results $ '.' $ l.seo_settings:suffix }">
        </MvIF>

        <MvFUNCTIONRETURN VALUE = "{ l.results }">
    </MvIF>
</MvFUNCTION>

<MvFUNCTION NAME = "SEOSettings_Breadcrumb_SecureURL_with" PARAMETERS = "seo_settings, category_code, product_code" STANDARDOUTPUTLEVEL = "">
	<MvASSIGN NAME = "l.store_count" VALUE = "{ [ g.Module_Library_DB ].Store_Count_Cached() }">

	<MvIF EXPR = "{ NOT l.seo_settings:sl_active OR l.seo_settings:url_delim EQ '' }">
        <MvIF EXPR = "{ l.store_count GT 0 }">
            <MvFUNCTIONRETURN VALUE = "{ g.secure_sessionurl $ 'Store_Code=' $ encodeattribute( g.Store_Code ) $ '&Screen=PROD&Category_Code=' $ encodeattribute( l.category_code ) $ '&Product_Code=' $ encodeattribute( l.product_code ) }">
        <MvELSE>
            <MvFUNCTIONRETURN VALUE = "{ g.secure_sessionurl $ 'Screen=PROD&Category_Code=' $ encodeattribute( l.category_code ) $ '&Product_Code=' $ encodeattribute( l.product_code ) }">
        </MvIF>
    <MvELSE>
        <MvASSIGN NAME = "l.results" VALUE = "{ SEOSettings_SecureURLPrefix_with( l.seo_settings ) }">

        <MvIF EXPR = "{ l.seo_settings:prefix NE '' }">
            <MvASSIGN NAME = "l.results" VALUE = "{ l.results $ l.seo_settings:prefix $ SEOSettings_Encode_Delimiter( l.seo_settings:url_delim ) }">
        </MvIF>

        <MvIF EXPR = "{ l.store_count GT 0 AND ( l.store_count GT 1 OR l.seo_settings:sc_always ) }">
            <MvASSIGN NAME = "l.results" VALUE = "{ l.results $ encodeattribute( g.Store_Code ) $ SEOSettings_Encode_Delimiter( l.seo_settings:url_delim ) }">
        </MvIF>

        <MvIF EXPR = "{ l.seo_settings:plit_in_bc AND l.seo_settings:prod_lit NE '' }">
            <MvASSIGN NAME = "l.results" VALUE = "{ l.results $ l.seo_settings:prod_lit $ SEOSettings_Encode_Delimiter( l.seo_settings:url_delim ) }">
        </MvIF>

        <MvASSIGN NAME = "l.results" VALUE = "{ l.results $ encodeattribute( l.category_code ) $ SEOSettings_Encode_Delimiter( l.seo_settings:url_delim ) }">
        <MvASSIGN NAME = "l.results" VALUE = "{ l.results $ encodeattribute( l.product_code ) }">

        <MvIF EXPR = "{ l.seo_settings:suffix NE '' }">
            <MvASSIGN NAME = "l.results" VALUE = "{ l.results $ '.' $ l.seo_settings:suffix }">
        </MvIF>

        <MvFUNCTIONRETURN VALUE = "{ l.results }">
    </MvIF>
</MvFUNCTION>

<MvFUNCTION NAME = "SEOSettings_Screen_URL" PARAMETERS = "screen_code" STANDARDOUTPUTLEVEL = "">
    <MvIF EXPR = "{ NOT [ g.Module_Library_DB ].SEOSettings_Load( l.seo_settings ) }">
        <MvASSIGN NAME = "l.seo_settings:sf_active" VALUE = "0">
        <MvASSIGN NAME = "l.seo_settings:sl_active" VALUE = "0">
        <MvASSIGN NAME = "l.seo_settings:sm_active" VALUE = "0">
    </MvIF>

    <MvFUNCTIONRETURN VALUE = "{ SEOSettings_Screen_URL_with( l.seo_settings, l.screen_code ) }">
</MvFUNCTION>

<MvFUNCTION NAME = "SEOSettings_Screen_URL_with" PARAMETERS = "seo_settings, screen_code" STANDARDOUTPUTLEVEL = "">
	<MvASSIGN NAME = "l.store_count" VALUE = "{ [ g.Module_Library_DB ].Store_Count_Cached() }">

	<MvIF EXPR = "{ NOT l.seo_settings:sl_active OR l.seo_settings:url_delim EQ '' }">
        <MvIF EXPR = "{ l.store_count GT 0 }">
            <MvFUNCTIONRETURN VALUE = "{ g.sessionurl $ 'Store_Code=' $ encodeattribute( g.Store_Code ) $ '&Screen=' $ encodeattribute( l.screen_code ) }">
        <MvELSE>
            <MvFUNCTIONRETURN VALUE = "{ g.sessionurl $ 'Screen=' $ encodeattribute( l.screen_code ) }">
        </MvIF>
    <MvELSE>
        <MvASSIGN NAME = "l.results" VALUE = "{ SEOSettings_URLPrefix_with( l.seo_settings ) }">

        <MvIF EXPR = "{ l.seo_settings:prefix NE '' }">
            <MvASSIGN NAME = "l.results" VALUE = "{ l.results $ l.seo_settings:prefix $ SEOSettings_Encode_Delimiter( l.seo_settings:url_delim ) }">
        </MvIF>

        <MvIF EXPR = "{ l.store_count GT 0 AND ( l.store_count GT 1 OR l.seo_settings:sc_always ) }">
            <MvASSIGN NAME = "l.results" VALUE = "{ l.results $ encodeattribute( g.Store_Code ) $ SEOSettings_Encode_Delimiter( l.seo_settings:url_delim ) }">
        </MvIF>

        <MvASSIGN NAME = "l.results" VALUE = "{ l.results $ encodeattribute( l.screen_code ) }">

        <MvIF EXPR = "{ l.seo_settings:suffix NE '' }">
            <MvASSIGN NAME = "l.results" VALUE = "{ l.results $ '.' $ l.seo_settings:suffix }">
        </MvIF>

        <MvFUNCTIONRETURN VALUE = "{ l.results }">
    </MvIF>
</MvFUNCTION>

<MvFUNCTION NAME = "SEOSettings_CustomerLogin_URL" PARAMETERS = "" STANDARDOUTPUTLEVEL = "">
    <MvIF EXPR = "{ NOT [ g.Module_Library_DB ].SEOSettings_Load( l.seo_settings ) }">
        <MvASSIGN NAME = "l.seo_settings:sf_active" VALUE = "0">
        <MvASSIGN NAME = "l.seo_settings:sl_active" VALUE = "0">
        <MvASSIGN NAME = "l.seo_settings:sm_active" VALUE = "0">
    </MvIF>

    <MvFUNCTIONRETURN VALUE = "{ SEOSettings_CustomerLogin_URL_with( l.seo_settings ) }">
</MvFUNCTION>

<MvFUNCTION NAME = "SEOSettings_CustomerLogin_URL_with" PARAMETERS = "seo_settings" STANDARDOUTPUTLEVEL = "">
	<MvASSIGN NAME = "l.store_count" VALUE = "{ [ g.Module_Library_DB ].Store_Count_Cached() }">

	<MvIF EXPR = "{ NOT l.seo_settings:sl_active OR l.seo_settings:url_delim EQ '' }">
		<MvIF EXPR = "{ l.store_count GT 0 }">
            <MvFUNCTIONRETURN VALUE = "{ g.secure_sessionurl $ 'Store_Code=' $ encodeattribute( g.Store_Code ) $ '&Screen=' $ 'LOGN' }">
        <MvELSE>
            <MvFUNCTIONRETURN VALUE = "{ g.secure_sessionurl $ 'Screen=' $ 'LOGN' }">
        </MvIF>
    <MvELSE>
		<MvASSIGN NAME = "l.results" VALUE = "{ SEOSettings_SecureURLPrefix_with( l.seo_settings ) }">

        <MvIF EXPR = "{ l.seo_settings:prefix NE '' }">
            <MvASSIGN NAME = "l.results" VALUE = "{ l.results $ l.seo_settings:prefix $ SEOSettings_Encode_Delimiter( l.seo_settings:url_delim ) }">
        </MvIF>

        <MvIF EXPR = "{ l.store_count GT 0 AND ( l.store_count GT 1 OR l.seo_settings:sc_always ) }">
            <MvASSIGN NAME = "l.results" VALUE = "{ l.results $ encodeattribute( g.Store_Code ) $ SEOSettings_Encode_Delimiter( l.seo_settings:url_delim ) }">
        </MvIF>

        <MvASSIGN NAME = "l.results" VALUE = "{ l.results $ 'LOGN' }">

        <MvIF EXPR = "{ l.seo_settings:suffix NE '' }">
            <MvASSIGN NAME = "l.results" VALUE = "{ l.results $ '.' $ l.seo_settings:suffix }">
        </MvIF>

        <MvFUNCTIONRETURN VALUE = "{ l.results }">
    </MvIF>
</MvFUNCTION>

<MvFUNCTION NAME = "SEOSettings_CustomAccount_URL" PARAMETERS = "" STANDARDOUTPUTLEVEL = "">
    <MvIF EXPR = "{ NOT [ g.Module_Library_DB ].SEOSettings_Load( l.seo_settings ) }">
        <MvASSIGN NAME = "l.seo_settings:sf_active" VALUE = "0">
        <MvASSIGN NAME = "l.seo_settings:sl_active" VALUE = "0">
        <MvASSIGN NAME = "l.seo_settings:sm_active" VALUE = "0">
    </MvIF>

    <MvFUNCTIONRETURN VALUE = "{ SEOSettings_CustomerAccount_URL_with( l.seo_settings ) }">
</MvFUNCTION>

<MvFUNCTION NAME = "SEOSettings_CustomerAccount_URL_with" PARAMETERS = "seo_settings" STANDARDOUTPUTLEVEL = "">
    <MvASSIGN NAME = "l.store_count" VALUE = "{ [ g.Module_Library_DB ].Store_Count_Cached() }">

    <MvIF EXPR = "{ NOT l.seo_settings:sl_active OR l.seo_settings:url_delim EQ '' }">
        <MvIF EXPR = "{ l.store_count GT 0 }">
            <MvFUNCTIONRETURN VALUE = "{ g.secure_sessionurl $ 'Store_Code=' $ encodeattribute( g.Store_Code ) $ '&Screen=' $ 'ACLN' }">
        <MvELSE>
            <MvFUNCTIONRETURN VALUE = "{ g.secure_sessionurl $ 'Screen=' $ 'ACLN' }">
        </MvIF>
    <MvELSE>
        <MvASSIGN NAME = "l.results" VALUE = "{ SEOSettings_SecureURLPrefix_with( l.seo_settings ) }">

        <MvIF EXPR = "{ l.seo_settings:prefix NE '' }">
            <MvASSIGN NAME = "l.results" VALUE = "{ l.results $ l.seo_settings:prefix $ SEOSettings_Encode_Delimiter( l.seo_settings:url_delim ) }">
        </MvIF>

        <MvIF EXPR = "{ l.store_count GT 0 AND ( l.store_count GT 1 OR l.seo_settings:sc_always ) }">
            <MvASSIGN NAME = "l.results" VALUE = "{ l.results $ encodeattribute( g.Store_Code ) $ SEOSettings_Encode_Delimiter( l.seo_settings:url_delim ) }">
        </MvIF>

        <MvASSIGN NAME = "l.results" VALUE = "{ l.results $ 'ACLN' }">

        <MvIF EXPR = "{ l.seo_settings:suffix NE '' }">
            <MvASSIGN NAME = "l.results" VALUE = "{ l.results $ '.' $ l.seo_settings:suffix }">
        </MvIF>

        <MvFUNCTIONRETURN VALUE = "{ l.results }">
    </MvIF>
</MvFUNCTION>

<MvFUNCTION NAME = "SEOSettings_CustomerWishLists_URL_with" PARAMETERS = "seo_settings" STANDARDOUTPUTLEVEL = "">
	<MvASSIGN NAME = "l.store_count" VALUE = "{ [ g.Module_Library_DB ].Store_Count_Cached() }">

	<MvIF EXPR = "{ NOT l.seo_settings:sl_active OR l.seo_settings:url_delim EQ '' }">
		<MvIF EXPR = "{ l.store_count GT 0 }">
            <MvFUNCTIONRETURN VALUE = "{ g.secure_sessionurl $ 'Store_Code=' $ encodeattribute( g.Store_Code ) $ '&Screen=' $ 'WLST' }">
        <MvELSE>
            <MvFUNCTIONRETURN VALUE = "{ g.secure_sessionurl $ 'Screen=' $ 'WLST' }">
        </MvIF>
    <MvELSE>
		<MvASSIGN NAME = "l.results" VALUE = "{ SEOSettings_SecureURLPrefix_with( l.seo_settings ) }">

        <MvIF EXPR = "{ l.seo_settings:prefix NE '' }">
            <MvASSIGN NAME = "l.results" VALUE = "{ l.results $ l.seo_settings:prefix $ SEOSettings_Encode_Delimiter( l.seo_settings:url_delim ) }">
        </MvIF>

        <MvIF EXPR = "{ l.store_count GT 0 AND ( l.store_count GT 1 OR l.seo_settings:sc_always ) }">
            <MvASSIGN NAME = "l.results" VALUE = "{ l.results $ encodeattribute( g.Store_Code ) $ SEOSettings_Encode_Delimiter( l.seo_settings:url_delim ) }">
        </MvIF>

        <MvASSIGN NAME = "l.results" VALUE = "{ l.results $ 'WLST' }">

        <MvIF EXPR = "{ l.seo_settings:suffix NE '' }">
            <MvASSIGN NAME = "l.results" VALUE = "{ l.results $ '.' $ l.seo_settings:suffix }">
        </MvIF>

        <MvFUNCTIONRETURN VALUE = "{ l.results }">
    </MvIF>
</MvFUNCTION>

<MvFUNCTION NAME = "SEOSettings_AffiliateLogin_URL" PARAMETERS = "" STANDARDOUTPUTLEVEL = "">
    <MvIF EXPR = "{ NOT [ g.Module_Library_DB ].SEOSettings_Load( l.seo_settings ) }">
        <MvASSIGN NAME = "l.seo_settings:sf_active" VALUE = "0">
        <MvASSIGN NAME = "l.seo_settings:sl_active" VALUE = "0">
        <MvASSIGN NAME = "l.seo_settings:sm_active" VALUE = "0">
    </MvIF>

    <MvFUNCTIONRETURN VALUE = "{ SEOSettings_AffiliateLogin_URL_with( l.seo_settings ) }">
</MvFUNCTION>

<MvFUNCTION NAME = "SEOSettings_AffiliateLogin_URL_with" PARAMETERS = "seo_settings" STANDARDOUTPUTLEVEL = "">
	<MvASSIGN NAME = "l.store_count" VALUE = "{ [ g.Module_Library_DB ].Store_Count_Cached() }">

	<MvIF EXPR = "{ NOT l.seo_settings:sl_active OR l.seo_settings:url_delim EQ '' }">
		<MvIF EXPR = "{ l.store_count GT 0 }">
            <MvFUNCTIONRETURN VALUE = "{ g.secure_sessionurl $ 'Store_Code=' $ encodeattribute( g.Store_Code ) $ '&Screen=' $ 'AFCL' }">
        <MvELSE>
            <MvFUNCTIONRETURN VALUE = "{ g.secure_sessionurl $ 'Screen=' $ 'AFCL' }">
        </MvIF>
    <MvELSE>
		<MvASSIGN NAME = "l.results" VALUE = "{ SEOSettings_SecureURLPrefix_with( l.seo_settings ) }">

        <MvIF EXPR = "{ l.seo_settings:prefix NE '' }">
            <MvASSIGN NAME = "l.results" VALUE = "{ l.results $ l.seo_settings:prefix $ SEOSettings_Encode_Delimiter( l.seo_settings:url_delim ) }">
        </MvIF>

        <MvIF EXPR = "{ l.store_count GT 0 AND ( l.store_count GT 1 OR l.seo_settings:sc_always ) }">
            <MvASSIGN NAME = "l.results" VALUE = "{ l.results $ encodeattribute( g.Store_Code ) $ SEOSettings_Encode_Delimiter( l.seo_settings:url_delim ) }">
        </MvIF>

        <MvASSIGN NAME = "l.results" VALUE = "{ l.results $ 'AFCL' }">

        <MvIF EXPR = "{ l.seo_settings:suffix NE '' }">
            <MvASSIGN NAME = "l.results" VALUE = "{ l.results $ '.' $ l.seo_settings:suffix }">
        </MvIF>

        <MvFUNCTIONRETURN VALUE = "{ l.results }">
    </MvIF>
</MvFUNCTION>

<MvFUNCTION NAME = "SEOSettings_AffiliateAccount_URL" PARAMETERS = "" STANDARDOUTPUTLEVEL = "">
    <MvIF EXPR = "{ NOT [ g.Module_Library_DB ].SEOSettings_Load( l.seo_settings ) }">
        <MvASSIGN NAME = "l.seo_settings:sf_active" VALUE = "0">
        <MvASSIGN NAME = "l.seo_settings:sl_active" VALUE = "0">
        <MvASSIGN NAME = "l.seo_settings:sm_active" VALUE = "0">
    </MvIF>

    <MvFUNCTIONRETURN VALUE = "{ SEOSettings_CustomerAccount_URL_with( l.seo_settings ) }">
</MvFUNCTION>

<MvFUNCTION NAME = "SEOSettings_AffiliateAccount_URL_with" PARAMETERS = "seo_settings" STANDARDOUTPUTLEVEL = "">
	<MvASSIGN NAME = "l.store_count" VALUE = "{ [ g.Module_Library_DB ].Store_Count_Cached() }">

	<MvIF EXPR = "{ NOT l.seo_settings:sl_active OR l.seo_settings:url_delim EQ '' }">
		<MvIF EXPR = "{ l.store_count GT 0 }">
            <MvFUNCTIONRETURN VALUE = "{ g.secure_sessionurl $ 'Store_Code=' $ encodeattribute( g.Store_Code ) $ '&Screen=' $ 'AFED' }">
        <MvELSE>
            <MvFUNCTIONRETURN VALUE = "{ g.secure_sessionurl $ 'Screen=' $ 'AFED' }">
        </MvIF>
    <MvELSE>
		<MvASSIGN NAME = "l.results" VALUE = "{ SEOSettings_SecureURLPrefix_with( l.seo_settings ) }">

        <MvIF EXPR = "{ l.seo_settings:prefix NE '' }">
            <MvASSIGN NAME = "l.results" VALUE = "{ l.results $ l.seo_settings:prefix $ SEOSettings_Encode_Delimiter( l.seo_settings:url_delim ) }">
        </MvIF>

        <MvIF EXPR = "{ l.store_count GT 0 AND ( l.store_count GT 1 OR l.seo_settings:sc_always ) }">
            <MvASSIGN NAME = "l.results" VALUE = "{ l.results $ encodeattribute( g.Store_Code ) $ SEOSettings_Encode_Delimiter( l.seo_settings:url_delim ) }">
        </MvIF>

        <MvASSIGN NAME = "l.results" VALUE = "{ l.results $ 'AFED' }">

        <MvIF EXPR = "{ l.seo_settings:suffix NE '' }">
            <MvASSIGN NAME = "l.results" VALUE = "{ l.results $ '.' $ l.seo_settings:suffix }">
        </MvIF>

        <MvFUNCTIONRETURN VALUE = "{ l.results }">
    </MvIF>
</MvFUNCTION>

<MvFUNCTION NAME = "SEOSettings_OrderHistory_Login_URL" PARAMETERS = "" STANDARDOUTPUTLEVEL = "">
    <MvIF EXPR = "{ NOT [ g.Module_Library_DB ].SEOSettings_Load( l.seo_settings ) }">
        <MvASSIGN NAME = "l.seo_settings:sf_active" VALUE = "0">
        <MvASSIGN NAME = "l.seo_settings:sl_active" VALUE = "0">
        <MvASSIGN NAME = "l.seo_settings:sm_active" VALUE = "0">
    </MvIF>

    <MvFUNCTIONRETURN VALUE = "{ SEOSettings_OrderHistory_Login_URL_with( l.seo_settings ) }">
</MvFUNCTION>

<MvFUNCTION NAME = "SEOSettings_OrderHistory_Login_URL_with" PARAMETERS = "seo_settings" STANDARDOUTPUTLEVEL = "">
	<MvASSIGN NAME = "l.store_count" VALUE = "{ [ g.Module_Library_DB ].Store_Count_Cached() }">

	<MvIF EXPR = "{ NOT l.seo_settings:sl_active OR l.seo_settings:url_delim EQ '' }">
		<MvIF EXPR = "{ l.store_count GT 0 }">
            <MvFUNCTIONRETURN VALUE = "{ g.secure_sessionurl $ 'Store_Code=' $ encodeattribute( g.Store_Code ) $ '&Screen=' $ 'ORHL' }">
        <MvELSE>
            <MvFUNCTIONRETURN VALUE = "{ g.secure_sessionurl $ 'Screen=' $ 'ORHL' }">
        </MvIF>
    <MvELSE>
		<MvASSIGN NAME = "l.results" VALUE = "{ SEOSettings_SecureURLPrefix_with( l.seo_settings ) }">

        <MvIF EXPR = "{ l.seo_settings:prefix NE '' }">
            <MvASSIGN NAME = "l.results" VALUE = "{ l.results $ l.seo_settings:prefix $ SEOSettings_Encode_Delimiter( l.seo_settings:url_delim ) }">
        </MvIF>

        <MvIF EXPR = "{ l.store_count GT 0 AND ( l.store_count GT 1 OR l.seo_settings:sc_always ) }">
            <MvASSIGN NAME = "l.results" VALUE = "{ l.results $ encodeattribute( g.Store_Code ) $ SEOSettings_Encode_Delimiter( l.seo_settings:url_delim ) }">
        </MvIF>

        <MvASSIGN NAME = "l.results" VALUE = "{ l.results $ 'ORHL' }">

        <MvIF EXPR = "{ l.seo_settings:suffix NE '' }">
            <MvASSIGN NAME = "l.results" VALUE = "{ l.results $ '.' $ l.seo_settings:suffix }">
        </MvIF>

        <MvFUNCTIONRETURN VALUE = "{ l.results }">
    </MvIF>
</MvFUNCTION>

<MvFUNCTION NAME = "SEOSettings_OrderHistory_URL" PARAMETERS = "" STANDARDOUTPUTLEVEL = "">
    <MvIF EXPR = "{ NOT [ g.Module_Library_DB ].SEOSettings_Load( l.seo_settings ) }">
        <MvASSIGN NAME = "l.seo_settings:sf_active" VALUE = "0">
        <MvASSIGN NAME = "l.seo_settings:sl_active" VALUE = "0">
        <MvASSIGN NAME = "l.seo_settings:sm_active" VALUE = "0">
    </MvIF>

    <MvFUNCTIONRETURN VALUE = "{ SEOSettings_OrderHistory_Login_URL_with( l.seo_settings ) }">
</MvFUNCTION>

<MvFUNCTION NAME = "SEOSettings_OrderHistory_URL_with" PARAMETERS = "seo_settings" STANDARDOUTPUTLEVEL = "">
	<MvASSIGN NAME = "l.store_count" VALUE = "{ [ g.Module_Library_DB ].Store_Count_Cached() }">

	<MvIF EXPR = "{ NOT l.seo_settings:sl_active OR l.seo_settings:url_delim EQ '' }">
		<MvIF EXPR = "{ l.store_count GT 0 }">
            <MvFUNCTIONRETURN VALUE = "{ g.secure_sessionurl $ 'Store_Code=' $ encodeattribute( g.Store_Code ) $ '&Screen=' $ 'ORDH' }">
        <MvELSE>
            <MvFUNCTIONRETURN VALUE = "{ g.secure_sessionurl $ 'Screen=' $ 'ORDH' }">
        </MvIF>
    <MvELSE>
		<MvASSIGN NAME = "l.results" VALUE = "{ SEOSettings_SecureURLPrefix_with( l.seo_settings ) }">

        <MvIF EXPR = "{ l.seo_settings:prefix NE '' }">
            <MvASSIGN NAME = "l.results" VALUE = "{ l.results $ l.seo_settings:prefix $ SEOSettings_Encode_Delimiter( l.seo_settings:url_delim ) }">
        </MvIF>

        <MvIF EXPR = "{ l.store_count GT 0 AND ( l.store_count GT 1 OR l.seo_settings:sc_always ) }">
            <MvASSIGN NAME = "l.results" VALUE = "{ l.results $ encodeattribute( g.Store_Code ) $ SEOSettings_Encode_Delimiter( l.seo_settings:url_delim ) }">
        </MvIF>

        <MvASSIGN NAME = "l.results" VALUE = "{ l.results $ 'ORDH' }">

        <MvIF EXPR = "{ l.seo_settings:suffix NE '' }">
            <MvASSIGN NAME = "l.results" VALUE = "{ l.results $ '.' $ l.seo_settings:suffix }">
        </MvIF>

        <MvFUNCTIONRETURN VALUE = "{ l.results }">
    </MvIF>
</MvFUNCTION>

<MvFUNCTION NAME = "SEOSettings_Checkout_URL" PARAMETERS = "" STANDARDOUTPUTLEVEL = "">
    <MvIF EXPR = "{ NOT [ g.Module_Library_DB ].SEOSettings_Load( l.seo_settings ) }">
        <MvASSIGN NAME = "l.seo_settings:sf_active" VALUE = "0">
        <MvASSIGN NAME = "l.seo_settings:sl_active" VALUE = "0">
        <MvASSIGN NAME = "l.seo_settings:sm_active" VALUE = "0">
    </MvIF>

    <MvFUNCTIONRETURN VALUE = "{ SEOSettings_CustomerAccount_URL_with( l.seo_settings ) }">
</MvFUNCTION>

<MvFUNCTION NAME = "SEOSettings_Checkout_URL_with" PARAMETERS = "seo_settings" STANDARDOUTPUTLEVEL = "">
	<MvASSIGN NAME = "l.store_count" VALUE = "{ [ g.Module_Library_DB ].Store_Count_Cached() }">

	<MvIF EXPR = "{ NOT l.seo_settings:sl_active OR l.seo_settings:url_delim EQ '' }">
		<MvIF EXPR = "{ l.store_count GT 0 }">
            <MvFUNCTIONRETURN VALUE = "{ g.secure_sessionurl $ 'Store_Code=' $ encodeattribute( g.Store_Code ) $ '&Screen=' $ 'OINF' }">
        <MvELSE>
            <MvFUNCTIONRETURN VALUE = "{ g.secure_sessionurl $ 'Screen=' $ 'OINF' }">
        </MvIF>
    <MvELSE>
		<MvASSIGN NAME = "l.results" VALUE = "{ SEOSettings_SecureURLPrefix_with( l.seo_settings ) }">

        <MvIF EXPR = "{ l.seo_settings:prefix NE '' }">
            <MvASSIGN NAME = "l.results" VALUE = "{ l.results $ l.seo_settings:prefix $ SEOSettings_Encode_Delimiter( l.seo_settings:url_delim ) }">
        </MvIF>

        <MvIF EXPR = "{ l.store_count GT 0 AND ( l.store_count GT 1 OR l.seo_settings:sc_always ) }">
            <MvASSIGN NAME = "l.results" VALUE = "{ l.results $ encodeattribute( g.Store_Code ) $ SEOSettings_Encode_Delimiter( l.seo_settings:url_delim ) }">
        </MvIF>

        <MvASSIGN NAME = "l.results" VALUE = "{ l.results $ 'OINF' }">

        <MvIF EXPR = "{ l.seo_settings:suffix NE '' }">
            <MvASSIGN NAME = "l.results" VALUE = "{ l.results $ '.' $ l.seo_settings:suffix }">
        </MvIF>

        <MvFUNCTIONRETURN VALUE = "{ l.results }">
    </MvIF>
</MvFUNCTION>

<MvFUNCTION NAME = "SEOSettings_URLPrefix" PARAMETERS = "" STANDARDOUTPUTLEVEL = "">
    <MvIF EXPR = "{ NOT [ g.Module_Library_DB ].SEOSettings_Load( l.seo_settings ) }">
        <MvASSIGN NAME = "l.seo_settings:sf_active" VALUE = "0">
        <MvASSIGN NAME = "l.seo_settings:sl_active" VALUE = "0">
        <MvASSIGN NAME = "l.seo_settings:sm_active" VALUE = "0">
    </MvIF>

    <MvFUNCTIONRETURN VALUE = "{ SEOSettings_URLPrefix_with( l.seo_settings ) }">
</MvFUNCTION>

<MvFUNCTION NAME = "SEOSettings_URLPrefix_with" PARAMETERS = "seo_settings var" STANDARDOUTPUTLEVEL = "">
	<MvIF EXPR = "{ NOT ISNULL l.seo_settings:urlprefix }">
		<MvFUNCTIONRETURN VALUE = "{ l.seo_settings:urlprefix }">
	</MvIF>

	<MvFUNCTIONRETURN VALUE = "{ 'http://' $ g.Domain:name $ '/' }">
</MvFUNCTION>

<MvFUNCTION NAME = "SEOSettings_SecureURLPrefix" PARAMETERS = "" STANDARDOUTPUTLEVEL = "">
    <MvIF EXPR = "{ NOT [ g.Module_Library_DB ].SEOSettings_Load( l.seo_settings ) }">
        <MvASSIGN NAME = "l.seo_settings:sf_active" VALUE = "0">
        <MvASSIGN NAME = "l.seo_settings:sl_active" VALUE = "0">
        <MvASSIGN NAME = "l.seo_settings:sm_active" VALUE = "0">
    </MvIF>

    <MvFUNCTIONRETURN VALUE = "{ SEOSettings_SecureURLPrefix_with( l.seo_settings ) }">
</MvFUNCTION>

<MvFUNCTION NAME = "SEOSettings_SecureURLPrefix_with" PARAMETERS = "seo_settings var" STANDARDOUTPUTLEVEL = "">
	<MvIF EXPR = "{ ISNULL g.Domain:mm_surl }">
		<MvFUNCTIONRETURN VALUE = "{ SEOSettings_URLPrefix_with( l.seo_settings ) }">
	</MvIF>

	<MvIF EXPR = "{ NOT ISNULL l.seo_settings:surlprefix }">
		<MvFUNCTIONRETURN VALUE = "{ l.seo_settings:surlprefix }">
	</MvIF>

	<MvFUNCTIONRETURN VALUE = "{ 'https://' $ g.Domain:name $ '/' }">
</MvFUNCTION>

<MvFUNCTION NAME = "Legacy_SEO_URL" PARAMETERS = "seo_settings var, page_code" STANDARDOUTPUTLEVEL = "">
	<MvIF EXPR = "{ g.Domain:mm_secure }">
		<MvFUNCTIONRETURN VALUE = "{ Legacy_SEO_URL_Secure( l.seo_settings, l.page_code ) }">
	</MvIF>

    <MvASSIGN NAME = "l.store_count" VALUE = "{ [ g.Module_Library_DB ].Store_Count_Cached() }">
    <MvASSIGN NAME = "l.url"         VALUE = "{ SEOSettings_URLPrefix_with( l.seo_settings ) }">

    <MvIF EXPR = "{ l.seo_settings:prefix NE '' }">
        <MvASSIGN NAME = "l.url"    VALUE = "{ l.url $ l.seo_settings:prefix $ SEOSettings_Encode_Delimiter( l.seo_settings:url_delim ) }">
    </MvIF>

    <MvIF EXPR = "{ l.store_count GT 0 AND ( l.store_count GT 1 OR l.seo_settings:sc_always ) }">
        <MvASSIGN NAME = "l.url"     VALUE = "{ l.url $ encodeattribute( g.Store_Code ) $ SEOSettings_Encode_Delimiter( l.seo_settings:url_delim ) }">
    </MvIF>

    <MvASSIGN NAME = "l.url"         VALUE = "{ l.url $ encodeattribute( l.page_code ) }">

    <MvIF EXPR = "{ l.seo_settings:suffix NE '' }">
        <MvASSIGN NAME = "l.url"     VALUE = "{ l.url $ '.' $ l.seo_settings:suffix }">
    </MvIF>

    <MvFUNCTIONRETURN VALUE = "{ l.url }">
</MvFUNCTION>

<MvFUNCTION NAME = "Legacy_SEO_URL_Secure" PARAMETERS = "seo_settings var, page_code" STANDARDOUTPUTLEVEL = "">
    <MvASSIGN NAME = "l.store_count" VALUE = "{ [ g.Module_Library_DB ].Store_Count_Cached() }">
    <MvASSIGN NAME = "l.url"      	 VALUE = "{ SEOSettings_SecureURLPrefix_with( l.seo_settings ) }">

    <MvIF EXPR = "{ l.seo_settings:prefix NE '' }">
        <MvASSIGN NAME = "l.url"     VALUE = "{ l.url $ l.seo_settings:prefix $ SEOSettings_Encode_Delimiter( l.seo_settings:url_delim ) }">
    </MvIF>

    <MvIF EXPR = "{ l.store_count GT 0 AND ( l.store_count GT 1 OR l.seo_settings:sc_always ) }">
        <MvASSIGN NAME = "l.url"     VALUE = "{ l.url $ encodeattribute( g.Store_Code ) $ SEOSettings_Encode_Delimiter( l.seo_settings:url_delim ) }">
    </MvIF>

    <MvASSIGN NAME = "l.url"         VALUE = "{ l.url $ encodeattribute( l.page_code ) }">

    <MvIF EXPR = "{ l.seo_settings:suffix NE '' }">
        <MvASSIGN NAME = "l.url"     VALUE = "{ l.url $ '.' $ l.seo_settings:suffix }">
    </MvIF>

    <MvFUNCTIONRETURN VALUE = "{ l.url }">
</MvFUNCTION>

<MvFUNCTION NAME = "Legacy_SEO_Product_URL" PARAMETERS = "seo_settings var, product_code" STANDARDOUTPUTLEVEL = "">
	<MvIF EXPR = "{ g.Domain:mm_secure }">
		<MvFUNCTIONRETURN VALUE = "{ Legacy_SEO_Product_URL_Secure( l.seo_settings, l.product_code ) }">
	</MvIF>

	<MvASSIGN NAME = "l.store_count" VALUE = "{ [ g.Module_Library_DB ].Store_Count_Cached() }">
	<MvASSIGN NAME = "l.url"		 VALUE = "{ SEOSettings_URLPrefix_with( l.seo_settings ) }">
	
	<MvIF EXPR = "{ l.seo_settings:prefix NE '' }">
		<MvASSIGN NAME = "l.url"	 VALUE = "{ l.url $ l.seo_settings:prefix $ SEOSettings_Encode_Delimiter( l.seo_settings:url_delim ) }">
	</MvIF>
	
	<MvIF EXPR = "{ l.store_count GT 0 AND ( l.store_count GT 1 OR l.seo_settings:sc_always ) }">
		<MvASSIGN NAME = "l.url"	 VALUE = "{ l.url $ encodeattribute( g.Store_Code ) $ SEOSettings_Encode_Delimiter( l.seo_settings:url_delim ) }">
	</MvIF>

	<MvIF EXPR = "{ l.seo_settings:prod_lit NE '' }">
		<MvASSIGN NAME = "l.url"	 VALUE = "{ l.url $ l.seo_settings:prod_lit $ SEOSettings_Encode_Delimiter( l.seo_settings:url_delim ) }">
	</MvIF>

	<MvASSIGN NAME = "l.url"		 VALUE = "{ l.url $ encodeattribute( l.product_code ) }">
	
	<MvIF EXPR = "{ l.seo_settings:suffix NE '' }">
		<MvASSIGN NAME = "l.url"	 VALUE = "{ l.url $ '.' $ l.seo_settings:suffix }">
	</MvIF>
	
	<MvFUNCTIONRETURN VALUE = "{ l.url }">
</MvFUNCTION>

<MvFUNCTION NAME = "Legacy_SEO_Product_URL_Secure" PARAMETERS = "seo_settings var, product_code" STANDARDOUTPUTLEVEL = "">
	<MvASSIGN NAME = "l.store_count" VALUE = "{ [ g.Module_Library_DB ].Store_Count_Cached() }">
	<MvASSIGN NAME = "l.url"		 VALUE = "{ SEOSettings_SecureURLPrefix_with( l.seo_settings ) }">
	
	<MvIF EXPR = "{ l.seo_settings:prefix NE '' }">
		<MvASSIGN NAME = "l.url"	 VALUE = "{ l.url $ l.seo_settings:prefix $ SEOSettings_Encode_Delimiter( l.seo_settings:url_delim ) }">
	</MvIF>
	
	<MvIF EXPR = "{ l.store_count GT 0 AND ( l.store_count GT 1 OR l.seo_settings:sc_always ) }">
		<MvASSIGN NAME = "l.url"	 VALUE = "{ l.url $ encodeattribute( g.Store_Code ) $ SEOSettings_Encode_Delimiter( l.seo_settings:url_delim ) }">
	</MvIF>

	<MvIF EXPR = "{ l.seo_settings:prod_lit NE '' }">
		<MvASSIGN NAME = "l.url"	 VALUE = "{ l.url $ l.seo_settings:prod_lit $ SEOSettings_Encode_Delimiter( l.seo_settings:url_delim ) }">
	</MvIF>

	<MvASSIGN NAME = "l.url"		 VALUE = "{ l.url $ encodeattribute( l.product_code ) }">
	
	<MvIF EXPR = "{ l.seo_settings:suffix NE '' }">
		<MvASSIGN NAME = "l.url"	 VALUE = "{ l.url $ '.' $ l.seo_settings:suffix }">
	</MvIF>
	
	<MvFUNCTIONRETURN VALUE = "{ l.url }">
</MvFUNCTION>

<MvFUNCTION NAME = "Legacy_SEO_Category_URL" PARAMETERS = "seo_settings var, category_code" STANDARDOUTPUTLEVEL = "">
	<MvIF EXPR = "{ g.Domain:mm_secure }">
		<MvFUNCTIONRETURN VALUE = "{ Legacy_SEO_Category_URL_Secure( l.seo_settings, l.category_code ) }">
	</MvIF>

	<MvASSIGN NAME = "l.store_count" VALUE = "{ [ g.Module_Library_DB ].Store_Count_Cached() }">
	<MvASSIGN NAME = "l.url"		 VALUE = "{ SEOSettings_URLPrefix_with( l.seo_settings ) }">
	
	<MvIF EXPR = "{ l.seo_settings:prefix NE '' }">
		<MvASSIGN NAME = "l.url"	 VALUE = "{ l.url $ l.seo_settings:prefix $ SEOSettings_Encode_Delimiter( l.seo_settings:url_delim ) }">
	</MvIF>
	
	<MvIF EXPR = "{ l.store_count GT 0 AND ( l.store_count GT 1 OR l.seo_settings:sc_always ) }">
		<MvASSIGN NAME = "l.url"	 VALUE = "{ l.url $ encodeattribute( g.Store_Code ) $ SEOSettings_Encode_Delimiter( l.seo_settings:url_delim ) }">
	</MvIF>

	<MvIF EXPR = "{ l.seo_settings:cat_lit NE '' }">
		<MvASSIGN NAME = "l.url"	 VALUE = "{ l.url $ l.seo_settings:cat_lit $ SEOSettings_Encode_Delimiter( l.seo_settings:url_delim ) }">
	</MvIF>

	<MvASSIGN NAME = "l.url"		 VALUE = "{ l.url $ encodeattribute( l.category_code ) }">
	
	<MvIF EXPR = "{ l.seo_settings:suffix NE '' }">
		<MvASSIGN NAME = "l.url"	 VALUE = "{ l.url $ '.' $ l.seo_settings:suffix }">
	</MvIF>
	
	<MvFUNCTIONRETURN VALUE = "{ l.url }">
</MvFUNCTION>

<MvFUNCTION NAME = "Legacy_SEO_Category_URL_Secure" PARAMETERS = "seo_settings var, category_code" STANDARDOUTPUTLEVEL = "">
	<MvASSIGN NAME = "l.store_count" VALUE = "{ [ g.Module_Library_DB ].Store_Count_Cached() }">
	<MvASSIGN NAME = "l.url"		 VALUE = "{ SEOSettings_SecureURLPrefix_with( l.seo_settings ) }">
	
	<MvIF EXPR = "{ l.seo_settings:prefix NE '' }">
		<MvASSIGN NAME = "l.url"	 VALUE = "{ l.url $ l.seo_settings:prefix $ SEOSettings_Encode_Delimiter( l.seo_settings:url_delim ) }">
	</MvIF>
	
	<MvIF EXPR = "{ l.store_count GT 0 AND ( l.store_count GT 1 OR l.seo_settings:sc_always ) }">
		<MvASSIGN NAME = "l.url"	 VALUE = "{ l.url $ encodeattribute( g.Store_Code ) $ SEOSettings_Encode_Delimiter( l.seo_settings:url_delim ) }">
	</MvIF>

	<MvIF EXPR = "{ l.seo_settings:cat_lit NE '' }">
		<MvASSIGN NAME = "l.url"	 VALUE = "{ l.url $ l.seo_settings:cat_lit $ SEOSettings_Encode_Delimiter( l.seo_settings:url_delim ) }">
	</MvIF>

	<MvASSIGN NAME = "l.url"		 VALUE = "{ l.url $ encodeattribute( l.category_code ) }">
	
	<MvIF EXPR = "{ l.seo_settings:suffix NE '' }">
		<MvASSIGN NAME = "l.url"	 VALUE = "{ l.url $ '.' $ l.seo_settings:suffix }">
	</MvIF>
	
	<MvFUNCTIONRETURN VALUE = "{ l.url }">
</MvFUNCTION>
